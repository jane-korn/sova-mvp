<!DOCTYPE html>
<!-- UPDATED: 2025-11-20 - Version 6.17 - FIXED: Resource button consistency, button spacing, report tooltips within margins -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Sova Business Assessment v3.0 - Multi-Element</title>
    <link rel="stylesheet" href="css/variables.css?v=6.17">
    <script src="questions-data.js?v=6.17"></script>
    <script src="article-urls.js?v=6.17"></script>
    <script src="content-data.js?v=6.17"></script>
    <!-- Mobile Debug Console - TEMPORARY FOR TESTING -->
    <script src="https://cdn.jsdelivr.net/npm/eruda"></script>
    <script>eruda.init();</script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Corbel Light', Corbel, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            font-weight: 300;
            background: #000000;
            color: #f5f1e8;
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 8px 24px;
        }

        .header {
            text-align: left;
            margin-bottom: 0px;
            padding: 16px 0 0 0;
        }

        .logo-text {
            font-size: 32px;
            font-weight: 800;
            color: #C4FF00;
            letter-spacing: 2px;
            text-shadow: 0 0 20px rgba(196, 255, 0, 0.3);
        }

        /* Preliminary Questions Section - Premium Redesign */
        .prelim-section {
            background: linear-gradient(135deg, #f5f1e8 0%, #ffffff 100%);
            padding: 60px 48px;
            border-radius: 32px;
            border: none;
            box-shadow:
                0 2px 8px rgba(61, 37, 23, 0.04),
                0 8px 24px rgba(61, 37, 23, 0.08),
                0 16px 48px rgba(61, 37, 23, 0.12);
            margin-bottom: 40px;
            animation: fadeIn 0.6s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            overflow: hidden;
        }

        .prelim-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #C4FF00 0%, #C5D952 50%, #E8C547 100%);
            opacity: 0.6;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .prelim-section h2 {
            font-size: clamp(32px, 4vw, 42px);
            margin-bottom: 12px;
            color: #3D2517;
            font-weight: 800;
            letter-spacing: -0.5px;
            line-height: 1.2;
        }

        .prelim-section p {
            color: #3D2517;
            margin-bottom: 40px;
            font-size: 18px;
            opacity: 0.7;
            font-weight: 400;
            line-height: 1.6;
        }

        .question-group {
            margin-bottom: 40px;
            padding: 32px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            border: 2px solid rgba(61, 37, 23, 0.06);
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .question-group:hover {
            border-color: rgba(196, 255, 0, 0.3);
            box-shadow: 0 4px 16px rgba(196, 255, 0, 0.1);
            transform: translateY(-2px);
        }

        .question-label {
            display: block;
            font-weight: 700;
            margin-bottom: 8px;
            color: #3D2517;
            font-size: 20px;
            letter-spacing: -0.3px;
        }

        .radio-group {
            display: flex;
            gap: 16px;
            margin-bottom: 8px;
        }

        .radio-option {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            padding: 20px;
            background: #ffffff;
            border-radius: 16px;
            border: 2px solid rgba(61, 37, 23, 0.1);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
        }

        .radio-option:hover {
            border-color: rgba(196, 255, 0, 0.4);
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.05) 0%, rgba(255, 255, 255, 1) 100%);
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(196, 255, 0, 0.15);
        }

        .radio-option input[type="radio"] {
            width: 22px;
            height: 22px;
            min-width: 22px;
            cursor: pointer;
            accent-color: #C4FF00;
            margin-top: 2px;
        }

        .radio-option input[type="radio"]:checked + label {
            font-weight: 700;
            color: #3D2517;
        }

        .radio-option label {
            cursor: pointer;
            font-size: 16px;
            color: #3D2517;
            transition: all 0.3s ease;
            line-height: 1.5;
            font-weight: 500;
        }

        .radio-option:has(input[type="radio"]:checked) {
            border-color: #C4FF00;
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.08) 0%, #ffffff 100%);
            box-shadow: 0 6px 20px rgba(196, 255, 0, 0.2);
        }

        /* Input Fields - Premium Redesign */
        input[type="text"],
        input[type="email"],
        select {
            width: 100%;
            padding: 18px 24px;
            border: 2px solid rgba(61, 37, 23, 0.15);
            border-radius: 16px;
            font-size: 16px;
            background: #ffffff;
            color: #3D2517;
            transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(61, 37, 23, 0.04);
        }

        input[type="text"]:hover,
        input[type="email"]:hover,
        select:hover {
            border-color: rgba(196, 255, 0, 0.4);
            box-shadow: 0 4px 16px rgba(196, 255, 0, 0.1);
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        select:focus {
            outline: none;
            border-color: #C4FF00;
            background: #ffffff;
            box-shadow: 0 0 0 4px rgba(196, 255, 0, 0.15), 0 8px 24px rgba(196, 255, 0, 0.2);
            transform: translateY(-2px);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%233D2517' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 20px;
            padding-right: 48px;
        }

        input::placeholder {
            color: rgba(61, 37, 23, 0.4);
        }

        select {
            cursor: pointer;
        }

        select option {
            background: #ffffff;
            color: #3D2517;
        }

        small {
            color: #3D2517 !important;
            font-size: 15px !important;
            opacity: 0.6;
            font-weight: 400;
            line-height: 1.5;
        }

        .btn-primary {
            background: linear-gradient(135deg, #C4FF00 0%, #C5D952 100%);
            color: #3D2517;
            border: none;
            padding: 20px 56px;
            border-radius: 16px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            box-shadow:
                0 2px 8px rgba(196, 255, 0, 0.2),
                0 8px 24px rgba(196, 255, 0, 0.15);
            letter-spacing: 0.3px;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
            pointer-events: none; /* Allow clicks to pass through to button */
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow:
                0 4px 16px rgba(196, 255, 0, 0.3),
                0 12px 40px rgba(196, 255, 0, 0.25);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }

        /* Model Section */
        .model-section {
            display: none;
            text-align: center;
        }

        .model-section.active {
            display: block;
        }

        .model-wrapper {
            position: relative;
            max-width: 1000px;
            width: 100%;
            margin: 0 auto;
            margin-top: -40px;
            padding: 40px;
            box-sizing: border-box;
            z-index: 1;
        }

        #sova-model {
            display: block;
            width: 100%;
            height: auto;
        }

        /* SVG Interactive Elements */
        .element-dot {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .element-dot:hover {
            filter: brightness(1.3) drop-shadow(0 0 8px #C4FF00);
        }

        .element-dot.active {
            filter: drop-shadow(0 0 4px rgba(196, 255, 0, 0.6));
        }

        .element-dot.active:hover {
            filter: drop-shadow(0 0 12px #C4FF00) brightness(1.2);
        }

        .element-dot.locked {
            opacity: 0.2;
            cursor: not-allowed;
        }

        .element-dot.locked:hover {
            filter: none;
            transform: none;
        }

        /* Uncompleted/Not started MVP elements - hollow lime outline, prominent */
        .element-dot:not(.completed):not(.in-progress):not(.locked) {
            fill: none !important;
            stroke: #C4FF00 !important;
            stroke-width: 4 !important;
            opacity: 0.7;
            filter: drop-shadow(0 0 6px rgba(196, 255, 0, 0.4));
            pointer-events: all !important;
        }

        /* In-progress elements - hollow with strong glow */
        .element-dot.in-progress {
            fill: none !important;
            stroke: #C4FF00 !important;
            stroke-width: 5 !important;
            opacity: 0.9;
            filter: drop-shadow(0 0 10px rgba(196, 255, 0, 0.6));
            pointer-events: all !important;
        }

        /* Completed elements - fully filled with electric lime, maximum impact */
        .element-dot.completed {
            fill: #C4FF00 !important;
            stroke: #C4FF00 !important;
            stroke-width: 2 !important;
            filter: drop-shadow(0 0 16px #C4FF00) drop-shadow(0 0 8px #C4FF00);
            opacity: 1;
        }

        /* Locked non-MVP elements - dramatically dimmed */
        .element-dot.locked {
            fill: #3D2517 !important;
            opacity: 0.15 !important;
            filter: none !important;
        }

        .element-spoke {
            transition: opacity 0.3s ease;
        }

        #sova-model text {
            transition: all 0.3s ease;
        }

        .element-dot:hover + text,
        text:has(+ .element-dot:hover) {
            fill: #C4FF00 !important;
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: #f5f1e8;
            border: 2px solid #C4FF00;
            color: #3D2517;
            padding: 16px 20px;
            border-radius: 12px;
            min-width: 200px;
            max-width: 300px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 1000;
            box-shadow: 0 8px 32px rgba(196, 255, 0, 0.3);
        }

        .tooltip.show {
            opacity: 1;
        }

        .tooltip-title {
            font-weight: 700;
            margin-bottom: 6px;
            color: #3D2517;
            font-size: 15px;
        }

        .tooltip-desc {
            font-size: 13px;
            line-height: 1.5;
            color: #3D2517;
            opacity: 0.8;
        }

        /* Questionnaire Section */
        .questionnaire-section {
            display: none;
        }

        .questionnaire-section.active {
            display: block;
        }

        /* Results Section */
        .results-section {
            display: none;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .results-section.active {
            display: block;
        }

        .results-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .results-header {
            text-align: center;
            margin-bottom: 48px;
        }

        .results-header h1 {
            font-size: 42px;
            color: #C4FF00;
            margin: 16px 0;
        }

        .results-header p {
            font-size: 18px;
            color: #f5f1e8;
            opacity: 0.8;
        }

        .score-card {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.1) 0%, rgba(197, 217, 82, 0.1) 100%);
            border: 2px solid rgba(196, 255, 0, 0.3);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 40px;
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .score-visual svg {
            filter: drop-shadow(0 0 20px rgba(196, 255, 0, 0.3));
        }

        .score-details {
            flex: 1;
        }

        .score-details h2 {
            font-size: 32px;
            color: #C4FF00;
            margin-bottom: 16px;
        }

        .score-details p {
            font-size: 18px;
            color: #f5f1e8;
            opacity: 0.9;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .score-breakdown {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border-left: 4px solid #C4FF00;
        }

        .score-item-label {
            font-size: 16px;
            color: #f5f1e8;
            font-weight: 600;
        }

        .score-item-value {
            font-size: 18px;
            color: #C4FF00;
            font-weight: 700;
        }

        .recommendations-section, .tools-section, .next-steps-section {
            background: rgba(245, 241, 232, 0.05);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
        }

        .recommendations-section h2, .tools-section h2, .next-steps-section h2 {
            font-size: 28px;
            color: #C4FF00;
            margin-bottom: 24px;
        }

        .recommendation-card, .tool-card, .next-step-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(196, 255, 0, 0.2);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 16px;
        }

        .recommendation-card h3, .tool-card h3, .next-step-card h3 {
            font-size: 20px;
            color: #E8C547;
            margin-bottom: 12px;
        }

        .recommendation-card p, .tool-card p, .next-step-card p {
            font-size: 16px;
            color: #f5f1e8;
            opacity: 0.9;
            line-height: 1.6;
        }

        /* Stage Tracker Styles */
        .stage-tracker {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(196, 255, 0, 0.2);
            border-radius: 16px;
            padding: 24px;
            margin: 32px 0;
        }

        .stage-tracker h3 {
            color: #C4FF00;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .stage-progress-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .stage-item {
            text-align: center;
            flex: 0 0 auto;
        }

        .stage-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin: 0 auto 8px;
        }

        .stage-item.complete .stage-number {
            background: #C4FF00;
            color: #000;
        }

        .stage-item.current .stage-number {
            background: #E8C547;
            color: #000;
        }

        .stage-item.pending .stage-number {
            background: rgba(255, 255, 255, 0.1);
            color: #C5D952;
        }

        .stage-name {
            font-size: 14px;
            color: #f5f1e8;
        }

        .stage-connector {
            flex: 1;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
            margin: 0 8px;
        }

        .stage-connector.complete {
            background: #C4FF00;
        }

        /* Premium Tooltip Popovers (Jeton/Phamily/Osmo style) */
        .tooltip-trigger {
            position: relative;
            display: inline-block;
            color: #f5f1e8;
            font-size: 13px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
            text-decoration: none;
        }

        .tooltip-trigger.gold {
            background: linear-gradient(135deg, rgba(232, 197, 71, 0.15) 0%, rgba(232, 197, 71, 0.08) 100%);
            border: 1.5px solid rgba(232, 197, 71, 0.4);
        }

        .tooltip-trigger.lime {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.12) 0%, rgba(196, 255, 0, 0.06) 100%);
            border: 1.5px solid rgba(196, 255, 0, 0.4);
        }

        .tooltip-trigger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .tooltip-trigger.gold:hover {
            background: linear-gradient(135deg, rgba(232, 197, 71, 0.25) 0%, rgba(232, 197, 71, 0.15) 100%);
            border-color: rgba(232, 197, 71, 0.7);
        }

        .tooltip-trigger.lime:hover {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.2) 0%, rgba(196, 255, 0, 0.1) 100%);
            border-color: rgba(196, 255, 0, 0.7);
        }

        .tooltip-popover {
            position: absolute;
            bottom: calc(100% + 12px);
            left: 50%;
            margin-left: -200px;
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(61, 37, 23, 0.1);
            min-width: 300px;
            max-width: 400px;
            width: 400px;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            z-index: 999999 !important;
        }

        .tooltip-trigger:hover .tooltip-popover {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }

        /* Popover arrow */
        .tooltip-popover::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #ffffff;
        }

        .tooltip-popover-label {
            color: #3D2517;
            opacity: 0.5;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            margin-bottom: 10px;
        }

        .tooltip-popover-content {
            color: #3D2517;
            font-size: 14px;
            line-height: 1.6;
            font-style: italic;
            margin-bottom: 12px;
        }

        .tooltip-popover-link {
            color: #3D2517;
            font-size: 11px;
            font-weight: 700;
            text-decoration: none;
            border-bottom: 2px solid #3D2517;
            display: inline-block;
            transition: all 0.2s;
        }

        .tooltip-popover-link:hover {
            color: #C4FF00;
            border-bottom-color: #C4FF00;
        }

        /* Corner accent for tooltip */
        .tooltip-corner {
            position: absolute;
            top: 0;
            right: 0;
            width: 30px;
            height: 30px;
            border-radius: 0 12px 0 0;
            opacity: 0.15;
        }

        .tooltip-corner.gold {
            background: linear-gradient(135deg, transparent 50%, #E8C547 50%);
        }

        .tooltip-corner.lime {
            background: linear-gradient(135deg, transparent 50%, #C4FF00 50%);
        }

        /* Golden Circle Sections */
        .golden-circle-section {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(196, 255, 0, 0.2);
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
        }

        .golden-circle-section h2 {
            color: #C4FF00;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .golden-circle-section p {
            color: #f5f1e8;
            line-height: 1.6;
        }

        .why-section {
            border-left: 4px solid #C4FF00;
        }

        .how-section {
            border-left: 4px solid #E8C547;
        }

        .what-section {
            border-left: 4px solid #C5D952;
        }

        /* Gap Cards */
        .gap-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(196, 255, 0, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }

        .gap-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .gap-header h3 {
            flex: 1;
            color: #f5f1e8;
            font-size: 18px;
            margin: 0;
        }

        .gap-priority {
            background: #C4FF00;
            color: #000;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            white-space: nowrap;
            margin-left: 12px;
        }

        .gap-card p {
            color: #f5f1e8;
            margin: 8px 0;
        }

        .gap-card ul {
            color: #f5f1e8;
            margin-left: 20px;
        }

        .gap-card li {
            margin: 6px 0;
        }

        /* Guides Section */
        .guides-section {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(196, 255, 0, 0.1);
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
        }

        .guides-section h3 {
            color: #C4FF00;
            font-size: 20px;
            margin-bottom: 16px;
        }

        .guides-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .guide-item {
            padding: 16px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .guide-item strong {
            color: #E8C547;
            display: block;
            margin-bottom: 8px;
        }

        .guide-item span {
            color: #f5f1e8;
            font-size: 14px;
            opacity: 0.8;
        }

        .results-actions {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-top: 48px;
        }

        .btn-secondary {
            padding: 14px 32px;
            font-size: 16px;
            border-radius: 8px;
            border: 2px solid #C4FF00;
            background: transparent;
            color: #C4FF00;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(196, 255, 0, 0.1);
            transform: translateY(-2px);
        }

        .questionnaire-container {
            background: #f5f1e8;
            padding: 40px;
            border-radius: 24px;
            border: 1px solid rgba(196, 255, 0, 0.3);
            box-shadow: 0 8px 32px rgba(196, 255, 0, 0.2);
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .exit-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: none;
            color: #3D2517;
            font-size: 32px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
            line-height: 1;
        }

        .exit-btn:hover {
            background: rgba(61, 37, 23, 0.1);
            transform: rotate(90deg);
        }

        .progress-bar-container {
            margin-bottom: 32px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-info #questionProgress {
            font-size: 14px;
            color: #3D2517;
            opacity: 0.7;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(61, 37, 23, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #C4FF00 0%, #C5D952 100%);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .question-container {
            margin-bottom: 32px;
        }

        .element-badge {
            display: inline-block;
            background: #C4FF00;
            color: #3D2517;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .question-text {
            font-size: 22px;
            font-weight: 600;
            color: #3D2517;
            line-height: 1.5;
            margin-bottom: 24px;
        }

        /* Info buttons */
        .info-buttons-row {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 8px;
            margin-bottom: 16px;
        }

        .info-btn {
            padding: 8px 16px;
            border: 2px solid rgba(61, 37, 23, 0.2);
            border-radius: 6px;
            background: white;
            color: #3D2517;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .info-btn:hover {
            border-color: #3D2517;
            background: rgba(61, 37, 23, 0.05);
        }

        .info-btn.active {
            background: #C4FF00;
            border-color: #C4FF00;
            color: #3D2517;
        }

        .info-content {
            display: none;
            background: rgba(61, 37, 23, 0.05);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #C4FF00;
            position: relative;
        }

        .info-content.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .info-content h4 {
            color: #3D2517;
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .info-content p {
            color: #3D2517;
            font-size: 14px;
            line-height: 1.7;
            margin-bottom: 8px;
        }

        .info-content a {
            color: #3D2517;
            text-decoration: underline;
            font-weight: 600;
        }

        .info-content a:hover {
            color: #C4FF00;
        }

        .info-content blockquote {
            margin: 8px 0;
            padding: 12px 16px;
            background: white;
            border-left: 3px solid #C4FF00;
            font-style: italic;
            color: #3D2517;
            line-height: 1.6;
        }

        .answer-buttons {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
        }

        .answer-btn {
            flex: 1;
            padding: 12px 24px;
            border: 2px solid #3D2517;
            border-radius: 10px;
            background: white;
            color: #3D2517;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .answer-btn:hover {
            border-color: #C4FF00;
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(196, 255, 0, 0.3);
        }

        .answer-btn.selected {
            background: #C4FF00;
            border-color: #C4FF00;
            color: #3D2517;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            gap: 16px;
        }

        .nav-btn {
            padding: 14px 32px;
            border: 2px solid #3D2517;
            border-radius: 8px;
            background: white;
            color: #3D2517;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:hover:not(:disabled) {
            background: #3D2517;
            color: #f5f1e8;
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .nav-btn.next-btn {
            background: linear-gradient(135deg, #C4FF00 0%, #C5D952 100%);
            border-color: #C4FF00;
            color: #3D2517;
            font-weight: 700;
        }

        .nav-btn.next-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(196, 255, 0, 0.3);
        }

        /* Stage recommendation */
        .stage-recommendation {
            background: rgba(196, 255, 0, 0.15);
            border: 2px solid #C4FF00;
            padding: 20px;
            margin-top: 24px;
            border-radius: 12px;
        }

        .stage-recommendation strong {
            color: #3D2517;
            font-weight: 700;
        }

        /* Validation section styling - compressed for one-page fit */
        #step2Section {
            background: #f5f1e8;
            padding: 48px;
            border-radius: 16px;
            border: 1px solid rgba(196, 255, 0, 0.3);
            box-shadow: 0 4px 16px rgba(196, 255, 0, 0.15);
            max-width: 1000px;
            margin: 0 auto;
        }

        #step2Section h2 {
            color: #3D2517;
            font-size: 20px;
            margin-bottom: 16px;
        }

        #validationQuestions .question-group label {
            color: #3D2517;
            font-size: 16px;
            font-weight: 500;
        }

        /* Enhanced glow animation - prominent pulse without movement */
        @keyframes glow {
            0%, 100% {
                filter: drop-shadow(0 0 3px var(--sova-lime)) drop-shadow(0 0 6px var(--sova-lime));
                opacity: 1;
            }
            50% {
                filter: drop-shadow(0 0 20px var(--sova-lime)) drop-shadow(0 0 30px var(--sova-lime)) drop-shadow(0 0 40px var(--sova-lime));
                opacity: 0.95;
            }
        }

        @keyframes smoothFadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes smoothZoomIn {
            from {
                transform: scale(0.9) translateY(20px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        @keyframes gentlePulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 8px 24px rgba(196, 255, 0, 0.3);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 12px 32px rgba(196, 255, 0, 0.5);
            }
        }

        .element-dot {
            transition: filter 0.3s ease;
        }

        /* Combined Report Section - Unique Sophisticated Layout */
        .report-section {
            width: 100%;
            background: #f5f1e8;
            padding: 0;
            min-height: 100vh;
            position: relative;
        }

        .report-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0;
        }

        .report-header {
            background: #3D2517;
            padding: 120px 60px 80px 60px;
            position: relative;
            overflow: hidden;
        }

        .report-header h2 {
            color: #C4FF00;
            font-size: clamp(48px, 8vw, 120px);
            font-weight: 700;
            margin: 0 0 24px 0;
            letter-spacing: -3px;
            line-height: 0.9;
        }

        .report-header p {
            color: #f5f1e8;
            font-size: clamp(18px, 2.5vw, 28px);
            opacity: 0.8;
            margin: 0;
            max-width: 800px;
        }

        .overall-progress {
            background: white;
            border-radius: 12px;
            padding: 40px;
            border-left: 6px solid #C4FF00;
            box-shadow: 0 4px 16px rgba(61, 37, 23, 0.08);
        }

        .progress-text {
            color: #3D2517;
            font-size: 16px;
            margin: 0;
        }

        /* Layered Card System - Jeton inspired */
        .report-card {
            background: white;
            border-radius: 16px;
            padding: 0;
            margin-bottom: 40px;
            position: relative;
            box-shadow: 0 2px 12px rgba(61, 37, 23, 0.06);
            transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .report-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(61, 37, 23, 0.12);
        }

        .section-heading {
            color: #1c1917;
            font-size: 32px;
            font-weight: 500;
            margin-bottom: 32px;
            letter-spacing: -0.8px;
        }

        .section-content {
            color: #44403c;
            font-size: 15px;
            line-height: 1.7;
        }

        .section-intro {
            color: #78716c;
            font-size: 15px;
            line-height: 1.6;
            margin: -8px 0 32px 0;
        }

        .placeholder-text {
            color: #a8a29e;
            font-style: normal;
            margin: 0;
            font-size: 15px;
        }

        /* Priority card - special styling */
        .priority-card {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.1) 0%, rgba(197, 217, 82, 0.1) 100%);
            border: 3px solid #C4FF00;
        }

        .priority-card .section-heading {
            color: #3D2517;
            font-size: 32px;
        }

        /* Strength card - positive styling */
        .strength-card {
            background: linear-gradient(135deg, rgba(197, 217, 82, 0.08) 0%, rgba(232, 197, 71, 0.08) 100%);
            border-left: 6px solid #C5D952;
        }

        /* Checklist item */
        .checklist-item {
            background: white;
            border: 2px solid #3D2517;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }

        .checklist-item:hover {
            transform: translateX(4px);
            box-shadow: -4px 4px 0 #C4FF00;
        }

        .checklist-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }

        .checklist-number {
            background: #C4FF00;
            color: #3D2517;
            font-weight: 700;
            font-size: 14px;
            padding: 6px 12px;
            border-radius: 6px;
            flex-shrink: 0;
        }

        .checklist-title {
            color: #3D2517;
            font-size: 18px;
            font-weight: 700;
            margin: 0;
            line-height: 1.4;
        }

        .checklist-details {
            margin-left: 48px;
            color: #3D2517;
            font-size: 14px;
            line-height: 1.6;
        }

        .checklist-tools {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .tool-tag {
            background: #f5f1e8;
            border: 1px solid #3D2517;
            color: #3D2517;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .tool-tag:hover {
            background: #C4FF00;
            transform: translateY(-2px);
        }

        /* Status badge */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .status-discovery {
            background: rgba(197, 217, 82, 0.2);
            color: #3D2517;
        }

        .status-validation {
            background: rgba(232, 197, 71, 0.3);
            color: #3D2517;
        }

        .status-efficiency {
            background: rgba(196, 255, 0, 0.4);
            color: #3D2517;
        }

        .status-scale {
            background: #C4FF00;
            color: #3D2517;
        }

        /* Element status card */
        .element-status {
            background: white;
            border-left: 4px solid #C4FF00;
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 4px;
        }

        .element-status h4 {
            color: #3D2517;
            font-size: 18px;
            font-weight: 700;
            margin: 0 0 8px 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .element-score {
            font-size: 24px;
            font-weight: 700;
            color: #C4FF00;
            text-shadow: 1px 1px 0 #3D2517;
        }

        .report-actions {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-top: 40px;
        }

        .btn-primary, .btn-secondary {
            padding: 16px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #3D2517;
        }

        .btn-primary {
            background: linear-gradient(135deg, #C4FF00 0%, #C5D952 100%);
            color: #3D2517;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(196, 255, 0, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #3D2517;
        }

        .btn-secondary:hover {
            background: #3D2517;
            color: #f5f1e8;
        }

        /* Gap item styling */
        .gap-item {
            background: #f5f1e8;
            border-left: 4px solid #C4FF00;
            padding: 16px;
            margin-bottom: 16px;
            border-radius: 4px;
        }

        .gap-item h4 {
            color: #3D2517;
            font-size: 18px;
            font-weight: 700;
            margin: 0 0 8px 0;
        }

        .gap-item p {
            color: #3D2517;
            font-size: 14px;
            margin: 4px 0;
            line-height: 1.6;
        }

        .gap-priority {
            display: inline-block;
            background: #C4FF00;
            color: #3D2517;
            font-size: 12px;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 12px;
            margin-bottom: 8px;
        }

        .tool-recommendation {
            background: white;
            border: 1px solid #3D2517;
            border-radius: 8px;
            padding: 12px;
            margin-top: 8px;
        }

        .tool-recommendation strong {
            color: #3D2517;
            font-size: 14px;
        }

        /* Strength item styling */
        .strength-item {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.1) 0%, rgba(197, 217, 82, 0.1) 100%);
            border-left: 4px solid #C5D952;
            padding: 16px;
            margin-bottom: 16px;
            border-radius: 4px;
        }

        .strength-item blockquote {
            margin: 0;
            padding: 12px 16px;
            background: white;
            border-left: 3px solid #C4FF00;
            font-style: italic;
            color: #3D2517;
            line-height: 1.6;
        }

        /* Interconnection insight styling */
        .interconnection-insight {
            background: linear-gradient(135deg, rgba(232, 197, 71, 0.15) 0%, rgba(197, 217, 82, 0.15) 100%);
            border: 2px solid #E8C547;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .interconnection-insight strong {
            color: #3D2517;
            font-size: 18px;
        }

        .interconnection-insight p {
            color: #3D2517;
            margin: 8px 0 0 0;
            line-height: 1.6;
        }

        /* ========================================
           MOBILE RESPONSIVE STYLES
           ======================================== */

        /* Tablets and below (< 1024px) */
        @media screen and (max-width: 1024px) {
            .container {
                padding: 8px 20px;
            }

            .model-wrapper {
                padding: 20px;
                margin-top: -20px;
            }

            .score-card {
                flex-direction: column;
                gap: 24px;
                padding: 32px 24px;
            }
        }

        /* Mobile and small tablets (< 768px) */
        @media screen and (max-width: 768px) {
            body {
                font-size: 16px;
            }

            .container {
                padding: 8px 0;
                max-width: 100% !important;
                margin: 0 !important;
            }

            /* Header - Mobile */
            .logo-text {
                font-size: 24px;
                letter-spacing: 1px;
            }

            /* Preliminary Section - Mobile */
            .prelim-section {
                padding: 40px 16px;
                border-radius: 0;
                margin: 0;
                margin-bottom: 24px;
                max-width: 100% !important;
            }

            .prelim-section h2 {
                font-size: 28px;
                margin-bottom: 12px;
            }

            .prelim-section p {
                font-size: 16px;
                margin-bottom: 32px;
            }

            .question-group {
                padding: 24px 20px;
                margin-bottom: 32px;
            }

            .question-label {
                font-size: 18px;
                margin-bottom: 12px;
            }

            /* Radio buttons - Stack vertically on mobile */
            .radio-group {
                flex-direction: column;
                gap: 12px;
            }

            .radio-option {
                padding: 16px;
                width: 100%;
            }

            .radio-option input[type="radio"] {
                width: 24px;
                height: 24px;
                min-width: 24px;
            }

            .radio-option label {
                font-size: 15px;
            }

            /* Input fields - Mobile */
            input[type="text"],
            input[type="email"],
            select {
                padding: 16px 20px;
                font-size: 16px; /* Prevents zoom on iOS */
                border-radius: 12px;
            }

            small {
                font-size: 14px !important;
            }

            /* Primary button - Mobile optimised */
            .btn-primary {
                width: 100%;
                padding: 18px 32px;
                font-size: 16px;
                border-radius: 12px;
            }

            /* Model wrapper - Mobile */
            .model-wrapper {
                padding: 16px 8px;
                margin-top: -20px;
            }

            #sova-model {
                max-width: 100%;
                height: auto;
            }

            /* Tooltip - Mobile positioning */
            .tooltip {
                max-width: 280px;
                min-width: 180px;
                padding: 12px 16px;
                font-size: 14px;
            }

            .tooltip-title {
                font-size: 14px;
            }

            .tooltip-desc {
                font-size: 12px;
            }

            /* Questionnaire - Mobile */
            .question-container {
                padding: 24px 16px;
                border-radius: 0;
                margin: 0;
                max-width: 100% !important;
            }

            .question-text {
                font-size: 18px;
                margin-bottom: 20px;
            }

            .answer-option {
                padding: 16px 18px;
                font-size: 15px;
            }

            .answer-option input[type="radio"] {
                width: 24px;
                height: 24px;
                min-width: 24px;
            }

            /* Info boxes - Mobile */
            .info-box {
                padding: 16px;
                border-radius: 12px;
                margin-bottom: 16px;
            }

            .info-box h4 {
                font-size: 15px;
            }

            .info-box p,
            .info-box ul {
                font-size: 14px;
            }

            /* Navigation buttons - Mobile */
            .nav-buttons {
                flex-direction: column;
                gap: 12px;
            }

            .btn-nav,
            .btn-back {
                width: 100%;
                padding: 16px 24px;
                font-size: 15px;
            }

            /* Results section - Mobile */
            .results-section {
                padding: 24px 16px;
            }

            .results-header h1 {
                font-size: 32px;
                margin: 12px 0;
            }

            .results-header p {
                font-size: 16px;
            }

            .score-card {
                padding: 24px 20px;
                gap: 20px;
            }

            .score-details h2 {
                font-size: 24px;
                margin-bottom: 12px;
            }

            /* Web chart - Mobile */
            .web-chart-container {
                padding: 20px 16px;
            }

            #webChart {
                max-width: 100%;
                height: auto;
            }

            /* Report sections - Mobile */
            .report-section {
                padding: 24px 20px;
                border-radius: 16px;
                margin-bottom: 20px;
            }

            .report-section h2 {
                font-size: 22px;
                margin-bottom: 16px;
            }

            .report-section h3 {
                font-size: 18px;
                margin-top: 20px;
                margin-bottom: 12px;
            }

            .gap-item,
            .strength-item {
                padding: 16px;
                margin-bottom: 12px;
            }

            .gap-priority {
                font-size: 11px;
                padding: 3px 10px;
            }

            /* Sidebar - Mobile */
            .sidebar {
                width: 100%;
                position: relative;
                padding: 20px;
                margin-bottom: 20px;
            }

            .sidebar-content {
                padding: 16px;
            }

            .sidebar h3 {
                font-size: 18px;
                margin-bottom: 12px;
            }

            .element-progress-item {
                padding: 12px;
                font-size: 14px;
            }

            /* HIDE sticky sidebar buttons on mobile - they extend beyond screen */
            #webChartSidebar,
            #reportSidebar,
            #actionSidebar {
                display: none !important;
            }

            /* Fix report sections - proper padding and no cutoff */
            .report-section {
                padding: 20px 12px !important;
                margin-left: 0 !important;
                margin-right: 0 !important;
                max-width: 100% !important;
            }

            /* Ensure report content doesn't get cut off */
            #reportSection {
                padding: 0 8px !important;
                max-width: 100% !important;
                overflow-x: hidden !important;
            }

            /* Fix container width on mobile */
            .container {
                max-width: 100% !important;
                overflow-x: hidden !important;
            }

            /* Fix results section - Element Breakdown */
            .score-card {
                flex-direction: column !important;
                width: 100% !important;
                padding: 16px !important;
                gap: 16px !important;
            }

            /* Fix element cards wrapping */
            .score-details {
                width: 100% !important;
                max-width: 100% !important;
            }

            /* Fix gap cards - buttons and content */
            .gap-card {
                padding: 16px 12px !important;
                margin: 0 0 16px 0 !important;
                max-width: 100% !important;
            }

            /* Fix gap card header to prevent overflow */
            .gap-card-header {
                flex-wrap: wrap !important;
                gap: 8px !important;
            }

            /* Fix two-column layouts to stack on mobile */
            .two-column,
            .gap-details {
                flex-direction: column !important;
                gap: 16px !important;
            }

            .column,
            .gap-column {
                width: 100% !important;
                max-width: 100% !important;
                padding: 0 !important;
            }

            /* Fix brown header bar in gaps */
            .gap-header-box,
            [style*="background: #3D2517"] {
                margin: 0 !important;
                border-radius: 12px !important;
                padding: 16px 12px !important;
            }

            /* Fix tooltips/buttons on gap cards */
            .tooltip-btn,
            [style*="border: 2px solid"] {
                font-size: 12px !important;
                padding: 8px 12px !important;
                white-space: nowrap !important;
            }

            /* FIX: Assessment tooltip buttons - prevent overflow */
            .info-buttons-row {
                justify-content: flex-start !important;
                flex-wrap: wrap !important;
                gap: 8px !important;
                margin: 0 0 16px 0 !important;
            }

            .info-btn {
                font-size: 11px !important;
                padding: 6px 10px !important;
            }

            /* STANDARDIZE ALL SECTION PADDING TO 16PX */
            [style*="background: #3D2517"],
            [style*="background: #f5f1e8"] {
                padding: 40px 16px !important;
            }

            /* All inner containers same margins */
            [style*="max-width: 1200px"],
            [style*="max-width: 1400px"] {
                max-width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            /* FIX 1 & 2: Element Breakdown heading and tiles - 2 per row */
            #elementGrid {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 12px !important;
                padding: 0 !important;
            }

            .element-card,
            .score-item {
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                padding: 16px 12px !important;
            }

            /* Element Breakdown heading same margin as others */
            #elementGrid + h2,
            [style*="Element Breakdown"] {
                margin: 0 0 24px 0 !important;
            }

            /* FIX 3: Your Startup Health content same margins */
            #statusContent,
            #overallScoreVisual {
                padding: 0 !important;
                margin: 0 !important;
            }

            /* Startup Health grid stacks on mobile */
            [style*="grid-template-columns: 2fr 1fr"] {
                grid-template-columns: 1fr !important;
                gap: 24px !important;
            }

            /* FIX: Your Gaps heading section */
            [style*="Your Gaps"] {
                margin: 0 0 24px 0 !important;
            }

            /* Hide "Click an element" text on mobile */
            [style*="Click an element"] {
                display: none !important;
            }

            /* FIX 4: Filter by Element same margins, all buttons on one line */
            .filter-buttons,
            #elementFilterButtons {
                flex-wrap: nowrap !important;
                justify-content: flex-start !important;
                gap: 3px !important;
                overflow-x: auto !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            .filter-btn,
            .element-filter-btn,
            button[style*="background: #3D2517"],
            button[style*="background: white"] {
                font-size: 9px !important;
                padding: 6px 6px !important;
                white-space: nowrap !important;
                flex-shrink: 0 !important;
                min-width: auto !important;
            }

            /* FIX 5: Element headings with Definition/Why/Experts buttons - one line, same height, under heading */
            .element-header,
            [style*="justify-content: space-between"][style*="align-items: center"] {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 8px !important;
                padding: 0 16px !important;
            }

            .element-title {
                width: 100% !important;
                margin: 0 !important;
            }

            .element-tooltips,
            [style*="display: flex"][style*="gap: 8px"] {
                width: 100% !important;
                justify-content: flex-start !important;
                flex-wrap: nowrap !important;
                gap: 4px !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            /* FIX 5: Compress tooltip buttons - same height, one line */
            .element-tooltips button,
            [style*="padding: 8px 16px"][style*="border: 2px solid"] {
                font-size: 9px !important;
                padding: 6px 8px !important;
                height: 28px !important;
                line-height: 1 !important;
                white-space: nowrap !important;
                flex-shrink: 0 !important;
            }

            /* FIX: Report tooltip buttons (Definition, Why it matters, Experts) - fit within margins */
            .tooltip-trigger {
                font-size: 10px !important;
                padding: 4px 8px !important;
                white-space: nowrap !important;
            }

            /* Ensure button container doesn't overflow */
            [style*="display: flex"][style*="gap: 12px"][style*="z-index: 1000000"] {
                gap: 4px !important;
                flex-wrap: wrap !important;
                max-width: 100% !important;
            }

            /* FIX: Tooltip popovers stay within margins */
            .tooltip-popover {
                left: 0 !important;
                right: 0 !important;
                margin-left: 0 !important;
                transform: none !important;
                width: calc(100vw - 32px) !important;
                max-width: 400px !important;
                min-width: unset !important;
            }

            .tooltip-popover::after {
                left: 24px !important;
                transform: none !important;
            }

            /* FIX 6: Element heading container same margins as Startup Health */
            .gap-card-header,
            [style*="background: #3D2517"][style*="padding: 24px"] {
                padding: 16px !important;
                margin: 0 !important;
            }

            /* FIX 7: Gap statement containers same margins as Element heading */
            .gap-item,
            [class*="gap-card"],
            [style*="border-radius: 16px"][style*="margin-bottom: 32px"] {
                padding: 16px !important;
                margin: 0 0 16px 0 !important;
                max-width: 100% !important;
            }

            /* FIX: Gap details two-column to ensure tools visible */
            .gap-details {
                padding: 0 !important;
                margin: 0 !important;
            }

            .gap-column {
                width: 100% !important;
                padding: 8px 0 !important;
            }

            /* FIX: Shorten "How to address this" heading on mobile */
            h3:contains("HOW TO ADDRESS THIS"),
            [style*="HOW TO ADDRESS THIS"] {
                font-size: 11px !important;
            }

            /* FIX: Research References - LEFT/RIGHT MARGINS */
            .research-section,
            [style*="RESEARCH REFERENCES"] {
                padding: 16px !important;
                margin: 0 16px 16px 16px !important;
                max-width: calc(100% - 32px) !important;
            }

            .research-item {
                padding: 12px !important;
                margin: 0 0 12px 0 !important;
            }

            .research-quote {
                font-size: 13px !important;
                line-height: 1.5 !important;
                padding: 0 !important;
            }

            /* Fix research content box */
            [style*="border-left: 4px solid #C4FF00"] {
                padding: 12px !important;
                margin: 0 !important;
            }
        }

        /* Small mobile phones (< 480px) */
        @media screen and (max-width: 480px) {
            .container {
                padding: 8px 12px;
            }

            .logo-text {
                font-size: 20px;
                letter-spacing: 0.5px;
            }

            .prelim-section {
                padding: 32px 20px;
                border-radius: 20px;
            }

            .prelim-section h2 {
                font-size: 24px;
                line-height: 1.3;
            }

            .prelim-section p {
                font-size: 15px;
            }

            .question-group {
                padding: 20px 16px;
            }

            .question-label {
                font-size: 16px;
            }

            .radio-option {
                padding: 14px;
            }

            .radio-option label {
                font-size: 14px;
            }

            .btn-primary {
                padding: 16px 24px;
                font-size: 15px;
            }

            .model-wrapper {
                padding: 12px 4px;
            }

            /* Ensure SVG text is readable on tiny screens */
            #sova-model text {
                font-size: 12px;
            }

            .question-container {
                padding: 20px 16px;
            }

            .question-text {
                font-size: 16px;
            }

            .answer-option {
                padding: 14px 16px;
                font-size: 14px;
            }

            .results-header h1 {
                font-size: 28px;
            }

            .results-header p {
                font-size: 15px;
            }

            .score-card {
                padding: 20px 16px;
            }

            .score-details h2 {
                font-size: 20px;
            }

            .report-section {
                padding: 20px 16px;
            }

            .report-section h2 {
                font-size: 20px;
            }

            .report-section h3 {
                font-size: 16px;
            }
        }

        /* Landscape mobile orientation fixes */
        @media screen and (max-height: 500px) and (orientation: landscape) {
            .prelim-section {
                padding: 24px 20px;
            }

            .model-wrapper {
                padding: 12px;
                margin-top: -10px;
            }

            .question-container {
                padding: 20px;
            }
        }

        /* Touch-friendly enhancements for all mobile devices */
        @media (hover: none) and (pointer: coarse) {
            /* Increase touch targets */
            .radio-option,
            .answer-option,
            button,
            .btn-primary,
            .btn-nav,
            .btn-back {
                min-height: 44px;
            }

            /* Disable hover effects on touch devices */
            .radio-option:hover,
            .answer-option:hover,
            .element-dot:hover {
                transform: none;
            }

            /* Better tap feedback */
            .radio-option:active,
            .answer-option:active,
            button:active,
            .btn-primary:active {
                transform: scale(0.98);
                opacity: 0.9;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo-text">SOVA</div>
        </div>

        <!-- STEP 1: Preliminary Questions Section -->
        <div class="prelim-section" id="step1Section">
            <!-- Welcome Introduction: Minimal, Sophisticated Hero -->
            <div style="max-width: 720px; margin: 0 auto 80px auto; padding: 0;">
                <h1 style="color: #3D2517; font-size: clamp(32px, 5vw, 56px); font-weight: 700; margin: 0 0 40px 0; letter-spacing: -2px; line-height: 1.1;">
                    Beat the startup failure odds. Learn once, apply forever.
                </h1>

                <p style="color: #3D2517; font-size: clamp(16px, 2vw, 20px); line-height: 1.6; margin: 0 0 28px 0; font-weight: 400;">
                    Startup advice is everywhere  but it's fragmented and overwhelming. Sova distils the complex into simple, actionable guidance in one place.
                </p>

                <p style="color: #3D2517; font-size: clamp(15px, 1.8vw, 18px); line-height: 1.7; margin: 0 0 28px 0; opacity: 0.8;">
                    We studied why startups fail, what makes them succeed, and how mature companies achieve business excellence. Then we synthesised it all into a practical self-assessment tool that helps you identify and address your biggest risks.
                </p>

                <p style="color: #3D2517; font-size: clamp(15px, 1.8vw, 18px); line-height: 1.7; margin: 0 0 56px 0; opacity: 0.8;">
                    Sova gives you the same diagnostic frameworks consultants, accelerators and business experts use  empowering you to build on proven foundations from day one.
                </p>

                <!-- MVP Thank You - Minimal Treatment -->
                <div style="border-left: 3px solid #C4FF00; padding-left: 24px; margin-bottom: 64px;">
                    <p style="color: #3D2517; font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.2px; margin: 0 0 12px 0; opacity: 0.6;">Thanks for being an early adopter</p>
                    <p style="color: #3D2517; font-size: 15px; line-height: 1.7; margin: 0; opacity: 0.75;">
                        You're part of our user acceptance group of our product hopefully launching February 2026. Your feedback will directly shape how Sova evolves and in return, you'll get 50% off when we launch, should you wish to use it. Please have a go at using Sova and provide feedback via the survey sent to you. Thank you kindly in advance.
                    </p>
                </div>
            </div>

            <h2>Let's get started</h2>

            <!-- MVP Start Fresh Button -->
            <button onclick="startFresh()" style="margin-top: 12px; margin-bottom: 24px; padding: 8px 16px; background: #ff6b6b; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 12px;">Start Fresh</button>

            <!-- Q1: Team Size (CRITICAL) -->
            <div class="question-group">
                <label class="question-label">1. Are you Solo or Team?</label>
                <small style="display: block; margin-bottom: 12px; color: #5a4a3a;">We'll tailor the questions to match whether you're working alone or with others.</small>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <div class="radio-option">
                        <input type="radio" name="teamSize" value="Solo" id="team-solo">
                        <label for="team-solo">Solo (just me)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="teamSize" value="Team" id="team-team">
                        <label for="team-team">Team (2+ people)</label>
                    </div>
                </div>
            </div>

            <!-- Q2: Startup Stage (CRITICAL) -->
            <div class="question-group">
                <label class="question-label">2. What stage do you think you're at?</label>
                <small style="display: block; margin-bottom: 12px; color: #5a4a3a;">This helps us focus on what matters most for where you are now.</small>
                <div style="display: flex; flex-direction: column; gap: 8px;">
                    <div class="radio-option">
                        <input type="radio" name="stage" value="Discovery" id="stage-discovery">
                        <label for="stage-discovery">Discovery (finding a problem to solve and developing a solution)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="stage" value="Validation" id="stage-validation">
                        <label for="stage-validation">Validation (proving customers will pay for the solution)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="stage" value="Efficiency" id="stage-efficiency">
                        <label for="stage-efficiency">Efficiency (refining the business model and processes)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="stage" value="Scale" id="stage-scale">
                        <label for="stage-scale">Scale (growing rapidly by expanding market share)</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="stage" value="Unsure" id="stage-unsure">
                        <label for="stage-unsure">Unsure</label>
                    </div>
                </div>
            </div>

            <!-- Q3: Location (CRITICAL) -->
            <div class="question-group">
                <label class="question-label">3. Which state or territory are you in?</label>
                <small style="display: block; margin-bottom: 12px; color: #5a4a3a;">We'll connect you with local resources and support specific to your region.</small>
                <select id="location" required>
                    <option value="">-- Select a state or territory --</option>
                    <option value="ACT">ACT</option>
                    <option value="NSW">NSW</option>
                    <option value="NT">NT</option>
                    <option value="QLD">QLD</option>
                    <option value="SA">SA</option>
                    <option value="TAS">TAS</option>
                    <option value="VIC">VIC</option>
                    <option value="WA">WA</option>
                </select>
            </div>

            <button class="btn-primary" onclick="continueToValidation()" style="margin-top: 24px;">Continue</button>
        </div>

        <!-- STEP 2: Stage Validation Section - Compressed for one-page fit -->
        <div class="prelim-section" id="step2Section" style="display: none; max-height: 90vh; overflow-y: auto; padding: 20px;">
            <h2 id="validationHeading" style="font-size: 22px; margin-bottom: 16px; color: #3D2517;"></h2>

            <div id="validationQuestions" style="margin-bottom: 16px;">
                <!-- Will be populated by JavaScript based on selected stage -->
            </div>

            <div id="validationResult" style="display: none; margin-bottom: 16px;">
                <!-- Will show recommendation -->
            </div>

            <div id="validationButtons" style="display: flex; gap: 12px;">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>

        <!-- Questionnaire Section -->
        <div class="questionnaire-section" id="questionnaireSection">
            <div class="questionnaire-container">
                <!-- Exit Button -->
                <button class="exit-btn" onclick="exitQuestionnaire()" title="Save and exit"></button>

                <!-- Progress Bar -->
                <div class="progress-bar-container">
                    <div class="progress-info">
                        <div class="element-badge" id="elementBadge">Governance</div>
                        <span id="questionProgress">Question 1 of 13</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Question -->
                <div class="question-container">

                    <!-- Info Buttons Row -->
                    <div class="info-buttons-row" id="infoButtonsRow"></div>

                    <!-- Info Content Sections -->
                    <div id="infoContent"></div>

                    <!-- Question Text -->
                    <div class="question-text" id="questionText">Loading question...</div>
                </div>

                <!-- Answer Buttons -->
                <div class="answer-buttons">
                    <button class="answer-btn" id="answerYes" onclick="selectAnswer(true)">Yes</button>
                    <button class="answer-btn" id="answerNo" onclick="selectAnswer(false)">No</button>
                </div>

                <!-- Navigation -->
                <div class="navigation-buttons">
                    <button class="nav-btn" id="prevBtn" onclick="previousQuestion()" disabled>Previous</button>
                    <button class="nav-btn" id="saveExitBtn" onclick="exitQuestionnaire()">Save & Exit</button>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection">
            <div class="results-container">
                <!-- Results Header -->
                <div class="results-header">
                    <h1 id="resultsTitle">Assessment Results</h1>
                    <p id="resultsSubtitle"></p>
                </div>

                <!-- Score and Stage Progression -->
                <div class="score-card">
                    <div class="score-visual">
                        <svg viewBox="0 0 200 200" width="200" height="200">
                            <circle cx="100" cy="100" r="90" fill="none" stroke="#E8C547" stroke-width="4" opacity="0.2"/>
                            <circle id="scoreCircle" cx="100" cy="100" r="90" fill="none" stroke="#C4FF00" stroke-width="8"
                                    stroke-dasharray="565" stroke-dashoffset="565"
                                    transform="rotate(-90 100 100)" stroke-linecap="round"/>
                            <text x="100" y="95" text-anchor="middle" font-size="48" font-weight="bold" fill="#C4FF00" id="scorePercent">0%</text>
                            <text x="100" y="120" text-anchor="middle" font-size="16" fill="#f5f1e8" opacity="0.8" id="scoreLabel">Complete</text>
                        </svg>
                    </div>
                    <div class="score-details">
                        <h2 id="scoreHeading">Your Readiness Score</h2>
                        <p id="scoreDescription"></p>
                        <div class="score-breakdown" id="scoreBreakdown"></div>
                    </div>
                </div>

                <!-- Stage Progression Tracker -->
                <div id="stageProgressionTracker"></div>

                <!-- Golden Circle: Why, How, What -->
                <div id="goldenCircleContent"></div>

                <!-- Action Buttons -->
                <div class="results-actions">
                    <button class="btn-primary" onclick="downloadReport()">Download Report (PDF)</button>
                    <button class="btn-secondary" onclick="emailReport()">Email Report</button>
                    <button class="btn-secondary" onclick="backToModel()">Back to Assessment</button>
                </div>
            </div>
        </div>

        <!-- Model Section -->
        <div class="model-section" id="modelSection">
            <div class="model-wrapper">
                <svg id="sova-model" viewBox="0 0 1300 1300" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                    <!-- Define curved paths for text -->
                    <defs>
                        <!-- Gradients for premium ring styling -->
                        <radialGradient id="discoveryGradient" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#C5D952;stop-opacity:0.25" />
                            <stop offset="100%" style="stop-color:#C5D952;stop-opacity:0.08" />
                        </radialGradient>
                        <radialGradient id="validationGradient" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#E8C547;stop-opacity:0.25" />
                            <stop offset="100%" style="stop-color:#E8C547;stop-opacity:0.08" />
                        </radialGradient>
                        <radialGradient id="efficiencyGradient" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#C5D952;stop-opacity:0.25" />
                            <stop offset="100%" style="stop-color:#C5D952;stop-opacity:0.08" />
                        </radialGradient>
                        <radialGradient id="scaleGradient" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#E8C547;stop-opacity:0.25" />
                            <stop offset="100%" style="stop-color:#E8C547;stop-opacity:0.08" />
                        </radialGradient>
                        <radialGradient id="centerGlow" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#C4FF00;stop-opacity:0.4" />
                            <stop offset="100%" style="stop-color:#C4FF00;stop-opacity:0.1" />
                        </radialGradient>

                        <!-- Paths for SCALE text (outermost scoring ring, top arc) - r=400 middle, center (650,650) -->
                        <path id="scalePath" d="M 250,650 A 400,400 0 0,1 1050,650" fill="none"/>
                        <path id="scaleSubPath" d="M 250,675 A 400,400 0 0,1 1050,675" fill="none"/>

                        <!-- Paths for EFFICIENCY text (third ring, top arc) - r=300 middle, center (650,650) -->
                        <path id="efficiencyPath" d="M 350,650 A 300,300 0 0,1 950,650" fill="none"/>
                        <path id="efficiencySubPath" d="M 350,675 A 300,300 0 0,1 950,675" fill="none"/>

                        <!-- Paths for VALIDATION text (second ring, top arc) - r=200 middle, center (650,650) -->
                        <path id="validationPath" d="M 450,650 A 200,200 0 0,1 850,650" fill="none"/>
                        <path id="validationSubPath" d="M 450,675 A 200,200 0 0,1 850,675" fill="none"/>

                        <!-- Paths for DISCOVERY text (innermost ring, top arc) - r=100 middle, center (650,650) -->
                        <path id="discoveryPath" d="M 550,650 A 100,100 0 0,1 750,650" fill="none"/>
                        <path id="discoverySubPath" d="M 550,675 A 100,100 0 0,1 750,675" fill="none"/>
                    </defs>

                    <!-- 4 Scoring Rings with premium styling - center (650,650) -->

                    <!-- Scale (outermost scoring ring: r=350 to r=450) -->
                    <circle cx="650" cy="650" r="450" fill="none" stroke="#E8C547" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="350" fill="none" stroke="#E8C547" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="400" fill="url(#scaleGradient)" stroke="none" stroke-width="100"/>

                    <!-- Efficiency (third ring: r=250 to r=350) -->
                    <circle cx="650" cy="650" r="350" fill="none" stroke="#C5D952" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="250" fill="none" stroke="#C5D952" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="300" fill="url(#efficiencyGradient)" stroke="none" stroke-width="100"/>

                    <!-- Validation (second ring: r=150 to r=250) -->
                    <circle cx="650" cy="650" r="250" fill="none" stroke="#E8C547" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="150" fill="none" stroke="#E8C547" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="200" fill="url(#validationGradient)" stroke="none" stroke-width="100"/>

                    <!-- Discovery (innermost ring: r=50 to r=150) -->
                    <circle cx="650" cy="650" r="150" fill="none" stroke="#C5D952" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="50" fill="none" stroke="#C5D952" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="100" fill="url(#discoveryGradient)" stroke="none" stroke-width="100"/>

                    <!-- Stage Labels - curved along circles -->
                    <!-- DISCOVERY -->
                    <text font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#f5f1e8" opacity="0.9">
                        <textPath href="#discoveryPath" startOffset="50%" text-anchor="middle">DISCOVERY</textPath>
                    </text>
                    <text font-family="Arial, sans-serif" font-size="12" font-style="italic" fill="#E8C547" opacity="0.8">
                        <textPath href="#discoverySubPath" startOffset="50%" text-anchor="middle">Building Foundations</textPath>
                    </text>

                    <!-- VALIDATION -->
                    <text font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#f5f1e8" opacity="0.9">
                        <textPath href="#validationPath" startOffset="50%" text-anchor="middle">VALIDATION</textPath>
                    </text>
                    <text font-family="Arial, sans-serif" font-size="12" font-style="italic" fill="#E8C547" opacity="0.8">
                        <textPath href="#validationSubPath" startOffset="50%" text-anchor="middle">Proving the Model</textPath>
                    </text>

                    <!-- EFFICIENCY -->
                    <text font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#f5f1e8" opacity="0.9">
                        <textPath href="#efficiencyPath" startOffset="50%" text-anchor="middle">EFFICIENCY</textPath>
                    </text>
                    <text font-family="Arial, sans-serif" font-size="12" font-style="italic" fill="#E8C547" opacity="0.8">
                        <textPath href="#efficiencySubPath" startOffset="50%" text-anchor="middle">Optimising Systems</textPath>
                    </text>

                    <!-- SCALE -->
                    <text font-family="Arial, sans-serif" font-size="15" font-weight="bold" fill="#f5f1e8" opacity="0.9">
                        <textPath href="#scalePath" startOffset="50%" text-anchor="middle">SCALE</textPath>
                    </text>
                    <text font-family="Arial, sans-serif" font-size="12" font-style="italic" fill="#E8C547" opacity="0.8">
                        <textPath href="#scaleSubPath" startOffset="50%" text-anchor="middle">Innovation &amp; Growth</textPath>
                    </text>

                    <!-- Web Chart Overlay (Score Visualization) -->
                    <!-- Individual element wedges (filled from center to score) -->
                    <g id="webChartWedges"></g>
                    <!-- Connecting polygon (when 3+ elements completed) -->
                    <polygon id="webChart" points="" fill="rgba(196, 255, 0, 0.15)" stroke="#C4FF00" stroke-width="4" stroke-linejoin="round" style="display: none;"/>

                    <!-- Center Circle - Premium Styling -->
                    <g id="sova-center-circle" style="cursor: help;">
                        <circle cx="650" cy="650" r="50" fill="url(#centerGlow)"/>
                        <circle cx="650" cy="650" r="50" fill="#C4FF00" opacity="0.95"/>
                        <text x="650" y="650" font-family="Arial, sans-serif" font-size="22" font-weight="900" fill="#3D2517" text-anchor="middle" dominant-baseline="middle" letter-spacing="-0.5">SOVA</text>
                    </g>

                    <!-- Element Dots on Outer Ring (r=510) with Premium Styling - center (650,650) -->
                    <!-- 9 elements evenly spaced at 40 intervals, starting from 0 (12 o'clock) clockwise -->
                    <!-- Lines start at r=50 (edge of center circle), dots at r=510 -->

                    <!-- GOVERNANCE (0 / 12 o'clock) - ACTIVE -->
                    <line x1="650" y1="600" x2="650" y2="140" stroke="#C5D952" stroke-width="2.5" opacity="0.7" class="element-spoke"/>
                    <circle cx="650" cy="140" r="18" fill="#C5D952" class="element-dot active" id="governance-dot" style="filter: drop-shadow(0 2px 8px rgba(197, 217, 82, 0.5)); cursor: pointer;" onclick="startElementAssessment('Governance')"/>
                    <text x="650" y="115" font-family="Arial, sans-serif" font-size="16" font-weight="800" fill="#C4FF00" text-anchor="middle" letter-spacing="0.5" style="cursor: pointer;" onclick="startElementAssessment('Governance')">GOVERNANCE</text>

                    <!-- PURPOSE (40) - ACTIVE -->
                    <line x1="682" y1="612" x2="978" y2="259" stroke="#E8C547" stroke-width="2.5" opacity="0.7"/>
                    <circle cx="978" cy="259" r="18" fill="#E8C547" class="element-dot active" id="purpose-dot" style="filter: drop-shadow(0 2px 8px rgba(232, 197, 71, 0.5)); cursor: pointer;" onclick="startElementAssessment('Purpose')"/>
                    <text x="1015" y="247" font-family="Arial, sans-serif" font-size="16" font-weight="800" fill="#E8C547" text-anchor="start" letter-spacing="0.5" style="cursor: pointer;" onclick="startElementAssessment('Purpose')">PURPOSE</text>

                    <!-- STRATEGY (80) - ACTIVE -->
                    <line x1="699" y1="641" x2="1152" y2="561" stroke="#C5D952" stroke-width="2.5" opacity="0.7"/>
                    <circle cx="1152" cy="561" r="18" fill="#C5D952" class="element-dot active" id="strategy-dot" style="filter: drop-shadow(0 2px 8px rgba(197, 217, 82, 0.5)); cursor: pointer;" onclick="startElementAssessment('Strategy')"/>
                    <text x="1180" y="567" font-family="Arial, sans-serif" font-size="16" font-weight="800" fill="#C4FF00" text-anchor="start" letter-spacing="0.5" style="cursor: pointer;" onclick="startElementAssessment('Strategy')">STRATEGY</text>

                    <!-- PERFORMANCE (120) - LOCKED -->
                    <line x1="693" y1="675" x2="1092" y2="905" stroke="#E8C547" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="1092" cy="905" r="18" fill="#E8C547" class="element-dot locked" id="performance-dot" opacity="0.4"/>
                    <text x="1125" y="920" font-family="Arial, sans-serif" font-size="16" fill="#f5f1e8" text-anchor="start" opacity="0.3" letter-spacing="0.5">PERFORMANCE</text>

                    <!-- MARKETING (160) - ACTIVE -->
                    <line x1="667" y1="697" x2="824" y2="1129" stroke="#C5D952" stroke-width="2.5" opacity="0.7"/>
                    <circle cx="824" cy="1129" r="18" fill="#C5D952" class="element-dot active" id="marketing-dot" style="filter: drop-shadow(0 2px 8px rgba(197, 217, 82, 0.5)); cursor: pointer;" onclick="startElementAssessment('Marketing')"/>
                    <text x="824" y="1160" font-family="Arial, sans-serif" font-size="16" font-weight="800" fill="#C4FF00" text-anchor="middle" letter-spacing="0.5" style="cursor: pointer;" onclick="startElementAssessment('Marketing')">MARKETING</text>

                    <!-- FINANCE (200) - LOCKED -->
                    <line x1="633" y1="697" x2="476" y2="1129" stroke="#E8C547" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="476" cy="1129" r="18" fill="#E8C547" class="element-dot locked" id="finance-dot" opacity="0.4"/>
                    <text x="476" y="1160" font-family="Arial, sans-serif" font-size="16" fill="#f5f1e8" text-anchor="middle" opacity="0.3" letter-spacing="0.5">FINANCE</text>

                    <!-- PEOPLE (240) - LOCKED -->
                    <line x1="607" y1="675" x2="208" y2="905" stroke="#C5D952" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="208" cy="905" r="18" fill="#C5D952" class="element-dot locked" id="people-dot" opacity="0.4"/>
                    <text x="175" y="920" font-family="Arial, sans-serif" font-size="16" fill="#f5f1e8" text-anchor="end" opacity="0.3" letter-spacing="0.5">PEOPLE</text>

                    <!-- PROCESS (280) - LOCKED -->
                    <line x1="601" y1="641" x2="148" y2="561" stroke="#E8C547" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="148" cy="561" r="18" fill="#E8C547" class="element-dot locked" id="process-dot" opacity="0.4"/>
                    <text x="120" y="567" font-family="Arial, sans-serif" font-size="16" fill="#f5f1e8" text-anchor="end" opacity="0.3" letter-spacing="0.5">PROCESS</text>

                    <!-- TECHNOLOGY (320) - LOCKED -->
                    <line x1="618" y1="612" x2="322" y2="259" stroke="#C5D952" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="322" cy="259" r="18" fill="#C5D952" class="element-dot locked" id="technology-dot" opacity="0.4"/>
                    <text x="285" y="247" font-family="Arial, sans-serif" font-size="16" fill="#f5f1e8" text-anchor="end" opacity="0.3" letter-spacing="0.5">TECHNOLOGY</text>
                </svg>

                <!-- Tooltip -->
                <div class="tooltip" id="tooltip">
                    <div class="tooltip-title"></div>
                    <div class="tooltip-desc"></div>
                </div>
            </div>
        </div>

        <!-- Combined Report Section - Visible from start, updates live -->
        <div class="report-section" id="reportSection" style="display: none; margin-top: 120px;">
            <div class="report-container">
                <!-- DASHBOARD LAYOUT - Completely New Approach -->

                <!-- Hero Score Overview -->
                <div style="background: #3D2517; padding: 80px 60px 80px 60px; position: relative; overflow: hidden;">
                    <div style="max-width: 1200px; margin: 0 auto;">
                        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 60px; align-items: center;">
                            <!-- Left: Title + Summary -->
                            <div>
                                <h1 style="color: #C4FF00; font-size: clamp(28px, 5vw, 60px); font-weight: 800; margin: 0 0 24px 0; letter-spacing: -2px; line-height: 1; white-space: nowrap;">Your Startup Health</h1>
                                <div id="statusContent">
                                    <p style="color: #f5f1e8; font-size: 20px; line-height: 1.6; margin: 0; opacity: 0.9;">Your assessment results appear here...</p>
                                </div>
                            </div>

                            <!-- Right: Big Visual Score (to be populated by JS) -->
                            <div id="overallScoreVisual" style="text-align: center;">
                                <!-- Will be populated with large score circle -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 4-Column Element Comparison Grid -->
                <div style="background: #f5f1e8; padding: 60px;">
                    <div style="max-width: 1400px; margin: 0 auto;">
                        <h2 style="color: #3D2517; font-size: 32px; font-weight: 700; margin: 0 0 40px 0; letter-spacing: -1px;">Element Breakdown</h2>

                        <!-- Element Cards Grid -->
                        <div id="elementGrid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                            <!-- Will be populated with element cards -->
                        </div>
                    </div>
                </div>

                <!-- Expandable Gaps Section -->
                <div style="background: #f5f1e8; padding: 60px;">
                    <div style="max-width: 1200px; margin: 0 auto;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px;">
                            <h2 style="color: #3D2517; font-size: 32px; font-weight: 700; margin: 0; letter-spacing: -1px;">Your Gaps</h2>
                            <p style="color: #3D2517; opacity: 0.5; margin: 0; font-size: 14px;">Click an element above to filter</p>
                        </div>
                        <div id="gapsContent">
                            <p class="placeholder-text">Your gaps will appear here...</p>
                        </div>
                    </div>
                </div>

                <!-- Sticky Web Chart Sidebar (above Report on right) - Hidden until pictorial shown -->
                <div id="webChartSidebar" style="display: none; position: fixed; right: 0; bottom: 260px; width: 60px; background: #C5D952; border-radius: 12px 0 0 12px; padding: 20px 16px; cursor: pointer; transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); z-index: 1000; box-shadow: -4px 0 12px rgba(0,0,0,0.1);" onclick="scrollToWebChart()" onmouseover="this.style.width='75px'; this.style.paddingLeft='28px'; this.style.boxShadow='-8px 0 20px rgba(197,217,82,0.4)'; this.style.background='#D0E366';" onmouseout="this.style.width='60px'; this.style.paddingLeft='16px'; this.style.boxShadow='-4px 0 12px rgba(0,0,0,0.1)'; this.style.background='#C5D952';">
                    <div style="writing-mode: vertical-rl; transform: rotate(180deg); color: #3D2517; font-weight: 700; font-size: 14px; letter-spacing: 1px;">WEB CHART</div>
                </div>

                <!-- Sticky Report Sidebar (above Actions on right) - Hidden until pictorial shown -->
                <div id="reportSidebar" style="display: none; position: fixed; right: 0; bottom: 140px; width: 60px; background: #E8C547; border-radius: 12px 0 0 12px; padding: 20px 16px; cursor: pointer; transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); z-index: 1000; box-shadow: -4px 0 12px rgba(0,0,0,0.1);" onclick="scrollToReport()" onmouseover="this.style.width='75px'; this.style.paddingLeft='28px'; this.style.boxShadow='-8px 0 20px rgba(232,197,71,0.4)'; this.style.background='#EDD066';" onmouseout="this.style.width='60px'; this.style.paddingLeft='16px'; this.style.boxShadow='-4px 0 12px rgba(0,0,0,0.1)'; this.style.background='#E8C547';">
                    <div style="writing-mode: vertical-rl; transform: rotate(180deg); color: #3D2517; font-weight: 700; font-size: 14px; letter-spacing: 1px;">REPORT</div>
                </div>

                <!-- Sticky Action Sidebar (at bottom on right) -->
                <div id="actionSidebar" style="position: fixed; right: 0; bottom: 20px; width: 60px; background: #C4FF00; border-radius: 12px 0 0 12px; padding: 20px 16px; cursor: pointer; transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); z-index: 1000; box-shadow: -4px 0 12px rgba(0,0,0,0.1);" onclick="toggleActionPanel()" onmouseover="this.style.width='75px'; this.style.paddingLeft='28px'; this.style.boxShadow='-8px 0 20px rgba(196,255,0,0.4)'; this.style.background='#D4FF33';" onmouseout="this.style.width='60px'; this.style.paddingLeft='16px'; this.style.boxShadow='-4px 0 12px rgba(0,0,0,0.1)'; this.style.background='#C4FF00';">
                    <div style="writing-mode: vertical-rl; transform: rotate(180deg); color: #3D2517; font-weight: 700; font-size: 14px; letter-spacing: 1px;">ACTIONS</div>
                </div>

                <!-- Slide-out Action Panel -->
                <div id="actionPanel" style="position: fixed; right: -400px; top: 0; bottom: 0; width: 400px; background: white; box-shadow: -8px 0 24px rgba(0,0,0,0.15); z-index: 999; transition: right 0.4s cubic-bezier(0.23, 1, 0.32, 1); overflow-y: auto;">
                    <div style="background: #3D2517; padding: 32px; position: sticky; top: 0; z-index: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="color: #C4FF00; font-size: 24px; font-weight: 700; margin: 0; letter-spacing: -0.5px;">Priority Actions</h3>
                            <button onclick="toggleActionPanel()" style="background: none; border: none; color: #C4FF00; font-size: 28px; cursor: pointer; padding: 0; line-height: 1;"></button>
                        </div>
                    </div>
                    <div id="todoContent" style="padding: 32px;">
                        <p class="placeholder-text">Your action checklist will appear here...</p>
                    </div>
                </div>

                <script>
                function scrollToWebChart() {
                    const modelSection = document.getElementById('modelSection');
                    if (modelSection) {
                        modelSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }

                function scrollToReport() {
                    const reportSection = document.getElementById('reportSection');
                    if (reportSection) {
                        reportSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }

                function toggleActionPanel() {
                    const panel = document.getElementById('actionPanel');
                    const sidebar = document.getElementById('actionSidebar');
                    if (panel && sidebar) {
                        if (panel.style.right === '0px') {
                            panel.style.right = '-400px';
                            sidebar.style.right = '0';
                        } else {
                            panel.style.right = '0px';
                            sidebar.style.right = '400px';
                        }
                    }
                }

                // Track currently filtered element for gaps section
                let currentFilterElement = null;

                function filterGapsByElement(elementName) {
                    // Update filter state
                    if (elementName === null || elementName === 'null') {
                        currentFilterElement = null; // Show all
                    } else if (currentFilterElement === elementName) {
                        currentFilterElement = null; // Toggle off if clicking same element
                    } else {
                        currentFilterElement = elementName; // Filter to this element
                    }

                    // Re-render gaps with filter applied
                    updateReportLive();

                    // Scroll to gaps section after re-render
                    setTimeout(() => {
                        const gapsSection = document.getElementById('gapsContent');
                        if (gapsSection && gapsSection.parentElement) {
                            gapsSection.parentElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }, 100);
                }
                </script>

                <!-- Action Buttons -->
                <div class="report-actions" id="reportActions" style="display: none;">
                    <button class="btn-primary" onclick="downloadPDF()">Download PDF Report</button>
                    <button class="btn-secondary" onclick="emailReport()">Email Report to Me</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Element data
        const elements = {
            'governance-dot': { name: 'Governance', desc: 'Values, controls, ethics, accountability', active: true, questions: 13 },
            'purpose-dot': { name: 'Purpose', desc: 'Vision, mission, why you exist', active: true, questions: 12 },
            'strategy-dot': { name: 'Strategy', desc: 'Plans, priorities, positioning', active: true, questions: 11 },
            'marketing-dot': { name: 'Marketing', desc: 'Customer experience and branding', active: true, questions: 9 },
            'performance-dot': { name: 'Performance', desc: 'KPIs, metrics, data-driven decisions', active: false, questions: 16 },
            'finance-dot': { name: 'Finance', desc: 'Financial management and planning', active: false, questions: 16 },
            'people-dot': { name: 'People', desc: 'Talent, culture, development', active: false, questions: 16 },
            'process-dot': { name: 'Process', desc: 'Processes, workflows, systems', active: false, questions: 14 },
            'technology-dot': { name: 'Technology', desc: 'Digital tools and infrastructure', active: false, questions: 16 }
        };

        // Store user data
        let userData = {
            teamSize: '',
            selectedStage: '',
            location: '',
            aimingForVC: true, // Always show VC considerations
            validationPassed: false,
            assessmentStartStage: ''
        };

        // Validation questions by stage (based on Self Assessment Structure.xlsx)
        const validationQuestions = {
            'Validation': {
                heading: "Let's quickly check you've completed Discovery foundations",
                questions: [
                    "Have you considered/completed all the Australian startup business establishment requirements?",
                    "Do you have a business plan that explains why the business exists and how it will make money?",
                    "Do you know who you're serving and what problem you're solving for them?"
                ]
            },
            'Efficiency': {
                heading: "Let's quickly check you've completed Validation foundations",
                questions: [
                    "Do you solve a real problem that mainstream customers (not just early supporters) will pay for?",
                    "Do you make more money than you spend each month, OR have at least 12 months of savings?",
                    "Do you have a system for collecting customer feedback (surveys, interviews, NPS)?"
                ]
            },
            'Scale': {
                heading: "Let's quickly check you've completed Efficiency foundations",
                questions: [
                    "Do you have documented processes and systems that can handle growth without breaking?",
                    "Do you use multiple marketing channels (not dependent on just one way to reach customers)?",
                    "Do you have a 12-month cash flow forecast (not just tracking history)?"
                ]
            }
        };

        // Start Fresh - Clear all progress
        function startFresh() {
            if (confirm('This will clear all your progress and start fresh. Are you sure?')) {
                // Clear ALL localStorage keys for complete reset
                localStorage.removeItem('sovaMultiElementProgress');
                localStorage.removeItem('sovaUserData');
                localStorage.removeItem('sovaAssessmentProgress');
                localStorage.removeItem('sovaAllResults');
                console.log(' All session data cleared - complete reset');

                // Force hard refresh to bypass cache
                // This ensures the latest JavaScript code is loaded
                window.location.href = window.location.href + '?t=' + new Date().getTime();
            }
        }

        // STEP 1: Continue to validation
        function continueToValidation() {
            console.log('Continue button clicked');

            // Validate required fields
            const teamSize = document.querySelector('input[name="teamSize"]:checked')?.value;
            const stage = document.querySelector('input[name="stage"]:checked')?.value;
            const location = document.getElementById('location').value;

            console.log('Form values:', { teamSize, stage, location });

            if (!teamSize) {
                alert('Please select Solo or Team');
                return;
            }
            if (!stage) {
                alert('Please select your stage');
                return;
            }
            if (!location) {
                alert('Please select your state or territory');
                return;
            }

            // FIXED: Clear old assessment data when starting fresh assessment
            console.log(' Clearing old assessment data...');
            multiElementProgress = {
                elementsCompleted: [],
                elementsRemaining: ['Governance', 'Purpose', 'Strategy', 'Marketing'],
                allComplete: false,
                results: {}
            };
            localStorage.removeItem('sovaMultiElementProgress');
            console.log(' Assessment data cleared');

            // Store data
            userData.teamSize = teamSize;
            userData.selectedStage = stage;
            userData.location = location;
            userData.aimingForVC = true; // Always show VC considerations

            // Hide Step 1
            document.getElementById('step1Section').style.display = 'none';

            // Check if validation needed
            if (stage === 'Discovery' || stage === 'Unsure') {
                // No validation needed, go straight to model
                userData.assessmentStartStage = 'Discovery';
                showModel();
            } else {
                // Show validation questions
                showValidationQuestions(stage);
            }
        }

        // STEP 2: Show validation questions
        function showValidationQuestions(stage) {
            const validationData = validationQuestions[stage];

            // Set heading
            document.getElementById('validationHeading').textContent = validationData.heading;

            // Build validation questions HTML - compressed for one-page fit
            let questionsHTML = '<div style="display: flex; flex-direction: column; gap: 8px;">';
            validationData.questions.forEach((q, index) => {
                questionsHTML += `
                    <div style="margin-bottom: 12px;">
                        <label style="display: block; font-size: 15px; font-weight: 500; color: #3D2517; margin-bottom: 10px; line-height: 1.4;">${q}</label>
                        <div style="display: flex; gap: 16px;">
                            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 20px; background: white; border: 2px solid rgba(61, 37, 23, 0.3); border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; color: #3D2517; transition: all 0.2s ease;">
                                <input type="radio" name="val${index}" value="yes" id="val${index}-yes" style="margin: 0;">
                                <span>Yes</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 20px; background: white; border: 2px solid rgba(61, 37, 23, 0.3); border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; color: #3D2517; transition: all 0.2s ease;">
                                <input type="radio" name="val${index}" value="no" id="val${index}-no" style="margin: 0;">
                                <span>No</span>
                            </label>
                        </div>
                    </div>
                `;
            });
            questionsHTML += '</div>';

            document.getElementById('validationQuestions').innerHTML = questionsHTML;

            // Show check button
            document.getElementById('validationButtons').innerHTML = `
                <button class="btn-primary" onclick="checkValidation()">Check My Stage</button>
            `;

            // Show Step 2
            document.getElementById('step2Section').style.display = 'block';
        }

        // Check validation answers
        function checkValidation() {
            const stage = userData.selectedStage;
            const validationData = validationQuestions[stage];

            // Check all answers
            const answers = [];
            for (let i = 0; i < validationData.questions.length; i++) {
                const answer = document.querySelector(`input[name="val${i}"]:checked`)?.value;
                if (!answer) {
                    alert('Please answer all validation questions');
                    return;
                }
                answers.push(answer);
            }

            // Check if all YES
            const allYes = answers.every(a => a === 'yes');
            userData.validationPassed = allYes;

            const resultDiv = document.getElementById('validationResult');
            const buttonsDiv = document.getElementById('validationButtons');

            if (allYes) {
                // Passed - proceed to selected stage
                resultDiv.innerHTML = `
                    <div style="background: #d4f4dd; border-left: 4px solid #4caf50; padding: 12px; border-radius: 4px;">
                        <strong style="color: #1a5928; font-size: 16px;">Great! Let's assess your ${stage} stage</strong>
                    </div>
                `;
                userData.assessmentStartStage = stage;

                buttonsDiv.innerHTML = `
                    <button class="btn-primary" onclick="showModel()">Continue to Assessment</button>
                `;
            } else {
                // Failed - recommend previous stage
                const previousStage = (stage === 'Validation') ? 'Discovery' :
                                     (stage === 'Efficiency') ? 'Validation' : 'Efficiency';

                resultDiv.innerHTML = `
                    <div style="background: #ffe08a; border-left: 4px solid #ff9800; padding: 12px; border-radius: 4px; color: #3D2517;">
                        <strong style="font-size: 15px;">We'd recommend starting at ${previousStage} to build foundations first</strong>
                    </div>
                `;

                buttonsDiv.innerHTML = `
                    <button class="btn-primary" onclick="startAtStage('${previousStage}')">Start at ${previousStage}</button>
                    <button class="btn-primary" style="background: white; color: var(--sova-coffee); border: 2px solid var(--sova-coffee);" onclick="startAtStage('${stage}')">No, I want ${stage} anyway</button>
                `;
            }

            resultDiv.style.display = 'block';
        }

        // Start at specific stage
        function startAtStage(stage) {
            userData.assessmentStartStage = stage;
            userData.overrideStage = (stage !== userData.selectedStage);
            showModel();
        }

        // Show model section with demo animation
        function showModel() {
            document.getElementById('step2Section').style.display = 'none';
            document.getElementById('modelSection').classList.add('active');

            // Show sidebars and report section now that we're on pictorial
            document.getElementById('reportSection').style.display = 'block';
            document.getElementById('webChartSidebar').style.display = 'block';
            document.getElementById('reportSidebar').style.display = 'block';

            // Store data in localStorage
            localStorage.setItem('sovaUserData', JSON.stringify(userData));

            console.log('User data stored:', userData);

            // Update web chart with any completed assessments
            updateWebChart();

            // Scroll to top of page
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Load completion status
            loadCompletionStatus();

            // Start demo animation after a brief delay
            setTimeout(() => {
                startDemoAnimation();
            }, 500);
        }

        // Demo animation: glow the next element and gracefully zoom into assessment
        function startDemoAnimation() {
            console.log(' startDemoAnimation() called');
            console.log(' multiElementProgress:', multiElementProgress);

            // Determine which element to start next
            const nextElement = getNextElementToAssess();
            console.log(' Next element to assess:', nextElement);

            if (!nextElement) {
                // All elements complete - no animation needed
                console.log(' All elements complete - no animation');
                return;
            }

            const dotId = nextElement.toLowerCase() + '-dot';
            const dot = document.getElementById(dotId);
            console.log(' Trying to find dot element:', dotId);
            console.log(' Dot found?:', dot ? 'YES' : 'NO');

            if (!dot) {
                console.error(' Dot element not found! ID:', dotId);
                console.log(' All elements with class element-dot:', document.querySelectorAll('.element-dot'));
                return;
            }

            // Scroll to element dot ONLY for Marketing (at bottom of pictorial)
            if (nextElement === 'Marketing') {
                const marketingDot = document.getElementById('marketing-dot');
                if (marketingDot) {
                    // Scroll to center the Marketing dot on the page
                    const dotRect = marketingDot.getBoundingClientRect();
                    const absoluteTop = window.pageYOffset + dotRect.top;
                    const middle = absoluteTop - (window.innerHeight / 2) + (dotRect.height / 2);
                    window.scrollTo({ top: middle, behavior: 'smooth' });
                }
            }

            console.log(' Applying glow animation to dot...');
            // Clear any existing animation first
            dot.style.animation = '';
            // Force reflow
            void dot.offsetWidth;
            // Elegant pulse animation
            dot.style.animation = 'glow 1.2s ease-in-out 2';
            console.log(' Animation applied:', dot.style.animation);

            // After pulse, graceful zoom into assessment
            console.log(' Setting timeout for graceful zoom (2400ms)...');
            setTimeout(() => {
                console.log(' Timeout fired! Starting zoom transition...');
                dot.style.animation = '';
                gracefulZoomToAssessment(nextElement);
            }, 2400); // 2 iterations  1.2s = 2.4s
        }

        // Graceful Zoom Transition to Assessment
        function gracefulZoomToAssessment(elementName) {
            // Create elegant transition overlay
            const transitionOverlay = document.createElement('div');
            transitionOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: radial-gradient(circle at center, rgba(61, 37, 23, 0.8) 0%, rgba(61, 37, 23, 0.95) 100%);
                z-index: 9999;
                opacity: 0;
                transition: opacity 0.6s ease-in-out;
            `;

            document.body.appendChild(transitionOverlay);

            // Fade in overlay
            requestAnimationFrame(() => {
                transitionOverlay.style.opacity = '1';
            });

            // After fade completes, start assessment and fade out
            setTimeout(() => {
                startAssessment(elementName);

                // Fade out overlay
                transitionOverlay.style.opacity = '0';
                setTimeout(() => {
                    transitionOverlay.remove();
                }, 600);
            }, 600);
        }

        // Get Next Element to Assess
        function getNextElementToAssess() {
            const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
            console.log(' Elements completed:', multiElementProgress.elementsCompleted);

            // Find first element not yet completed
            for (let element of elementOrder) {
                if (!multiElementProgress.elementsCompleted.includes(element)) {
                    console.log(' Returning next element:', element);
                    return element;
                }
            }

            console.log(' All elements completed');
            return null; // All complete
        }

        // Auto-start Next Element with elegant transition
        function autoStartNextElement(elementName) {
            console.log(`Auto-starting ${elementName} assessment...`);

            // Show elegant overlay with smooth transitions
            const overlay = document.createElement('div');
            overlay.id = 'elementTransitionOverlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(135deg, rgba(61, 37, 23, 0.95) 0%, rgba(61, 37, 23, 0.98) 100%);
                backdrop-filter: blur(8px);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                opacity: 0;
                animation: smoothFadeIn 0.6s ease-out forwards;
            `;

            // Get element-specific accent colour
            const accentColour = getElementAccentColour(elementName);

            overlay.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #f5f1e8 0%, #ffffff 100%);
                    padding: 48px 56px;
                    border-radius: 24px;
                    max-width: 540px;
                    text-align: center;
                    box-shadow:
                        0 20px 60px rgba(0, 0, 0, 0.3),
                        0 0 0 1px rgba(196, 255, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.9);
                    transform: scale(0.9) translateY(20px);
                    opacity: 0;
                    animation: smoothZoomIn 0.6s ease-out 0.2s forwards;
                ">
                    <div style="
                        width: 80px;
                        height: 80px;
                        margin: 0 auto 24px;
                        background: linear-gradient(135deg, ${accentColour} 0%, #C4FF00 100%);
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        box-shadow: 0 8px 24px rgba(196, 255, 0, 0.3);
                        animation: gentlePulse 2s ease-in-out infinite;
                    ">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#3D2517" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>

                    <h2 style="
                        color: #3D2517;
                        font-size: 28px;
                        font-weight: 600;
                        margin-bottom: 12px;
                        letter-spacing: -0.5px;
                    ">Let's assess your ${elementName}</h2>

                    <p style="
                        color: #6b5d52;
                        font-size: 16px;
                        line-height: 1.6;
                        margin-bottom: 32px;
                        opacity: 0.9;
                    ">
                        We'll start with Discovery and advance based on your answers
                    </p>

                    <div style="display: flex; gap: 12px; justify-content: center;">
                        <button
                            onclick="this.closest('#elementTransitionOverlay').remove(); startAssessment('${elementName}');"
                            style="
                                background: linear-gradient(135deg, #C4FF00 0%, #a8d600 100%);
                                color: #3D2517;
                                border: none;
                                padding: 14px 32px;
                                font-size: 16px;
                                font-weight: 600;
                                border-radius: 12px;
                                cursor: pointer;
                                box-shadow: 0 4px 12px rgba(196, 255, 0, 0.3);
                                transition: all 0.3s ease;
                            "
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(196, 255, 0, 0.4)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(196, 255, 0, 0.3)';"
                        >
                            Start Assessment
                        </button>

                        <button
                            onclick="this.closest('#elementTransitionOverlay').remove();"
                            style="
                                background: white;
                                color: #3D2517;
                                border: 2px solid #e0d9cf;
                                padding: 14px 28px;
                                font-size: 16px;
                                font-weight: 500;
                                border-radius: 12px;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            "
                            onmouseover="this.style.borderColor='#3D2517'; this.style.background='#fafaf8';"
                            onmouseout="this.style.borderColor='#e0d9cf'; this.style.background='white';"
                        >
                            Save & Exit
                        </button>
                    </div>
                </div>
            `;

            document.body.appendChild(overlay);
        }

        // Get element-specific accent colour
        function getElementAccentColour(elementName) {
            const colours = {
                'Governance': '#C4FF00',
                'Purpose': '#E8C547',
                'Strategy': '#C5D952',
                'Marketing': '#A8D600'
            };
            return colours[elementName] || '#C4FF00';
        }

        // Tooltip functionality
        const tooltip = document.getElementById('tooltip');

        Object.keys(elements).forEach(dotId => {
            const dot = document.getElementById(dotId);
            const data = elements[dotId];

            dot.addEventListener('mouseenter', (e) => {
                const tooltipTitle = tooltip.querySelector('.tooltip-title');
                const tooltipDesc = tooltip.querySelector('.tooltip-desc');

                tooltipTitle.textContent = data.name;
                if (data.active) {
                    tooltipDesc.textContent = `${data.desc}. Click to start assessment.`;
                } else {
                    tooltipDesc.innerHTML = '<strong>Coming Soon</strong><br>Available after MVP launch';
                }

                const dotRect = dot.getBoundingClientRect();
                const dotCenterX = dotRect.left + dotRect.width / 2;
                const dotBottom = dotRect.bottom;

                // Center tooltip horizontally and position just below the dot
                tooltip.style.left = (dotCenterX - 100) + 'px';
                tooltip.style.top = (dotBottom + 10) + 'px';
                tooltip.classList.add('show');
            });

            dot.addEventListener('mouseleave', () => {
                tooltip.classList.remove('show');
            });

            dot.addEventListener('click', () => {
                if (data.active) {
                    startAssessment(data.name);
                }
                // Removed alert for locked dots - tooltip already shows "Coming Soon"
            });
        });

        // WHY Quotes by Element (from Report - Why tab in Excel) WITH hyperlinks
        // Why it Matters quotes from Report - Why tab (up to 5 quotes per element)
        const whyQuotes = {
            'Governance': {
                quotes: [
                    { text: "Ultimately, governance is how you want to run your business. By investing time in it right at the start of founding your company, you will not only gain a far greater understanding of what it is you want to achieve but you will enable others to believe in and grow with your company.", link: "https://startupsmagazine.co.uk/article-why-good-governance-matters-startups" },
                    { text: "As well as getting governance right from the beginning, you need to maintain it for the future to ensure the culture stays healthy and the business continues to operate efficiently. Maintenance is far easier and less time-consuming than trying to implement good governance when the company is bigger so take heart from future-proofing your business as a start-up and supporting it from day one to enable growth and development into a successful company.", link: "https://startupsmagazine.co.uk/article-why-good-governance-matters-startups" },
                    { text: "Startups can have the best foundational bricks in place; however, without proper startup governance, it is only a matter of time before this structure crumbles.", link: "https://www.dilitrust.com/startup-corporate-governance/" },
                    { text: "Investor confidence is higher in a well goverened company and access to capital, essential for a young startup, is much easier. Strong frameworks also help mitigate risks before they escalate into major crises, lead to smarter decisions and significanly more efficient operations", link: "https://lightbox.vc/new-thinking/detail/why-good-governance-is-critical-for-startup-success" },
                    { text: "A unidirectional approach to success by tracking merely the financial metrics is no longer enough; keeping tabs on start-up governance best practices will help companies set themselves up for long-term success.", link: "https://www.ey.com/en_in/insights/start-ups/how-start-ups-can-enhance-governance-for-growth-and-ethical-alignment" }
                ]
            },
            'Purpose': {
                quotes: [
                    { text: "An effective purpose can have a proven, positive impact on bottom-line performance, but few founders make it a priority to consider their business purpose.", link: "https://www.hsbcinnovationbanking.com/gb/en/resources/purpose-top-priority" },
                    { text: "The research supporting the fact that purpose-driven businesses outperform their purpose-lacking competitors is abundant. According to a study by Havas Media Group that examined over 700 brands worldwide, meaningful brands outperform the stock market by an incredible 120%.", link: "https://orspartners.com/on-startups-creating-a-brand-purpose-worth-remembering/" },
                    { text: "People don't buy and continue to buy their products because they're the most fashionable (sorry Patagonia) or the cheapest. They buy their products because they're voting with their money to support companies that share their values. Integrity is a competitive advantage and communicating your purpose clearly lets people know what values you stand for. If you stand for nothing, don't be surprised when something else comes along and wipes you out.", link: "https://startupsmagazine.co.uk/index.php/article-how-having-clear-purpose-can-help-your-startup-thrive" },
                    { text: "Defining your company's reason for existence at the very outset is crucial. When moving quickly, it's essential to take a step back, reflect on your ultimate objective, and ensure that your foundations are solid. Crafting your vision, mission, and values will help you stay focused, orient resources in the most productive way, and inspire and align your team.", link: "https://medium.com/uncorkcapital/mission-vision-and-values-setting-your-startup-up-for-success-f20568df0ae6" }
                ]
            },
            'Strategy': {
                quotes: [
                    { text: "Startups die in two ways: slowly, then suddenly. And in most cases, it's not for lack of hustle, it's for lack of strategy.", link: "https://www.futureventures.ca/insights/master-strategic-planning-for-startups-a-roadmap-to-success" },
                    { text: "Without a clear strategic vision and a well-defined strategic plan, your efforts can quickly turn into chaos, which can be extremely costly.", link: "https://www.forbes.com/councils/forbestechcouncil/2024/09/24/strategy-vs-chaos-why-startups-always-need-a-strategic-plan/" },
                    { text: "Entrepreneurship is often romanticized as a journey of passion, risk-taking, and relentless hustle. While these traits are undoubtedly significant, one critical element often overlooked in this narrative is strategy. A well-thought-out strategy acts as the backbone of a successful entrepreneurial venture, providing direction, focus, and a roadmap to achieve long-term goals.", link: "https://www.linkedin.com/pulse/importance-strategy-entrepreneurship-chinmay-saraf-hmjff/" },
                    { text: "Startups navigate in an environment of uncertainty and unpredictability, making strategy especially important.", link: "https://www.forbes.com/councils/forbestechcouncil/2024/09/24/strategy-vs-chaos-why-startups-always-need-a-strategic-plan/" }
                ]
            },
            'Marketing': {
                quotes: [
                    { text: "Good marketing results do not just magically happen, they need to be planned and created so if you do not have a strategy in place now is the time to do it. The more thought and time put into a marketing strategy, the more you will gain from it, building opportunities and ultimately business.", link: "https://startupsmagazine.co.uk/article-why-having-marketing-strategy-important-all-startups" },
                    { text: "We all know marketing is essential for all businesses, but it's even more important for startups. Unless people know about your startup and what it offers, they probably won't buy your products or services.", link: "https://www.forbes.com/sites/forbesagencycouncil/2018/05/30/five-essential-marketing-strategies-for-any-startup/" },
                    { text: "Twenty-two percent of startups fail because of marketing problems, emphasising the importance of effective marketing initiatives.", link: "https://stripe.com/au/resources/more/marketing-tactics-for-startups" },
                    { text: "When it comes to early-stage startups, marketing is an absolute must. Without effective marketing, your business may struggle to gain traction and find its place in the market.", link: "https://www.growthmentor.com/blog/marketing-in-early-stage-startups/" }
                ]
            }
        };

        // Questionnaire State
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let currentElement = '';
        let currentStage = '';  // Track current stage being assessed
        let answers = {};
        let assessmentProgress = JSON.parse(localStorage.getItem('sovaAssessmentProgress')) || {};

        // Multi-Element Assessment Tracking
        let multiElementProgress = JSON.parse(localStorage.getItem('sovaMultiElementProgress')) || {
            elementsCompleted: [],  // ['Governance', 'Purpose']
            elementsRemaining: ['Governance', 'Purpose', 'Strategy', 'Marketing'],
            allComplete: false,
            results: {}  // Will store per-element results
            // results['Governance'] = {
            //   stagesCompleted: ['Discovery'],
            //   currentStage: 'Validation',
            //   stageFailed: 'Validation',
            //   answers: { 'Discovery': [true, true, true], 'Validation': [true, false] },
            //   score: 67,
            //   questionsAnswered: 6,
            //   questionsYes: 4,
            //   highestStageReached: 'Validation'
            // }
        };

        // Start Assessment - MULTI-ELEMENT VERSION with stage advancement
        function startAssessment(elementName) {
            currentElement = elementName;

            // Initialize element result if doesn't exist
            if (!multiElementProgress.results[elementName]) {
                // Use the stage determined in prelim/validation
                const startingStage = userData.assessmentStartStage || 'Discovery';
                multiElementProgress.results[elementName] = {
                    stagesCompleted: [],
                    currentStage: startingStage,  // Start at stage determined in prelim
                    stageFailed: null,
                    answers: {},
                    score: 0,
                    questionsAnswered: 0,
                    questionsYes: 0,
                    highestStageReached: null
                };
            }

            // Start at current stage (or resume from where they left off)
            const elementResult = multiElementProgress.results[elementName];
            currentStage = elementResult.currentStage || userData.assessmentStartStage || 'Discovery';
            currentQuestionIndex = 0;

            // Initialize answers for this stage if needed
            if (!elementResult.answers[currentStage]) {
                elementResult.answers[currentStage] = [];
            }
            answers = elementResult.answers[currentStage];

            console.log(`Starting ${elementName} at ${currentStage} stage`);

            // Mark as in-progress
            markElementStatus(elementName, 'in-progress');

            // Hide model, report, and sidebars - show questionnaire
            document.getElementById('modelSection').classList.remove('active');
            document.getElementById('reportSection').style.display = 'none';
            document.getElementById('webChartSidebar').style.display = 'none';
            document.getElementById('reportSidebar').style.display = 'none';
            document.getElementById('actionSidebar').style.display = 'none';
            document.getElementById('questionnaireSection').classList.add('active');

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Load questions for this element and current stage
            loadQuestionsForStage();
        }

        // Exit Questionnaire
        function exitQuestionnaire() {
            // Save current progress
            saveMultiElementProgress();

            // Go back to model WITHOUT auto-continuing (user chose to exit)
            document.getElementById('questionnaireSection').classList.remove('active');
            document.getElementById('modelSection').classList.add('active');

            // Show report section and sidebars with current progress
            document.getElementById('reportSection').style.display = 'block';
            document.getElementById('webChartSidebar').style.display = 'block';
            document.getElementById('reportSidebar').style.display = 'block';
            document.getElementById('actionSidebar').style.display = 'block';
            updateReportLive(); // Update report with latest answers
            updateWebChart(); // Update web chart with progress

            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Show message confirming save
            setTimeout(() => {
                alert('Progress saved. You can continue anytime by clicking on any element.');
            }, 500);
        }

        // Save Progress
        function saveProgress() {
            assessmentProgress[currentElement] = {
                status: 'in-progress',
                currentQuestion: currentQuestionIndex,
                answers: answers,
                totalQuestions: currentQuestions.length,
                lastSaved: new Date().toISOString()
            };

            localStorage.setItem('sovaAssessmentProgress', JSON.stringify(assessmentProgress));
        }

        // Mark Element Status
        function markElementStatus(elementName, status) {
            const dotId = elementName.toLowerCase() + '-dot';
            const dot = document.getElementById(dotId);

            if (dot) {
                dot.classList.remove('in-progress', 'completed');
                if (status === 'in-progress') {
                    dot.classList.add('in-progress');
                } else if (status === 'completed') {
                    dot.classList.add('completed');
                }
            }

            // Update text label opacity to match
            // Find the text element that comes after this dot (next sibling in SVG)
            const allTexts = document.querySelectorAll('text');
            allTexts.forEach(text => {
                if (text.textContent.trim() === elementName.toUpperCase()) {
                    if (status === 'completed') {
                        text.style.opacity = '1';
                        text.style.fill = '#C4FF00';
                        text.style.fontWeight = '900';
                        text.style.fontSize = '18px';
                        text.style.filter = 'drop-shadow(0 0 4px rgba(196, 255, 0, 0.6))';
                    } else if (status === 'in-progress') {
                        text.style.opacity = '0.9';
                        text.style.fill = '#C4FF00';
                        text.style.fontWeight = '800';
                        text.style.fontSize = '17px';
                        text.style.filter = 'drop-shadow(0 0 2px rgba(196, 255, 0, 0.4))';
                    } else {
                        // Not started - bright lime to stand out from locked elements
                        text.style.opacity = '0.7';
                        text.style.fill = '#C4FF00';
                        text.style.fontWeight = '700';
                        text.style.fontSize = '16px';
                        text.style.filter = 'none';
                    }
                }
            });

            // Note: Status is tracked in multiElementProgress, not assessmentProgress
            // No need to save here as it's saved by saveMultiElementProgress()
        }

        // Load completion status on page load
        function loadCompletionStatus() {
            // Load completion status from multiElementProgress
            multiElementProgress.elementsCompleted.forEach(elementName => {
                markElementStatus(elementName, 'completed');
            });

            // Mark any in-progress elements
            Object.keys(multiElementProgress.results).forEach(elementName => {
                if (!multiElementProgress.elementsCompleted.includes(elementName)) {
                    markElementStatus(elementName, 'in-progress');
                }
            });
        }

        // Load Questions based on element
        function loadQuestions() {
            const isSolo = userData.teamSize === 'Solo';
            const stage = userData.assessmentStartStage;

            console.log('loadQuestions called:', { currentElement, stage, isSolo });

            // Questions by Element and Stage with References (from Self Assessment Structure.xlsx)
            // Loaded from external file: questions-data.js
            const allQuestions = allQuestionsData;

            console.log('allQuestionsData available:', typeof allQuestionsData, Object.keys(allQuestionsData || {}));

            // Get questions for this element and stage
            let questions = allQuestions[currentElement]?.[stage] || [];

            console.log('Questions loaded:', questions.length, 'for', currentElement, stage);

            // Filter out questions based on user type
            if (isSolo) {
                // For solo users, keep only questions with Solo text (check capitalized Excel field)
                questions = questions.filter(q => {
                    const soloText = q.Solo || q.solo;
                    return soloText !== null && soloText !== undefined && soloText !== '' && soloText !== 'NA';
                });
                console.log('After solo filter:', questions.length);
            } else {
                // For team users, keep only questions with Team text (check capitalized Excel field)
                questions = questions.filter(q => {
                    const teamText = q.Team || q.team;
                    return teamText !== null && teamText !== undefined && teamText !== '' && teamText !== 'NA';
                });
                console.log('After team filter:', questions.length);
            }

            currentQuestions = questions;
            console.log('currentQuestions set to:', currentQuestions.length);
            displayQuestion();
        }

        // Load Questions for Current Stage (MULTI-ELEMENT VERSION)
        function loadQuestionsForStage() {
            const isSolo = userData.teamSize === 'Solo';

            console.log('loadQuestionsForStage:', { currentElement, currentStage, isSolo });

            // Get questions for this element and current stage
            const allQuestions = allQuestionsData;
            let questions = allQuestions[currentElement]?.[currentStage] || [];

            console.log(`Found ${questions.length} questions for ${currentElement} ${currentStage}`);

            // Filter based on Solo vs Team (check both capitalized and lowercase field names)
            // IMPORTANT: Store original index for each question so we can match answers later
            if (isSolo) {
                questions = questions.map((q, originalIndex) => ({...q, _originalIndex: originalIndex}))
                    .filter(q => {
                        const soloText = q.Solo || q.solo;
                        return soloText !== null && soloText !== undefined && soloText !== '' && soloText !== 'NA';
                    });
                console.log('After solo filter:', questions.length);
            } else {
                questions = questions.map((q, originalIndex) => ({...q, _originalIndex: originalIndex}))
                    .filter(q => {
                        const teamText = q.Team || q.team;
                        return teamText !== null && teamText !== undefined && teamText !== '' && teamText !== 'NA';
                    });
                console.log('After team filter:', questions.length);
            }

            currentQuestions = questions;

            if (currentQuestions.length === 0) {
                // No questions for this stage - might be at end
                console.log(`No questions for ${currentElement} at ${currentStage}`);
                checkStageCompletion();
                return;
            }

            // Initialize answers array for this stage if needed
            const elementResult = multiElementProgress.results[currentElement];
            if (!elementResult.answers[currentStage]) {
                elementResult.answers[currentStage] = [];
            }

            answers = elementResult.answers[currentStage];
            currentQuestionIndex = 0;
            displayQuestion();
        }

        // Display Current Question
        function displayQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            const isSolo = userData.teamSize === 'Solo';

            // Update progress
            document.getElementById('questionProgress').textContent =
                `Question ${currentQuestionIndex + 1} of ${currentQuestions.length}`;
            document.getElementById('elementBadge').textContent = currentElement.toUpperCase();

            const progressPercent = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progressPercent + '%';

            // Display question text with proper pronouns for team (check capitalized field names)
            let questionText = isSolo ? (question.Solo || question.solo) : (question.Team || question.team);

            // FIXED: Convert I/my/me/mine to we/our/us/ours for team users
            if (!isSolo && questionText) {
                questionText = questionText
                    .replace(/\bI\/We\b/g, 'We')
                    .replace(/\bI\s/g, 'We ')
                    .replace(/\bI'm\b/g, 'We\'re')
                    .replace(/\bI've\b/g, 'We\'ve')
                    .replace(/\bI'd\b/g, 'We\'d')
                    .replace(/\bI'll\b/g, 'We\'ll')
                    .replace(/\bI,\b/g, 'We,')
                    .replace(/\bmy\b/gi, 'our')
                    .replace(/\bmine\b/gi, 'ours')
                    .replace(/\bme\b/gi, 'us')
                    .replace(/\bmyself\b/gi, 'ourselves')
                    .replace(/\bMy\b/g, 'Our');
            }

            document.getElementById('questionText').textContent = questionText;

            // Display info buttons and content
            // Pass full question object so formatReferences can access quote fields
            displayInfoButtons(question);

            // Load saved answer if exists
            const savedAnswer = answers[currentQuestionIndex];
            updateAnswerButtons(savedAnswer);

            // Update navigation buttons
            document.getElementById('prevBtn').disabled = (currentQuestionIndex === 0);
        }

        // Display Info Buttons
        function displayInfoButtons(references) {
            const buttonsContainer = document.getElementById('infoButtonsRow');
            const contentContainer = document.getElementById('infoContent');

            // Clear previous content
            buttonsContainer.innerHTML = '';
            contentContainer.innerHTML = '';

            if (!references) return;

            const isVC = userData.aimingForVC;

            // Define button configurations (removed tools, advice, book, quotes - quotes for report only)
            // Resource button goes on separate line
            const buttonConfigs = [
                { key: 'keyTerms', label: 'Definitions' },
                { key: 'articles', label: 'Why it matters' },
                { key: 'vcMapping', label: 'VC Perspective', showIf: isVC }
            ];

            const resourceConfig = { key: 'resources', label: 'Resource', isLink: true };

            // Create buttons and content sections for available data
            buttonConfigs.forEach(config => {
                if (config.showIf === false) return;

                // Map config keys to actual Excel column names
                const fieldMap = {
                    'keyTerms': 'Key Terms Defined',
                    'articles': 'Article References',
                    'vcMapping': 'VC requirements mapping',
                    'resources': 'Resources'
                };

                const excelFieldName = fieldMap[config.key];
                const data = references[excelFieldName] || references[config.key];

                // Special handling for Resources
                if (config.isLink) {
                    const linkFieldName = excelFieldName + 'Link';
                    const hasLink = references[linkFieldName] || references[config.key + 'Link'];

                    if (hasLink) {
                        // Create clickable link if URL exists
                        const link = document.createElement('a');
                        link.className = 'info-btn';
                        link.textContent = config.label;
                        link.href = references[linkFieldName] || references[config.key + 'Link'];
                        link.target = '_blank';
                        link.style.textDecoration = 'none';
                        link.style.display = 'inline-block';
                        buttonsContainer.appendChild(link);
                        return;
                    } else if (data) {
                        // Create "Coming Soon" button if data exists but no link
                        const button = document.createElement('button');
                        button.className = 'info-btn';
                        button.textContent = config.label;
                        button.dataset.infoKey = config.key;
                        button.onclick = () => toggleInfo(config.key);
                        buttonsContainer.appendChild(button);

                        // Create Coming Soon content
                        const contentDiv = document.createElement('div');
                        contentDiv.className = 'info-content';
                        contentDiv.id = `info-${config.key}`;
                        contentDiv.innerHTML = `<h4>${config.label}</h4><p>Coming Soon</p>`;
                        contentContainer.appendChild(contentDiv);
                        return;
                    } else {
                        // No data at all, skip this button
                        return;
                    }
                }

                if (!data) return;

                // Create button for toggle content
                const button = document.createElement('button');
                button.className = 'info-btn';
                button.textContent = config.label;
                button.dataset.infoKey = config.key; // Add data attribute for easier lookup
                button.onclick = () => toggleInfo(config.key);
                buttonsContainer.appendChild(button);

                // Create content section
                const contentDiv = document.createElement('div');
                contentDiv.className = 'info-content';
                contentDiv.id = `info-${config.key}`;

                let contentHTML = `<h4>${config.label}</h4>`;

                // Special handling for VC content - rewrite for beginners
                if (config.key === 'vcMapping') {
                    const simplified = simplifyVCContent(data);
                    const vcLink = references['VC requirements mappingLink'] || '';
                    contentHTML += `<p>${simplified}</p>`;
                    if (vcLink) {
                        contentHTML += `<a href="${vcLink}" target="_blank" style="color: #3D2517; font-weight: 600; text-decoration: underline; font-size: 14px; margin-top: 8px; display: inline-block;">View Source</a>`;
                    }
                }
                // References - now shows quotes with "Read source" button
                else if (config.key === 'articles') {
                    contentHTML += formatReferences(references);
                }
                // Regular content (definitions)
                else {
                    contentHTML += `<p>${data}</p>`;
                }

                contentDiv.innerHTML = contentHTML;
                contentContainer.appendChild(contentDiv);
            });

            // Handle Resource button separately - on its own line with lime green border
            const fieldMap = {
                'resources': 'Resources'
            };
            const excelFieldName = fieldMap[resourceConfig.key];
            const linkFieldName = excelFieldName + 'Link';
            const hasLink = references[linkFieldName] || references[resourceConfig.key + 'Link'];

            if (hasLink) {
                // Create line break for Resource button
                buttonsContainer.appendChild(document.createElement('br'));

                // Create clickable link - same as Definition button but with lime green border
                const link = document.createElement('a');
                link.className = 'info-btn';
                link.textContent = resourceConfig.label;
                link.href = references[linkFieldName] || references[resourceConfig.key + 'Link'];
                link.target = '_blank';
                link.style.borderColor = '#C4FF00';
                link.style.marginTop = '8px';
                buttonsContainer.appendChild(link);
            }
        }

        // Simplify and expand VC content for clarity
        function simplifyVCContent(vcText) {
            let simplified = vcText;

            // Expand acronyms and add context
            simplified = simplified.replace(/\bTAM\b/g, 'Total Addressable Market (TAM)');
            simplified = simplified.replace(/\bSAM\b/g, 'Serviceable Available Market (SAM)');
            simplified = simplified.replace(/\bICP\b/g, 'Ideal Customer Profile (ICP)');
            simplified = simplified.replace(/\bABN\b/g, 'Australian Business Number (ABN)');
            simplified = simplified.replace(/\bACN\b/g, 'Australian Company Number (ACN)');
            simplified = simplified.replace(/\bIP\b/g, 'Intellectual Property (IP)');

            // Replace shorthand with explanatory phrases
            simplified = simplified.replace(/VC Criteria:\s*/gi, 'If you\'re seeking investment, investors typically evaluate: ');
            simplified = simplified.replace(/VCs check:\s*/gi, 'When reviewing your business, investors will want to see: ');
            simplified = simplified.replace(/VCs assess:\s*/gi, 'Investors will evaluate: ');
            simplified = simplified.replace(/Red flags:\s*/gi, 'Warning signs that concern investors: ');
            simplified = simplified.replace(/Benchmark:\s*/gi, 'What successful funded startups typically have: ');

            // Add context to weights
            simplified = simplified.replace(/\((\d+)% weight\)/gi, (match, percent) => {
                return `(this is ${percent}% of their investment decision)`;
            });

            // Expand equity vesting terms
            simplified = simplified.replace(/4-year.*?cliff/gi, 'founders earn their ownership over 4 years, with nothing earned in the first year');
            simplified = simplified.replace(/vesting/gi, 'earning ownership over time');

            // Make "no X" statements more conversational
            simplified = simplified.replace(/No market sising/gi, 'You haven\'t calculated your market size');
            simplified = simplified.replace(/No written agreement/gi, 'You don\'t have written agreements');
            simplified = simplified.replace(/No legal structure/gi, 'Your business isn\'t formally registered');
            simplified = simplified.replace(/No differentiation/gi, 'You can\'t explain what makes you different');

            // Add explanatory context to technical terms
            if (simplified.includes('Total Addressable Market')) {
                simplified = simplified.replace(/Total Addressable Market \(TAM\) >\$1B/gi,
                    'Total Addressable Market (the maximum possible revenue) should be over $1 billion');
            }

            return simplified;
        }

        // Format references with actual article hyperlinks
        function formatReferences(question) {
            // Displays ONLY the first startup failure quote from Excel column P "Quote (startup failure)"
            let html = '';

            // First startup failure quote only
            if (question['Quote (startup failure)']) {
                html += `
                    <p style="color: #3D2517; font-size: 14px; line-height: 1.7; margin: 0 0 10px 0;">${question['Quote (startup failure)'].replace(/^[""]|[""]$/g, '')}</p>
                    ${question['Quote (startup failure)Link'] ? `<a href="${question['Quote (startup failure)Link']}" target="_blank" style="color: #3D2517; font-size: 14px; font-weight: 600; text-decoration: underline; display: inline-block; margin-top: 8px;">View Source</a>` : ''}
                `;
            }

            // If no quotes, return a friendly message explaining the context
            if (!html) {
                html = '<p style="color: #3D2517; font-size: 12px; opacity: 0.6; font-style: italic;">Research insights for this question are being compiled.</p>';
            }

            return html;
        }

        // Toggle Info Content
        function toggleInfo(key) {
            const contentDiv = document.getElementById(`info-${key}`);
            if (!contentDiv) {
                console.error(`Content div not found for key: ${key}`);
                return;
            }

            const buttons = document.querySelectorAll('.info-btn');
            const button = Array.from(buttons).find(btn => btn.dataset.infoKey === key);

            // Close all other sections
            document.querySelectorAll('.info-content').forEach(div => {
                if (div.id !== `info-${key}`) {
                    div.classList.remove('active');
                }
            });
            buttons.forEach(btn => {
                if (btn !== button && btn.dataset.infoKey) {
                    btn.classList.remove('active');
                }
            });

            // Toggle current section
            const isActive = contentDiv.classList.toggle('active');
            if (button) {
                if (isActive) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            }
        }

        // Select Answer and auto-advance (MULTI-ELEMENT VERSION)
        function selectAnswer(answer) {
            console.log(' selectAnswer called with:', answer);
            console.log('Current question index:', currentQuestionIndex);
            console.log('Total questions:', currentQuestions.length);

            answers[currentQuestionIndex] = answer;
            updateAnswerButtons(answer);

            // Save to multi-element progress
            multiElementProgress.results[currentElement].answers[currentStage][currentQuestionIndex] = answer;
            saveMultiElementProgress();

            // Update web chart and report LIVE after every answer
            updateWebChart();
            updateReportLive();

            // Auto-advance after a brief delay (500ms) to let user see their selection
            console.log(' Setting timeout to advance...');
            setTimeout(() => {
                console.log(' Timeout fired!');
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    // Move to next question
                    console.log(' Moving to next question');
                    currentQuestionIndex++;
                    displayQuestion();

                    // Smooth scroll to question text after advancing (slight delay for DOM update)
                    setTimeout(() => {
                        const questionText = document.getElementById('questionText');
                        if (questionText) {
                            questionText.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 100);
                } else {
                    // Completed all questions in this stage - check for advancement
                    console.log(' Stage complete, checking advancement');
                    checkStageCompletion();
                }
            }, 500);
        }

        // Update Answer Button Styles
        function updateAnswerButtons(answer) {
            const yesBtn = document.getElementById('answerYes');
            const noBtn = document.getElementById('answerNo');

            // Only highlight if answer is explicitly true or false (not undefined/null)
            if (answer === true) {
                yesBtn.classList.add('selected');
                noBtn.classList.remove('selected');
            } else if (answer === false) {
                yesBtn.classList.remove('selected');
                noBtn.classList.add('selected');
            } else {
                // No answer yet - remove both selections
                yesBtn.classList.remove('selected');
                noBtn.classList.remove('selected');
            }
        }

        // Previous Question
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        // Complete Assessment
        function completeAssessment() {
            // Calculate score
            const yesCount = Object.values(answers).filter(a => a === true).length;
            const totalQuestions = currentQuestions.length;
            const scorePercent = Math.round((yesCount / totalQuestions) * 100);

            // Store results
            const assessmentResults = {
                element: currentElement,
                stage: userData.assessmentStartStage,
                answers: answers,
                score: scorePercent,
                yesCount: yesCount,
                totalQuestions: totalQuestions,
                completedAt: new Date().toISOString()
            };

            // Get existing results or create new array
            let allResults = JSON.parse(localStorage.getItem('sovaAllResults') || '[]');

            // Remove previous result for this element if exists
            allResults = allResults.filter(r => r.element !== currentElement);

            // Add new result
            allResults.push(assessmentResults);

            // Save all results
            localStorage.setItem('sovaAllResults', JSON.stringify(allResults));

            // Mark as completed
            markElementStatus(currentElement, 'completed');

            // Show results page
            showResults(assessmentResults);

            // Pulse the next element (for when they return to model)
            pulseNextElement();
        }

        // ========== MULTI-ELEMENT FLOW FUNCTIONS ==========

        // Check Stage Completion - Advance or Stop
        function checkStageCompletion() {
            const elementResult = multiElementProgress.results[currentElement];
            const stageAnswers = elementResult.answers[currentStage];

            // Check if ALL answers are YES (true)
            const allYes = stageAnswers.every(answer => answer === true);

            // Check if ALL answers are NO (false)
            const allNo = stageAnswers.every(answer => answer === false);

            console.log(`Stage ${currentStage} complete. All YES? ${allYes}, All NO? ${allNo}`);
            console.log('Answers:', stageAnswers);

            if (allYes && currentStage !== 'Scale') {
                // ALL YES - check if next higher stage was already tested at 0%
                const nextStage = getNextStage(currentStage);

                if (nextStage) {
                    // Check if next stage was already tested and got 0% (all NO)
                    const nextStageAnswers = elementResult.answers[nextStage];
                    const nextWas0 = nextStageAnswers && nextStageAnswers.every(a => a === false);

                    if (nextWas0) {
                        // Next stage already tested at 0% - complete at 0% for that higher stage
                        console.log(`All YES at ${currentStage}, but ${nextStage} was already tested at 0% - completing at 0% ${nextStage}`);
                        elementResult.score = 0; // Score is 0% because highest stage attempted (nextStage) failed
                        elementResult.highestStageReached = nextStage; // Highest stage attempted (even though failed)
                        saveMultiElementProgress();
                        elementComplete();
                    } else {
                        // Next stage not tested or not 0% - suggest testing it
                        showStageSuggestion('higher', currentStage, nextStage);
                    }
                } else {
                    // No more stages - element fully complete at 100%
                    console.log(`${currentElement} complete at 100%!`);
                    elementResult.score = 100;
                    elementResult.highestStageReached = currentStage; // Reached this stage
                    saveMultiElementProgress();
                    elementComplete();
                }
            } else if (allYes && currentStage === 'Scale') {
                // ALL YES at Scale - 100% complete
                console.log(`${currentElement} complete at 100%!`);
                elementResult.score = 100;
                elementResult.highestStageReached = currentStage; // Reached Scale
                saveMultiElementProgress();
                elementComplete();
            } else if (allNo && currentStage !== 'Discovery') {
                // ALL NO - check if previous lower stage was already tested at 100%
                const lowerStage = getPreviousStage(currentStage);

                if (lowerStage) {
                    // Check if lower stage was already tested and got 100% (all YES)
                    const lowerStageAnswers = elementResult.answers[lowerStage];
                    const lowerWas100 = lowerStageAnswers && lowerStageAnswers.every(a => a === true);

                    if (lowerWas100) {
                        // Lower stage already tested at 100% - complete at 0% for current stage (highest attempted)
                        console.log(`All NO at ${currentStage}, but ${lowerStage} was already tested at 100% - completing at 0% ${currentStage}`);
                        elementResult.score = 0; // Score is 0% because highest stage attempted (currentStage) failed
                        elementResult.highestStageReached = currentStage; // Highest stage attempted (even though failed)
                        saveMultiElementProgress();
                        elementComplete();
                    } else {
                        // Lower stage not tested or not 100% - suggest testing it
                        showStageSuggestion('lower', currentStage, lowerStage);
                    }
                } else {
                    // No lower stage - complete at 0%
                    console.log(`All NO at Discovery - completing at 0%`);
                    elementResult.score = 0;
                    elementResult.highestStageReached = 'Discovery';
                    saveMultiElementProgress();
                    elementComplete();
                }
            } else if (allNo && currentStage === 'Discovery') {
                // ALL NO at Discovery - complete at 0%
                console.log(`All NO at Discovery - completing at 0%`);
                elementResult.score = 0;
                elementResult.highestStageReached = 'Discovery'; // Failed at Discovery
                saveMultiElementProgress();
                elementComplete();
            } else {
                // MIXED answers - calculate percentage score and complete element
                const isSolo = userData.teamSize === 'Solo';
                const totalQuestions = currentQuestions.filter(q => {
                    // Exclude NA questions for Solo users
                    if (isSolo && (q.Solo === 'NA' || q.solo === 'NA')) return false;
                    return true;
                }).length;
                const yesCount = stageAnswers.filter(a => a === true).length;
                const scorePercent = totalQuestions > 0 ? Math.round((yesCount / totalQuestions) * 100) : 0;

                console.log(`Mixed answers - ${yesCount} YES out of ${totalQuestions} questions = ${scorePercent}%`);
                elementResult.score = scorePercent;
                elementResult.highestStageReached = currentStage; // Reached this stage with mixed results
                saveMultiElementProgress();
                elementComplete();
            }
        }

        // Get Next Stage
        function getNextStage(currentStageName) {
            const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
            const currentIndex = stages.indexOf(currentStageName);

            if (currentIndex < stages.length - 1) {
                return stages[currentIndex + 1];
            }
            return null;  // No next stage
        }

        // Get Previous Stage
        function getPreviousStage(currentStageName) {
            const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
            const currentIndex = stages.indexOf(currentStageName);

            if (currentIndex > 0) {
                return stages[currentIndex - 1];
            }
            return null;  // No previous stage
        }

        // Show Stage Suggestion Modal
        function showStageSuggestion(direction, currentStageName, suggestedStage) {
            const elementResult = multiElementProgress.results[currentElement];
            const elementName = currentElement; // Capture current element in closure
            const stageAtTimeOfSuggestion = currentStageName; // Capture stage in closure

            // Generic message for both directions
            const message = `Based on your results, we recommend testing the ${suggestedStage} stage.`;
            const reasoning = `This will give you a more accurate assessment of your maturity.`;

            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;

            // Create modal content
            const modalContent = document.createElement('div');
            modalContent.style.cssText = 'background: #f5f1e8; padding: 40px; border-radius: 12px; max-width: 500px; text-align: center;';

            const heading = document.createElement('h2');
            heading.style.cssText = 'color: #3D2517; margin-bottom: 16px;';
            heading.textContent = message;

            const para = document.createElement('p');
            para.style.cssText = 'color: #3D2517; font-size: 16px; line-height: 1.6; margin-bottom: 24px;';
            para.textContent = reasoning;

            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = 'display: flex; gap: 12px; justify-content: center;';

            const declineBtn = document.createElement('button');
            declineBtn.className = 'btn-secondary';
            declineBtn.textContent = 'No, Continue';
            declineBtn.style.cursor = 'pointer';

            const acceptBtn = document.createElement('button');
            acceptBtn.className = 'btn-primary';
            acceptBtn.textContent = `Yes, Test ${suggestedStage}`;
            acceptBtn.style.cursor = 'pointer';

            // Attach event listeners before appending
            declineBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log(' Decline button clicked');
                declineStageSuggestion(elementName, stageAtTimeOfSuggestion, overlay);
            });

            acceptBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log(' Accept button clicked');
                acceptStageSuggestion(elementName, direction, suggestedStage, overlay);
            });

            buttonContainer.appendChild(declineBtn);
            buttonContainer.appendChild(acceptBtn);

            modalContent.appendChild(heading);
            modalContent.appendChild(para);
            modalContent.appendChild(buttonContainer);

            overlay.appendChild(modalContent);
            document.body.appendChild(overlay);
        }

        // Accept Stage Suggestion
        function acceptStageSuggestion(elementName, direction, suggestedStage, overlayElement) {
            const elementResult = multiElementProgress.results[elementName];

            // RULE 3: If accepted, launch suggested stage for current element
            // and drop other elements down one stage
            console.log(` Accepted ${direction} stage suggestion: ${suggestedStage} for ${elementName}`);

            // Update current element to new stage
            currentElement = elementName; // Set global back to this element
            currentStage = suggestedStage;
            elementResult.currentStage = suggestedStage;

            if (direction === 'higher') {
                console.log(` Going UP - setting highestStageReached to ${suggestedStage}`);
                elementResult.highestStageReached = suggestedStage;
            } else {
                // Lower stage - reset highest reached
                console.log(` Going DOWN - resetting highestStageReached to ${suggestedStage}`);
                elementResult.highestStageReached = suggestedStage;
                // Clear answers for stages above the new suggested stage
                const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
                const suggestedIndex = stages.indexOf(suggestedStage);
                const stagesToClear = stages.slice(suggestedIndex + 1);
                console.log(` Clearing answers for stages:`, stagesToClear);
                stagesToClear.forEach(stage => {
                    delete elementResult.answers[stage];
                });
            }

            // Drop other remaining elements down one stage
            multiElementProgress.elementsRemaining.forEach(otherElementName => {
                if (otherElementName !== elementName) {
                    const otherResult = multiElementProgress.results[otherElementName];
                    // Only drop if element has been initialized and has a currentStage
                    if (otherResult && otherResult.currentStage) {
                        const lowerStage = getPreviousStage(otherResult.currentStage);
                        if (lowerStage) {
                            console.log(` Dropping ${otherElementName} from ${otherResult.currentStage} to ${lowerStage}`);
                            otherResult.currentStage = lowerStage;
                        }
                    } else {
                        console.log(` Skipping ${otherElementName} - not yet initialized or no currentStage`);
                    }
                }
            });

            saveMultiElementProgress();

            // Remove overlay
            overlayElement.remove();

            // Load questions for new stage
            loadQuestionsForStage();
        }

        // Decline Stage Suggestion
        function declineStageSuggestion(elementName, stageName, overlayElement) {
            const elementResult = multiElementProgress.results[elementName];

            console.log(` Declined stage suggestion - completing ${elementName} at ${stageName}`);

            // Set globals back to this element/stage
            currentElement = elementName;
            currentStage = stageName;

            // Check the last stage's answers to determine if ALL YES or ALL NO
            const stageAnswers = elementResult.answers[stageName] || [];
            const allYes = stageAnswers.every(a => a === true);
            const allNo = stageAnswers.every(a => a === false);

            // Score based on whether they got ALL YES or ALL NO
            if (allYes) {
                // ALL YES but declined to test higher = 100%
                elementResult.score = 100;
                console.log(` Declined after ALL YES - score = 100%`);
            } else if (allNo) {
                // ALL NO but declined to test lower = 0%
                elementResult.score = 0;
                console.log(` Declined after ALL NO - score = 0%`);
            }

            elementResult.highestStageReached = currentStage; // Set to stage where they declined

            // Count total questions answered for tracking
            let totalQuestions = 0;
            let totalYes = 0;
            Object.keys(elementResult.answers).forEach(stage => {
                const stageAnswers = elementResult.answers[stage];
                totalQuestions += stageAnswers.length;
                totalYes += stageAnswers.filter(a => a === true).length;
            });
            elementResult.questionsAnswered = totalQuestions;
            elementResult.questionsYes = totalYes;

            saveMultiElementProgress();

            // Remove overlay
            overlayElement.remove();

            // Complete the element and move to next
            elementComplete();
        }

        // Show Stage Transition Message
        function showStageTransition(nextStage) {
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;

            overlay.innerHTML = `
                <div style="background: #f5f1e8; padding: 40px; border-radius: 12px; max-width: 500px; text-align: center;">
                    <h2 style="color: #3D2517; margin-bottom: 16px;">Excellent Progress!</h2>
                    <p style="color: #3D2517; font-size: 18px; margin-bottom: 24px;">
                        You've completed ${currentStage} foundations.
                        Let's check your ${nextStage} level...
                    </p>
                    <button class="btn-primary" onclick="this.parentElement.parentElement.remove(); loadQuestionsForStage();">
                        Continue to ${nextStage}
                    </button>
                </div>
            `;

            document.body.appendChild(overlay);
        }

        // Element Complete - Mark element as done and move to next
        function elementComplete() {
            const elementResult = multiElementProgress.results[currentElement];

            // Score should already be set by checkStageCompletion or declineStageSuggestion
            console.log(` Element ${currentElement} complete with score: ${elementResult.score}%`);

            // Mark as completed
            markElementStatus(currentElement, 'completed');

            // Add to completed list if not already there
            if (!multiElementProgress.elementsCompleted.includes(currentElement)) {
                multiElementProgress.elementsCompleted.push(currentElement);
            }

            // Remove from remaining list
            multiElementProgress.elementsRemaining = multiElementProgress.elementsRemaining.filter(e => e !== currentElement);

            // Check if all 4 elements complete
            if (multiElementProgress.elementsCompleted.length === 4) {
                multiElementProgress.allComplete = true;
            }

            saveMultiElementProgress();

            // Show completion message
            showElementCompletionMessage();
        }

        // Show Element Completion Message
        function showElementCompletionMessage() {
            const elementResult = multiElementProgress.results[currentElement];
            const elementsRemaining = multiElementProgress.elementsRemaining.length;

            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;

            let message = '';
            if (multiElementProgress.allComplete) {
                message = `
                    <h2 style="color: #3D2517; margin-bottom: 16px;">Assessment Complete!</h2>
                    <p style="color: #3D2517; font-size: 18px; margin-bottom: 24px;">
                        You've completed all 4 elements.
                        Your ${currentElement} score: <strong>${elementResult.score}%</strong>
                    </p>
                    <button class="btn-primary" onclick="this.parentElement.parentElement.remove(); showCombinedReport();">
                        View Your Complete Report
                    </button>
                `;
            } else {
                message = `
                    <h2 style="color: #3D2517; margin-bottom: 16px;">${currentElement} Complete!</h2>
                    <p style="color: #3D2517; font-size: 18px; margin-bottom: 16px;">
                        Your ${currentElement} score: <strong>${elementResult.score}%</strong>
                    </p>
                    <p style="color: #3D2517; margin-bottom: 24px;">
                        ${elementsRemaining} element${elementsRemaining !== 1 ? 's' : ''} remaining:
                        ${multiElementProgress.elementsRemaining.join(', ')}
                    </p>
                    <button class="btn-primary" onclick="this.parentElement.parentElement.remove(); returnToPictorial();">
                        Back to Assessment
                    </button>
                `;
            }

            overlay.innerHTML = `
                <div style="background: #f5f1e8; padding: 40px; border-radius: 12px; max-width: 500px; text-align: center;">
                    ${message}
                </div>
            `;

            document.body.appendChild(overlay);
        }

        // Start Element Assessment - handles both new and re-assessment
        function startElementAssessment(elementName) {
            console.log(` Starting assessment for ${elementName}`);

            // Check if element result exists (re-assessment) or new assessment
            const elementResult = multiElementProgress.results[elementName];
            const isReassessment = elementResult && elementResult.questionsAnswered > 0;

            if (isReassessment) {
                console.log(` Re-assessing ${elementName} - previous score: ${elementResult.score}%`);
                // Reassessment - load from saved stage
                currentElement = elementName;
                currentStage = elementResult.currentStage;

                // Show questionnaire
                document.getElementById('modelSection').classList.remove('active');
                document.getElementById('questionnaireSection').classList.add('active');

                // Load questions for current stage
                loadQuestionsForStage();
            } else {
                console.log(` New assessment for ${elementName}`);
                // New assessment - use standard startAssessment
                startAssessment(elementName);
            }
        }

        // Return to Pictorial and auto-continue to next element
        function returnToPictorial() {
            document.getElementById('questionnaireSection').classList.remove('active');
            document.getElementById('modelSection').classList.add('active');
            document.getElementById('reportSection').style.display = 'block';  // Show report again
            document.getElementById('webChartSidebar').style.display = 'block';  // Show web chart sidebar
            document.getElementById('reportSidebar').style.display = 'block';  // Show report sidebar
            document.getElementById('actionSidebar').style.display = 'block';  // Show actions sidebar
            updateWebChart(); // Update with new element data
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // After a brief moment showing the completed element, auto-start next
            setTimeout(() => {
                startDemoAnimation();
            }, 1000); // Show pictorial for 1 second before continuing
        }

        // Save Multi-Element Progress
        function saveMultiElementProgress() {
            localStorage.setItem('sovaMultiElementProgress', JSON.stringify(multiElementProgress));
        }

        // Toggle Quote Expand/Collapse - SIMPLE VERSION
        function toggleQuote(quoteId, buttonElement) {
            const elem = document.getElementById(quoteId);
            if (!elem) return;

            const full = elem.getAttribute('data-full-text');
            const short = elem.getAttribute('data-short-text');

            if (buttonElement.textContent.trim() === 'Read more') {
                elem.textContent = full;
                buttonElement.textContent = 'Show less';
            } else {
                elem.textContent = short + '...';
                buttonElement.textContent = 'Read more';
            }
        }

        // Update Report Live - Called after every answer
        function updateReportLive() {
            console.log(' updateReportLive() called');
            console.trace(' updateReportLive() called from:');

            // Calculate current overall progress across all elements
            const elementsStarted = Object.keys(multiElementProgress.results).length;
            const elementsCompleted = multiElementProgress.elementsCompleted.length;
            const isSolo = userData.teamSize === 'Solo';

            console.log(' Elements started:', elementsStarted, 'Elements completed:', elementsCompleted);

            // Count total answers and gaps across all elements
            let totalQuestions = 0;
            let totalAnswered = 0;
            let totalYes = 0;
            let totalNo = 0;
            let allGaps = [];
            let allStrengths = [];

            Object.keys(multiElementProgress.results).forEach(elementName => {
                const result = multiElementProgress.results[elementName];

                Object.keys(result.answers).forEach(stageName => {
                    const stageAnswers = result.answers[stageName];
                    totalQuestions += stageAnswers.length;

                    stageAnswers.forEach((answer, filteredIndex) => {
                        if (answer !== null && answer !== undefined) {
                            totalAnswered++;
                            // IMPORTANT: Get the original question using stored _originalIndex
                            const filteredQuestion = allQuestionsData[elementName][stageName].filter((q, idx) => {
                                const soloText = q.Solo || q.solo;
                                const teamText = q.Team || q.team;
                                const isApplicable = isSolo
                                    ? (soloText && soloText !== 'NA' && soloText.trim() !== '')
                                    : (teamText && teamText !== 'NA' && teamText.trim() !== '');
                                return isApplicable;
                            })[filteredIndex];
                            const question = filteredQuestion;

                            if (answer === true) {
                                totalYes++;
                                // Collect strengths (YES answers) - but only if question applies to user type
                                if (question) {
                                    // Check if question is applicable to solo/team
                                    const soloText = question.Solo || question.solo;
                                    const teamText = question.Team || question.team;
                                    const isApplicable = isSolo
                                        ? (soloText && soloText !== 'NA' && soloText.trim() !== '')
                                        : (teamText && teamText !== 'NA' && teamText.trim() !== '');

                                    if (isApplicable) {
                                        allStrengths.push({
                                            element: elementName,
                                            stage: stageName,
                                            question: question
                                        });
                                    }
                                }
                            } else {
                                totalNo++;
                                // Collect gaps (NO answers) - but only if question applies to user type
                                if (question) {
                                    // Check if question is applicable to solo/team
                                    const soloText = question.Solo || question.solo;
                                    const teamText = question.Team || question.team;
                                    const isApplicable = isSolo
                                        ? (soloText && soloText !== 'NA' && soloText.trim() !== '')
                                        : (teamText && teamText !== 'NA' && teamText.trim() !== '');

                                    if (isApplicable) {
                                        allGaps.push({
                                            element: elementName,
                                            stage: stageName,
                                            questionIndex: filteredIndex,
                                            question: question,
                                            elementScore: result.score || 0
                                        });
                                    }
                                }
                            }
                        }
                    });
                });
            });

            // Sort gaps by priority: element score (ascending), then stage order, then question index
            const stageOrder = { 'Discovery': 0, 'Validation': 1, 'Efficiency': 2, 'Scale': 3 };
            allGaps.sort((a, b) => {
                if (a.elementScore !== b.elementScore) return a.elementScore - b.elementScore;
                if (stageOrder[a.stage] !== stageOrder[b.stage]) return stageOrder[a.stage] - stageOrder[b.stage];
                return a.questionIndex - b.questionIndex;
            });

            // ======================
            // 1. OVERALL PROGRESS
            // ======================
            const overallProgress = document.getElementById('overallProgress');
            if (overallProgress && totalAnswered > 0) {
                const avgScore = Math.round((totalYes / totalAnswered) * 100);

                overallProgress.innerHTML = `
                    <div style="display: flex; justify-content: space-around; text-align: center;">
                        <div>
                            <div style="font-size: 32px; font-weight: 700; color: #3D2517;">${elementsStarted}/4</div>
                            <div style="font-size: 14px; color: #3D2517; opacity: 0.7;">Elements Started</div>
                        </div>
                        <div>
                            <div style="font-size: 32px; font-weight: 700; color: #3D2517;">${totalAnswered}</div>
                            <div style="font-size: 14px; color: #3D2517; opacity: 0.7;">Questions Answered</div>
                        </div>
                        <div>
                            <div style="font-size: 32px; font-weight: 700; color: #C4FF00;">${avgScore}%</div>
                            <div style="font-size: 14px; color: #3D2517; opacity: 0.7;">Current Score</div>
                        </div>
                        <div>
                            <div style="font-size: 32px; font-weight: 700; color: ${totalNo > 0 ? '#E8C547' : '#3D2517'};">${totalNo}</div>
                            <div style="font-size: 14px; color: #3D2517; opacity: 0.7;">Gaps Identified</div>
                        </div>
                    </div>
                `;
            } else if (overallProgress) {
                overallProgress.innerHTML = '<p class="progress-text">Complete the assessment to see your results</p>';
            }

            // ======================
            // 2. TOP 3 PRIORITIES
            // ======================
            const priorityContent = document.getElementById('priorityContent');
            if (priorityContent && allGaps.length > 0) {
                let priorityHTML = '';
                const top3Gaps = allGaps.slice(0, 3);

                top3Gaps.forEach((gap, index) => {
                    const priorityNum = index + 1;
                    const questionText = isSolo ? (gap.question.Solo || gap.question.Team) : gap.question.Team;
                    const tool1 = gap.question['Tool/Framework 1'] || '';
                    const tool2 = gap.question['Tool/Framework 2'] || '';
                    const whyQuote = whyQuotes[gap.element] || 'Addressing this gap is critical for sustainable growth.';

                    priorityHTML += `
                        <div style="background: #f5f1e8; border: 2px solid #C4FF00; border-radius: 8px; padding: 24px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; margin-bottom: 12px;">
                                <div style="background: #C4FF00; color: #3D2517; font-weight: 700; font-size: 20px; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 16px;">${priorityNum}</div>
                                <h4 style="color: #3D2517; font-size: 18px; font-weight: 700; margin: 0;">${gap.element} - ${gap.stage}</h4>
                            </div>
                            <p style="color: #3D2517; font-size: 15px; line-height: 1.6; margin: 0 0 16px 0;"><strong>Gap:</strong> ${questionText}</p>
                            ${tool1 ? `<p style="margin: 8px 0; color: #3D2517;"><strong>Tool:</strong> ${tool1}</p>` : ''}
                            ${tool2 ? `<p style="margin: 8px 0; color: #3D2517;"><strong>Also consider:</strong> ${tool2}</p>` : ''}
                            <blockquote style="margin: 16px 0 0 0; padding: 12px 16px; background: #f5f1e8; border-left: 3px solid #E8C547; font-style: italic; color: #3D2517; line-height: 1.6; font-size: 14px;">
                                <strong>Why this matters:</strong> ${whyQuote}
                            </blockquote>
                        </div>
                    `;
                });

                priorityContent.innerHTML = priorityHTML;
            } else if (priorityContent && totalAnswered > 0) {
                priorityContent.innerHTML = '<p style="color: #3D2517; font-size: 16px;">Excellent! No gaps identified yet. Your top priorities will appear here if any gaps are found.</p>';
            } else if (priorityContent) {
                priorityContent.innerHTML = '<p class="placeholder-text">Your top 3 priorities will appear here...</p>';
            }

            // ======================
            // 3. CURRENT STATUS (Hero section)
            // ======================
            const statusContent = document.getElementById('statusContent');
            if (elementsStarted > 0) {
                // Show web chart reference and gaps count
                let statusHTML = '<p style="color: #f5f1e8; font-size: clamp(16px, 1.8vw, 20px); line-height: 1.6; margin: 0 0 12px 0; opacity: 0.8;">See web chart above for your results</p>';
                statusHTML += '<p style="color: #f5f1e8; font-size: clamp(18px, 2vw, 24px); line-height: 1.6; margin: 0;">We\'ve identified <strong style="color: #C4FF00;">' + totalNo + ' gaps</strong> to address.</p>';
                statusContent.innerHTML = statusHTML;
            } else {
                statusContent.innerHTML = '<p style="color: #f5f1e8; font-size: clamp(18px, 2vw, 24px);">Complete the assessment to see your results</p>';
            }

            // ======================
            // 4. OVERALL SCORE VISUAL - Removed, point to web chart instead
            // ======================
            const overallScoreVisual = document.getElementById('overallScoreVisual');
            if (overallScoreVisual) {
                overallScoreVisual.innerHTML = '';
            }

            // ======================
            // 5. ELEMENT GRID (4 columns - clickable to filter gaps)
            // ======================
            const elementGrid = document.getElementById('elementGrid');
            if (elementGrid && elementsStarted > 0) {
                let gridHTML = '';

                // Show all 4 elements in fixed order
                const allElements = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
                allElements.forEach(elementName => {
                    const result = multiElementProgress.results[elementName];

                    if (result) {
                        const score = result.score || 0;
                        const highestStage = result.highestStageReached || 'Discovery';
                        const isComplete = multiElementProgress.elementsCompleted.includes(elementName);

                        // Count gaps for this element
                        const elementGapsCount = allGaps.filter(g => g.element === elementName).length;

                        gridHTML += `
                            <div onclick="filterGapsByElement('${elementName}')" style="background: #f5f1e8; border-radius: 10px; padding: 14px; box-shadow: 0 2px 8px rgba(61, 37, 23, 0.06); cursor: pointer; transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); border: 2px solid transparent;" onmouseover="this.style.transform='translateY(-6px)'; this.style.boxShadow='0 8px 16px rgba(61, 37, 23, 0.12)'; this.style.borderColor='#C4FF00';" onmouseout="this.style.transform=''; this.style.boxShadow='0 2px 8px rgba(61, 37, 23, 0.06)'; this.style.borderColor='transparent';">
                                <h3 style="color: #3D2517; font-size: clamp(16px, 2vw, 20px); font-weight: 700; margin: 0 0 10px 0;">${elementName}</h3>

                                <!-- Large score -->
                                <div style="font-size: clamp(32px, 5vw, 44px); font-weight: 900; color: #C5D952; line-height: 1; margin-bottom: 8px;">${score}%</div>

                                <!-- Stage badge -->
                                <div style="background: #C4FF00; color: #3D2517; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px; display: inline-block; margin-bottom: 10px;">${highestStage}</div>

                                <!-- Gaps count -->
                                ${elementGapsCount > 0 ? `
                                    <div style="color: #3D2517; font-size: 11px; font-weight: 600; opacity: 0.7;">
                                        ${elementGapsCount} gap${elementGapsCount !== 1 ? 's' : ''} to address
                                    </div>
                                ` : `
                                    <div style="color: #3D2517; font-size: 11px; font-weight: 600; opacity: 0.7;">
                                        No gaps identified
                                    </div>
                                `}

                                <!-- Click hint -->
                                <div style="margin-top: 10px; padding-top: 10px; border-top: 2px solid #f5f1e8; color: #3D2517; opacity: 0.5; font-size: 9px; text-transform: uppercase; letter-spacing: 0.8px;">
                                    Click to view gaps
                                </div>
                            </div>
                        `;
                    } else {
                        // Not yet assessed
                        gridHTML += `
                            <div style="background: #f5f1e8; border-radius: 16px; padding: 28px; opacity: 0.5;">
                                <h3 style="color: #3D2517; font-size: clamp(20px, 2vw, 28px); font-weight: 700; margin: 0 0 20px 0;">${elementName}</h3>
                                <p style="color: #3D2517; font-size: 14px; margin: 0;">Not yet assessed</p>
                            </div>
                        `;
                    }
                });

                elementGrid.innerHTML = gridHTML;
            } else if (elementGrid) {
                elementGrid.innerHTML = '<p style="color: #3D2517; text-align: center; opacity: 0.5;">Element cards will appear here after you start the assessment</p>';
            }

            // ======================
            // 6. GAPS BY ELEMENT (Per spec: Element heading + definition + quotes, then each gap with WHY/HOW/Resources)
            // ======================
            const gapsContent = document.getElementById('gapsContent');
            if (allGaps.length > 0) {
                let gapsHTML = '';

                // Add filter UI at top of gaps section
                if (Object.keys(multiElementProgress.results).length > 1) {
                    gapsHTML += `
                        <div style="max-width: 1200px; margin: 0 auto 40px auto;">
                            <div style="background: #f5f1e8; border-radius: 12px; padding: 24px;">
                                <div style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
                                    <span style="color: #3D2517; font-weight: 600; font-size: 14px;">Filter by Element:</span>
                                    <button onclick="filterGapsByElement(null)" style="background: ${currentFilterElement === null ? '#3D2517' : '#f5f1e8'}; color: ${currentFilterElement === null ? '#C4FF00' : '#3D2517'}; border: 2px solid ${currentFilterElement === null ? '#3D2517' : '#f5f1e8'}; padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;">All</button>
                                    ${Object.keys(multiElementProgress.results).map(el => `
                                        <button onclick="filterGapsByElement('${el}')" style="background: ${currentFilterElement === el ? '#3D2517' : '#f5f1e8'}; color: ${currentFilterElement === el ? '#C4FF00' : '#3D2517'}; border: 2px solid ${currentFilterElement === el ? '#3D2517' : '#f5f1e8'}; padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s;">${el}</button>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                }

                // Group gaps by element
                const gapsByElement = {};
                allGaps.forEach(gap => {
                    if (!gapsByElement[gap.element]) {
                        gapsByElement[gap.element] = [];
                    }
                    gapsByElement[gap.element].push(gap);
                });

                // Get element definitions WITH hyperlinks (from Report - Why tab in Excel)
                const elementDefinitions = {
                    'Governance': {
                        text: 'As the business bible, governance encompasses all the vital details of the company  how you want to run your business, how decisions will be made, what the processes are, how risks will be managed, and how staff will be protected from any possible legal action. It sets the standard for everyone in the company and explains what everyone\'s role is, how they should work and what the business wants to achieve.',
                        link: 'https://startupsmagazine.co.uk/article-why-good-governance-matters-startups'
                    },
                    'Purpose': {
                        text: 'From the moment it\'s formed, every business has a purpose  a "reason for being". By default, it\'s defined by the founders\' motivations for setting up shop in the first place.',
                        link: 'https://www.hsbcinnovationbanking.com/gb/en/resources/purpose-top-priority'
                    },
                    'Strategy': {
                        text: 'Strategy refers to a comprehensive plan that outlines how a business will achieve its objectives. It involves identifying key opportunities, understanding market dynamics, and creating a sustainable competitive advantage.',
                        link: 'https://www.linkedin.com/pulse/importance-strategy-entrepreneurship-chinmay-saraf-hmjff/'
                    },
                    'Marketing': {
                        text: 'Marketing connects your solution to people who need it. Great products with poor marketing fail. Average products with great marketing thrive.',
                        link: 'https://www.entrepreneur.com/starting-a-business/why-marketing-is-important-for-your-business/299334'
                    }
                };

                // FIXED: Display elements in FIXED order: Governance  Purpose  Strategy  Marketing
                const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];

                // Wrap in container for max-width
                gapsHTML += '<div style="max-width: 1200px; margin: 0 auto;">';

                elementOrder.forEach(elementName => {
                    // Skip if no gaps for this element
                    if (!gapsByElement[elementName]) return;

                    // Apply filter if set
                    if (currentFilterElement !== null && currentFilterElement !== elementName) return;

                    const elementGaps = gapsByElement[elementName];
                    const definition = elementDefinitions[elementName];
                    const elementQuote = whyQuotes[elementName];

                    gapsHTML += `
                        <div style="margin-bottom: 80px; position: relative; z-index: 100;">
                            <!-- Element header - Extreme scale with brand colors -->
                            <div style="background: #3D2517; padding: 32px 40px; border-radius: 12px; margin-bottom: 24px; position: relative; z-index: 100;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <h3 style="color: #C4FF00; font-size: clamp(28px, 3vw, 42px); font-weight: 700; margin: 0; letter-spacing: -1.5px;">${elementName}</h3>
                                    <div style="display: flex; gap: 12px; position: relative; z-index: 1000000;">
                                        ${definition ? `
                                            <div class="tooltip-trigger lime">
                                                Definition
                                                <div class="tooltip-popover">
                                                    <div class="tooltip-corner lime"></div>
                                                    <div class="tooltip-popover-label">${elementName} Definition</div>
                                                    <div class="tooltip-popover-content">${definition.text}</div>
                                                    ${definition.link ? `<a href="${definition.link}" target="_blank" class="tooltip-popover-link">Read source</a>` : ''}
                                                </div>
                                            </div>
                                        ` : ''}
                                        ${elementQuote ? `
                                            <div class="tooltip-trigger lime">
                                                Why it matters
                                                <div class="tooltip-popover" style="max-width: 500px; width: 500px;">
                                                    <div class="tooltip-corner lime"></div>
                                                    <div class="tooltip-popover-label">Why ${elementName} Matters</div>
                                                    <div class="tooltip-popover-content">
                                                        <!-- Compact list of all quotes -->
                                                        <div style="display: flex; flex-direction: column; gap: 10px;">
                                                            ${elementQuote.quotes.map((quote, quoteIdx) => `
                                                                <div style="display: flex; align-items: flex-start; gap: 8px;">
                                                                    <span style="flex-shrink: 0; width: 20px; height: 20px; border-radius: 50%; background: #C4FF00; font-size: 10px; font-weight: 700; color: #3D2517; display: flex; align-items: center; justify-content: center;">${quoteIdx + 1}</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="why_quote_${elementName}_${quoteIdx}" data-full-text="${quote.text.replace(/"/g, '&quot;')}" data-short-text="${quote.text.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #3D2517; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quote.text.substring(0, 120)}${quote.text.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quote.text.length > 120 ? `<button onclick="toggleQuote('why_quote_${elementName}_${quoteIdx}', this)" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">Read more</button>` : ''}
                                                                            ${quote.link ? `<a href="${quote.link}" target="_blank" style="color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer;">View source </a>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            `).join('')}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        ` : ''}
                                        <div class="tooltip-trigger lime">
                                            Experts in your area
                                            <div class="tooltip-popover">
                                                <div class="tooltip-corner lime"></div>
                                                <div class="tooltip-popover-label">Coming Soon</div>
                                                <div class="tooltip-popover-content">Expert directory launching soon. Connect with verified ${elementName.toLowerCase()} specialists in your area.</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Gaps for this element -->
                            ${elementGaps.map((gap, idx) => {
                                // Get question text, falling back to Team if Solo is NA
                                let questionText = isSolo ? (gap.question.Solo || gap.question.solo) : (gap.question.Team || gap.question.team);
                                if (questionText === 'NA' || !questionText) {
                                    questionText = gap.question.Team || gap.question.team || '';
                                }

                                // FIXED: Convert I/my/me/mine to we/our/us/ours for team users
                                if (!isSolo && questionText) {
                                    questionText = questionText
                                        .replace(/\bI\/We\b/g, 'We')
                                        .replace(/\bI\s/g, 'We ')
                                        .replace(/\bI'm\b/g, 'We\'re')
                                        .replace(/\bI've\b/g, 'We\'ve')
                                        .replace(/\bI'd\b/g, 'We\'d')
                                        .replace(/\bI'll\b/g, 'We\'ll')
                                        .replace(/\bI,\b/g, 'We,')
                                        .replace(/\bmy\b/gi, 'our')
                                        .replace(/\bmine\b/gi, 'ours')
                                        .replace(/\bme\b/gi, 'us')
                                        .replace(/\bmyself\b/gi, 'ourselves')
                                        .replace(/\bMy\b/g, 'Our');
                                }

                                // FIXED: Use correct field names from questions-data.js WITH hyperlinks (check Excel column names with spaces)
                                const advice = gap.question.Advice || gap.question.advice || 'Start by documenting your current approach, then identify 2-3 quick wins you can implement this week.';

                                // Collect ALL quotes (up to 2 failure + 2 best practice)
                                const quoteFailure = gap.question['Quote (startup failure)'] || gap.question.quoteFailure || '';
                                const quoteFailureLink = gap.question['Quote (startup failure)Link'] || gap.question.quoteFailureLink || '';
                                const quoteFailure2 = gap.question['Quote (startup failure) 2'] || '';
                                const quoteFailure2Link = gap.question['Quote (startup failure) 2Link'] || '';
                                const quoteBestPractice = gap.question['Quote (best practice)'] || gap.question.quoteBestPractice || '';
                                const quoteBestPracticeLink = gap.question['Quote (best practice)Link'] || gap.question.quoteBestPracticeLink || '';
                                const quoteBestPractice2 = gap.question['Quote (best practice) 2'] || '';
                                const quoteBestPractice2Link = gap.question['Quote (best practice) 2Link'] || '';

                                // VC Requirements for Evidence Base
                                const vcRequirements = gap.question['VC requirements mapping'] || '';
                                const vcRequirementsLink = gap.question['VC requirements mappingLink'] || '';

                                // Collect ALL 4 tools WITH their hyperlinks
                                const tools = [];
                                const tool1 = gap.question['Tool/Framework 1'];
                                const tool1Link = gap.question['Tool/Framework 1Link'];
                                if (tool1 && tool1 !== 'None' && tool1.trim() !== '') {
                                    tools.push({ name: tool1, link: tool1Link || '' });
                                }
                                const tool2 = gap.question['Tool/Framework 2'];
                                const tool2Link = gap.question['Tool/Framework 2Link'];
                                if (tool2 && tool2 !== 'None' && tool2.trim() !== '') {
                                    tools.push({ name: tool2, link: tool2Link || '' });
                                }
                                const tool3 = gap.question['Tool/Framework 3'];
                                const tool3Link = gap.question['Tool/Framework 3Link'];
                                if (tool3 && tool3 !== 'None' && tool3.trim() !== '') {
                                    tools.push({ name: tool3, link: tool3Link || '' });
                                }
                                const tool4 = gap.question['Tool/Framework 4'];
                                const tool4Link = gap.question['Tool/Framework 4Link'];
                                if (tool4 && tool4 !== 'None' && tool4.trim() !== '') {
                                    tools.push({ name: tool4, link: tool4Link || '' });
                                }

                                const bookRec = gap.question.Book || '';

                                return `
                                    <div style="position: relative; margin-bottom: 32px; z-index: 1;">
                                        <!-- Stacked shadow effect -->
                                        <div style="position: absolute; top: 6px; left: 6px; right: -6px; bottom: -6px; background: linear-gradient(135deg, rgba(196, 255, 0, 0.12) 0%, rgba(196, 255, 0, 0.06) 100%); border-radius: 20px; z-index: 1;"></div>

                                        <div style="position: relative; background: #f5f1e8; border-radius: 20px; overflow: hidden; z-index: 2; box-shadow: 0 2px 20px rgba(61, 37, 23, 0.08);">

                                            <!-- Header: Stage badge + Question -->
                                            <div style="background: linear-gradient(135deg, #3D2517 0%, #5a4228 100%); padding: 28px 36px;">
                                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                                    <div style="display: inline-block; background: #C4FF00; color: #3D2517; font-size: 11px; font-weight: 800; padding: 6px 16px; border-radius: 20px; text-transform: uppercase; letter-spacing: 1.2px;">Stage - ${gap.stage}</div>
                                                </div>
                                                <h4 style="color: #C4FF00; font-size: clamp(18px, 2.2vw, 24px); font-weight: 700; margin: 0; line-height: 1.3; letter-spacing: -0.5px;">${questionText}</h4>
                                            </div>

                                            <!-- Full Width Layout: Advice, Research References, then Tools -->
                                            <div style="padding: 36px;">
                                                <!-- Advice section with subtle label -->
                                                <div style="margin-bottom: 28px;">
                                                    <div style="color: #3D2517; opacity: 0.5; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 12px;">How to Address This</div>
                                                    <p style="color: #3D2517; font-size: 14px; line-height: 1.7; margin: 0; font-weight: 400;">${advice}</p>
                                                </div>

                                                <!-- Recommended Tools (between Advice and Research References) -->
                                                ${(tools.length > 0 || bookRec) ? `
                                                    <div style="margin-bottom: 28px;">
                                                        ${tools.length > 0 ? `
                                                            <div style="color: #3D2517; opacity: 0.5; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 16px;">Recommended Tools</div>
                                                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 24px;">
                                                                ${tools.map(tool => {
                                                                if (tool.link) {
                                                                    return `
                                                                        <a href="${tool.link}" target="_blank" style="background: rgba(61, 37, 23, 0.03); color: #3D2517; padding: 16px 20px; border-radius: 12px; font-size: 14px; font-weight: 600; text-decoration: none; display: block; transition: all 0.3s ease; border: 2px solid rgba(61, 37, 23, 0.1);" onmouseover="this.style.background='#3D2517'; this.style.color='#C4FF00'; this.style.borderColor='#3D2517';" onmouseout="this.style.background='rgba(61, 37, 23, 0.03)'; this.style.color='#3D2517'; this.style.borderColor='rgba(61, 37, 23, 0.1)';">
                                                                            ${tool.name}
                                                                        </a>
                                                                    `;
                                                                } else {
                                                                    return `
                                                                        <div style="background: rgba(61, 37, 23, 0.02); color: #3D2517; padding: 16px 20px; border-radius: 12px; font-size: 14px; font-weight: 600; opacity: 0.5; border: 2px dashed rgba(61, 37, 23, 0.2);">
                                                                            ${tool.name}
                                                                        </div>
                                                                    `;
                                                                }
                                                                }).join('')}
                                                            </div>
                                                        ` : ''}

                                                        <!-- Recommended Reading -->
                                                        ${bookRec ? `
                                                            <div style="color: #3D2517; opacity: 0.5; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; margin: 0 0 16px 0;">Recommended Reading</div>
                                                            <div style="background: rgba(61, 37, 23, 0.03); border-radius: 8px; padding: 16px; border-left: 3px solid #3D2517;">
                                                                <p style="color: #3D2517; font-size: 14px; line-height: 1.6; margin: 0; font-weight: 600;">${bookRec}</p>
                                                            </div>
                                                        ` : ''}
                                                    </div>
                                                ` : ''}

                                                    <!-- Evidence Base: Compact reference-style citations -->
                                                    ${(quoteFailure || quoteFailure2 || quoteBestPractice || quoteBestPractice2 || vcRequirements) ? `
                                                        <div style="background: rgba(61, 37, 23, 0.03); border-radius: 8px; padding: 16px; border-left: 3px solid #C4FF00;">
                                                            <div style="color: #3D2517; opacity: 0.5; font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.2px; margin-bottom: 12px;">Research References</div>

                                                            <!-- Compact list of all references -->
                                                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                                                ${quoteFailure ? `<div style="display: flex; align-items: flex-start; gap: 8px;">
                                                                    <span style="flex-shrink: 0; width: 32px; padding: 4px 0; border-radius: 4px; background: #E8C547; font-size: 9px; font-weight: 700; color: #3D2517; text-transform: uppercase; letter-spacing: 0.5px; text-align: left; padding-left: 6px;">Risk</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_failure_${elementName}_${gap.stage}_${idx}" data-full-text="${quoteFailure.replace(/"/g, '&quot;')}" data-short-text="${quoteFailure.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #3D2517; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quoteFailure.substring(0, 120)}${quoteFailure.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quoteFailure.length > 120 ? `<button onclick="toggleQuote('quote_failure_${elementName}_${gap.stage}_${idx}', this)" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">Read more</button>` : ''}
                                                                            ${quoteFailureLink ? `<button onclick="window.open('${quoteFailureLink}', '_blank')" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">View source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                                ${quoteFailure2 ? `<div style="display: flex; align-items: flex-start; gap: 8px;">
                                                                    <span style="flex-shrink: 0; width: 32px; padding: 4px 0; border-radius: 4px; background: #E8C547; font-size: 9px; font-weight: 700; color: #3D2517; text-transform: uppercase; letter-spacing: 0.5px; text-align: left; padding-left: 6px;">Risk</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_failure2_${elementName}_${gap.stage}_${idx}" data-full-text="${quoteFailure2.replace(/"/g, '&quot;')}" data-short-text="${quoteFailure2.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #3D2517; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quoteFailure2.substring(0, 120)}${quoteFailure2.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quoteFailure2.length > 120 ? `<button onclick="toggleQuote('quote_failure2_${elementName}_${gap.stage}_${idx}', this)" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">Read more</button>` : ''}
                                                                            ${quoteFailure2Link ? `<button onclick="window.open('${quoteFailure2Link}', '_blank')" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">View source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                                ${quoteBestPractice ? `<div style="display: flex; align-items: flex-start; gap: 8px;">
                                                                    <span style="flex-shrink: 0; width: 32px; padding: 4px 0; border-radius: 4px; background: #C4FF00; font-size: 9px; font-weight: 700; color: #3D2517; text-transform: uppercase; letter-spacing: 0.5px; text-align: left; padding-left: 6px;">Best</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_best_${elementName}_${gap.stage}_${idx}" data-full-text="${quoteBestPractice.replace(/"/g, '&quot;')}" data-short-text="${quoteBestPractice.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #3D2517; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quoteBestPractice.substring(0, 120)}${quoteBestPractice.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quoteBestPractice.length > 120 ? `<button onclick="toggleQuote('quote_best_${elementName}_${gap.stage}_${idx}', this)" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">Read more</button>` : ''}
                                                                            ${quoteBestPracticeLink ? `<button onclick="window.open('${quoteBestPracticeLink}', '_blank')" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">View source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                                ${quoteBestPractice2 ? `<div style="display: flex; align-items: flex-start; gap: 8px;">
                                                                    <span style="flex-shrink: 0; width: 32px; padding: 4px 0; border-radius: 4px; background: #C4FF00; font-size: 9px; font-weight: 700; color: #3D2517; text-transform: uppercase; letter-spacing: 0.5px; text-align: left; padding-left: 6px;">Best</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_best2_${elementName}_${gap.stage}_${idx}" data-full-text="${quoteBestPractice2.replace(/"/g, '&quot;')}" data-short-text="${quoteBestPractice2.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #3D2517; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quoteBestPractice2.substring(0, 120)}${quoteBestPractice2.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quoteBestPractice2.length > 120 ? `<button onclick="toggleQuote('quote_best2_${elementName}_${gap.stage}_${idx}', this)" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">Read more</button>` : ''}
                                                                            ${quoteBestPractice2Link ? `<button onclick="window.open('${quoteBestPractice2Link}', '_blank')" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">View source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                                ${vcRequirements ? `<div style="display: flex; align-items: flex-start; gap: 8px;">
                                                                    <span style="flex-shrink: 0; width: 32px; padding: 4px 0; border-radius: 4px; background: #C5D952; font-size: 9px; font-weight: 700; color: #3D2517; text-transform: uppercase; letter-spacing: 0.5px; text-align: left; padding-left: 6px;">VC</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_vc_${elementName}_${gap.stage}_${idx}" data-full-text="${vcRequirements.replace(/"/g, '&quot;')}" data-short-text="${vcRequirements.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #3D2517; font-size: 11px; line-height: 1.4; margin: 0;">${vcRequirements.substring(0, 120)}${vcRequirements.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${vcRequirements.length > 120 ? `<button onclick="toggleQuote('quote_vc_${elementName}_${gap.stage}_${idx}', this)" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">Read more</button>` : ''}
                                                                            ${vcRequirementsLink ? `<button onclick="window.open('${vcRequirementsLink}', '_blank')" style="background: none; border: none; color: #3D2517; font-size: 10px; font-weight: 600; text-decoration: underline; cursor: pointer; padding: 0;">View source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                            </div>
                                                        </div>
                                                    ` : ''}
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    `;
                });

                gapsHTML += '</div>'; // Close max-width container

                gapsContent.innerHTML = gapsHTML;
            } else if (totalAnswered > 0) {
                gapsContent.innerHTML = '<p style="color: #3D2517; font-size: 16px;">No gaps identified. You\'re doing great!</p>';
            } else {
                gapsContent.innerHTML = '<p class="placeholder-text">Your gaps analysis will appear here...</p>';
            }

            // ======================
            // 5. STRENGTHS
            // ======================
            const strengthsContent = document.getElementById('strengthsContent');
            if (strengthsContent && allStrengths.length > 0) {
                let strengthsHTML = '';

                // Group strengths by element
                const strengthsByElement = {};
                allStrengths.forEach(strength => {
                    if (!strengthsByElement[strength.element]) {
                        strengthsByElement[strength.element] = [];
                    }
                    strengthsByElement[strength.element].push(strength);
                });

                // Show up to 3 strengths per element
                Object.keys(strengthsByElement).forEach(elementName => {
                    const elementStrengths = strengthsByElement[elementName].slice(0, 3);

                    strengthsHTML += `<h4 style="color: #3D2517; font-size: 16px; font-weight: 700; margin: 20px 0 12px 0;">${elementName}</h4>`;

                    elementStrengths.forEach(strength => {
                        const matureQuote = strength.question.references?.mature || 'You\'re demonstrating best practices in this area.';
                        const questionText = isSolo ? (strength.question.Solo || strength.question.solo) : (strength.question.Team || strength.question.team);

                        strengthsHTML += `
                            <div style="background: #f5f1e8; border-left: 4px solid #C4FF00; padding: 16px; margin-bottom: 12px; border-radius: 4px;">
                                <p style="color: #3D2517; font-size: 14px; font-weight: 600; margin: 0 0 8px 0;">${strength.stage}: ${questionText}</p>
                                <blockquote style="margin: 0; padding: 0; font-style: italic; color: #3D2517; opacity: 0.8; font-size: 13px; line-height: 1.6;">
                                    ${matureQuote}
                                </blockquote>
                            </div>
                        `;
                    });
                });

                strengthsContent.innerHTML = strengthsHTML;
            } else if (strengthsContent && totalAnswered > 0) {
                strengthsContent.innerHTML = '<p style="color: #3D2517; font-size: 16px;">Your strengths will appear here as you answer YES to questions.</p>';
            } else if (strengthsContent) {
                strengthsContent.innerHTML = '<p class="placeholder-text">Your strengths will appear here...</p>';
            }

            // ======================
            // 6. WHY THIS MATTERS
            // ======================
            const whyContent = document.getElementById('whyContent');
            if (whyContent && allGaps.length > 0) {
                let whyHTML = '<p style="font-size: 16px; line-height: 1.7; margin-bottom: 20px;">Based on your answers, here\'s why addressing these gaps is critical for your business:</p>';

                // Group gaps by element to avoid repetition
                const elementsSeen = new Set();
                allGaps.forEach(gap => {
                    if (!elementsSeen.has(gap.element)) {
                        elementsSeen.add(gap.element);
                        const quote = whyQuotes[gap.element] || 'Understanding this area is crucial for sustainable growth.';

                        whyHTML += `
                            <div style="background: #f5f1e8; padding: 16px; border-left: 4px solid #E8C547; margin-bottom: 16px; border-radius: 4px;">
                                <h4 style="color: #3D2517; font-size: 16px; font-weight: 700; margin: 0 0 8px 0;">${gap.element}</h4>
                                <blockquote style="margin: 0; padding: 12px 16px; background: rgba(255, 255, 255, 0.5); border-left: 3px solid #C4FF00; font-style: italic; color: #3D2517; line-height: 1.6;">
                                    ${quote}
                                </blockquote>
                            </div>
                        `;
                    }
                });

                whyContent.innerHTML = whyHTML;
            } else if (whyContent && totalAnswered > 0) {
                whyContent.innerHTML = '<p style="color: #3D2517; font-size: 16px;">Excellent! No gaps identified. Context about critical business elements will appear here if any gaps are found.</p>';
            } else if (whyContent) {
                whyContent.innerHTML = '<p class="placeholder-text">Context about why these gaps are critical will appear here...</p>';
            }

            // ======================
            // 7. TO DO LIST (Per spec: Address gaps, then move to next stage)
            // ======================
            const todoContent = document.getElementById('todoContent');
            if (todoContent && allGaps.length > 0) {
                // SORT gaps by element order (Governance  Purpose  Strategy  Marketing)
                const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
                allGaps.sort((a, b) => {
                    const aIndex = elementOrder.indexOf(a.element);
                    const bIndex = elementOrder.indexOf(b.element);
                    return aIndex - bIndex;
                });

                let todoHTML = `
                    <p style="color: #3D2517; font-size: 15px; line-height: 1.7; margin: 0 0 24px 0;">
                        <strong>Start by addressing these gaps.</strong> Once you've completed them, come back to move to the next stage of your assessment.
                    </p>
                `;

                allGaps.forEach((gap, index) => {
                    const questionText = isSolo ? (gap.question.Solo || gap.question.solo) : (gap.question.Team || gap.question.team);

                    // Transform to conversational action - make it action-oriented, not just restating the question
                    let actionText = questionText
                        .replace(/^I\/We have /i, 'Create ')
                        .replace(/^I have /i, 'Create ')
                        .replace(/^We have /i, 'Create ')
                        .replace(/written /i, 'write ')
                        .replace(/documented /i, 'document ')
                        .replace(/considered \/ completed /i, 'complete ')
                        .replace(/defined /i, 'define ')
                        .replace(/established /i, 'establish ')
                        .replace(/identified /i, 'identify ');

                    // Capitalize first letter
                    actionText = actionText.charAt(0).toUpperCase() + actionText.slice(1);

                    todoHTML += `
                        <div style="background: #f5f1e8; border: 1px solid #E8C547; border-radius: 8px; padding: 16px; margin-bottom: 12px; display: flex; align-items: start; gap: 12px;">
                            <input type="checkbox" style="margin-top: 4px; width: 20px; height: 20px; cursor: pointer;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 6px;">
                                    <span style="background: #C4FF00; color: #3D2517; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 700;">${index + 1}</span>
                                    <span style="color: #3D2517; font-size: 12px; font-weight: 600; opacity: 0.7;">${gap.element} / ${gap.stage}</span>
                                </div>
                                <p style="color: #3D2517; font-size: 15px; line-height: 1.5; margin: 0; font-weight: 600;">${actionText}</p>
                            </div>
                        </div>
                    `;
                });

                // Add final message about coming back
                todoHTML += `
                    <div style="background: linear-gradient(135deg, #C4FF00 0%, #E8C547 100%); border-radius: 8px; padding: 20px; margin-top: 24px; text-align: center;">
                        <p style="color: #3D2517; font-size: 16px; font-weight: 700; margin: 0;">
                            Once you've addressed these gaps, come back to continue your assessment and move to the next stage
                        </p>
                    </div>
                `;

                todoContent.innerHTML = todoHTML;
            } else if (todoContent && totalAnswered > 0) {
                todoContent.innerHTML = `
                    <div style="background: #f5f1e8; border: 2px solid #C4FF00; border-radius: 8px; padding: 24px; text-align: center;">
                        <p style="color: #3D2517; font-size: 16px; font-weight: 600; margin: 0;">
                             Excellent! No gaps identified. You're ready to progress to the next stage.
                        </p>
                    </div>
                `;
            } else if (todoContent) {
                todoContent.innerHTML = '<p class="placeholder-text">Your action checklist will appear here...</p>';
            }
        }

        // Show Combined Report (placeholder - will build full version next)
        function showCombinedReport() {
            console.log(' showCombinedReport() called');

            // Hide questionnaire, show model and report
            document.getElementById('questionnaireSection').classList.remove('active');
            document.getElementById('modelSection').classList.add('active');
            document.getElementById('reportSection').style.display = 'block';  // Ensure report is visible
            document.getElementById('webChartSidebar').style.display = 'block';  // Show web chart sidebar
            document.getElementById('reportSidebar').style.display = 'block';  // Show report sidebar
            document.getElementById('actionSidebar').style.display = 'block';  // Show actions sidebar

            // Update web chart and report one final time
            updateWebChart();
            updateReportLive();

            // Scroll to report section smoothly
            setTimeout(() => {
                const reportSection = document.getElementById('reportSection');
                console.log(' Scrolling to report, display:', reportSection.style.display);
                reportSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 500);
        }

        // ========== END MULTI-ELEMENT FLOW FUNCTIONS ==========

        // Show Results Page
        function showResults(results) {
            // Hide questionnaire, show results
            document.getElementById('questionnaireSection').classList.remove('active');
            document.getElementById('resultsSection').classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Update title and subtitle
            document.getElementById('resultsTitle').textContent = `${results.element} Assessment Complete`;
            document.getElementById('resultsSubtitle').textContent = `${results.stage} Stage  Completed ${new Date(results.completedAt).toLocaleDateString('en-AU')}`;

            // Animate score circle
            animateScore(results.score);

            // Update score details
            const description = getScoreDescription(results.score);
            document.getElementById('scoreHeading').textContent = description.title;
            document.getElementById('scoreDescription').textContent = description.text;

            // Show score breakdown
            const breakdownHTML = `
                <div class="score-item">
                    <span class="score-item-label">${results.element} Readiness</span>
                    <span class="score-item-value">${results.score}%</span>
                </div>
                <div class="score-item">
                    <span class="score-item-label">Questions Answered "Yes"</span>
                    <span class="score-item-value">${results.yesCount} of ${results.totalQuestions}</span>
                </div>
            `;
            document.getElementById('scoreBreakdown').innerHTML = breakdownHTML;

            // Generate stage progression tracker
            generateStageProgressionTracker(results);

            // Generate Golden Circle content (Why, How, What)
            generateGoldenCircleContent(results);
        }

        // Animate Score Circle
        function animateScore(percent) {
            const circle = document.getElementById('scoreCircle');
            const scoreText = document.getElementById('scorePercent');
            const circumference = 2 * Math.PI * 90; // radius is 90
            const offset = circumference - (percent / 100) * circumference;

            // Animate circle
            setTimeout(() => {
                circle.style.strokeDashoffset = offset;
                circle.style.transition = 'stroke-dashoffset 2s ease-out';
            }, 100);

            // Animate number
            let current = 0;
            const increment = percent / 50; // 50 frames
            const timer = setInterval(() => {
                current += increment;
                if (current >= percent) {
                    current = percent;
                    clearInterval(timer);
                }
                scoreText.textContent = Math.round(current) + '%';
            }, 40);
        }


        // Get Score Description - Australian English, concise
        function getScoreDescription(score) {
            if (score >= 80) {
                return {
                    title: 'Excellent',
                    text: 'Strong foundations. Ready for investors.'
                };
            } else if (score >= 60) {
                return {
                    title: 'Good Progress',
                    text: 'Solid foundations with some gaps to address.'
                };
            } else if (score >= 40) {
                return {
                    title: 'Building Foundations',
                    text: 'Key gaps need attention.'
                };
            } else {
                return {
                    title: 'Priority Area',
                    text: 'Requires immediate focus.'
                };
            }
        }

        // Generate Stage Progression Tracker
        function generateStageProgressionTracker(results) {
            const currentStage = results.stage;
            const element = results.element;
            const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
            const currentIndex = stages.indexOf(currentStage);

            let html = '<div class="stage-tracker">';
            html += '<h3>Your Stage Progression</h3>';
            html += '<div class="stage-progress-bar">';

            stages.forEach((stage, index) => {
                const isComplete = index < currentIndex;
                const isCurrent = index === currentIndex;
                const isPending = index > currentIndex;

                let statusClass = '';
                if (isComplete) statusClass = 'complete';
                else if (isCurrent) statusClass = 'current';
                else statusClass = 'pending';

                html += `
                    <div class="stage-item ${statusClass}">
                        <div class="stage-number">${index + 1}</div>
                        <div class="stage-name">${stage}</div>
                    </div>
                `;

                if (index < stages.length - 1) {
                    html += `<div class="stage-connector ${isComplete ? 'complete' : ''}"></div>`;
                }
            });

            html += '</div>';

            // Show what's available
            html += `<p style="margin-top: 16px; color: #C5D952;">You\'ve completed ${element} at the ${currentStage} stage. `;
            if (currentIndex < stages.length - 1) {
                html += `${stages.length - currentIndex - 1} more stage${stages.length - currentIndex - 1 > 1 ? 's' : ''} available: `;
                html += stages.slice(currentIndex + 1).join(', ') + '.';
            } else {
                html += 'This is the highest stage.';
            }
            html += '</p>';

            html += '</div>';

            document.getElementById('stageProgressionTracker').innerHTML = html;
        }

        // Generate Golden Circle Content (WHY  HOW  WHAT)
        function generateGoldenCircleContent(results) {
            const element = results.element;
            const stage = results.stage;
            const noAnswers = [];

            // Get questions answered "No"
            currentQuestions.forEach((q, index) => {
                if (answers[index] === false) {
                    noAnswers.push({ question: q, index: index });
                }
            });

            let html = '';

            if (noAnswers.length === 0) {
                // All Yes answers
                html += '<div class="golden-circle-section">';
                html += `<h2>All Foundations Complete</h2>`;
                html += `<p>You answered "Yes" to all questions at the ${stage} stage.</p>`;

                if (stage !== 'Scale') {
                    const nextStage = stage === 'Discovery' ? 'Validation' : stage === 'Validation' ? 'Efficiency' : 'Scale';
                    html += `<p style="margin-top: 16px;"><strong>Next step:</strong> Test the ${nextStage} stage for ${element}, or assess the next element.</p>`;
                    html += `<button class="btn-secondary" style="margin-top: 16px;" onclick="suggestHigherStage('${element}', '${nextStage}')">Start ${nextStage} Assessment</button>`;
                } else {
                    html += `<p style="margin-top: 16px;">You've mastered ${element}. Focus on other elements or maintain these practices.</p>`;
                }
                html += '</div>';
            } else {
                // WHY Section - Use quotes from Excel
                html += '<div class="golden-circle-section why-section">';
                html += `<h2>Why ${element} Matters</h2>`;

                // Collect all quotes from "No" answers
                const failureQuotes = [];
                const bestPracticeQuotes = [];
                noAnswers.forEach(item => {
                    if (item.question.quoteFailure) failureQuotes.push(item.question.quoteFailure);
                    if (item.question.quoteFailure2) failureQuotes.push(item.question.quoteFailure2);
                    if (item.question.quoteBestPractice) bestPracticeQuotes.push(item.question.quoteBestPractice);
                    if (item.question.quoteBestPractice2) bestPracticeQuotes.push(item.question.quoteBestPractice2);
                });

                // Show failure quote if available
                if (failureQuotes.length > 0) {
                    html += `<p><strong>Why startups fail:</strong> "${failureQuotes[0]}"</p>`;
                }

                // Show best practice quote if available
                if (bestPracticeQuotes.length > 0) {
                    html += `<p style="margin-top: 12px;"><strong>What success looks like:</strong> "${bestPracticeQuotes[0]}"</p>`;
                }

                // Always show element context
                html += `<p style="margin-top: 12px;">${getElementContext(element)}</p>`;
                html += '</div>';

                // HOW Section
                html += '<div class="golden-circle-section how-section">';
                html += `<h2>How to Fix Your Gaps</h2>`;
                html += `<p>You have ${noAnswers.length} gap${noAnswers.length > 1 ? 's' : ''} to address. Start with #1.</p>`;

                noAnswers.forEach((item, idx) => {
                    const q = item.question;
                    const isSolo = userData.teamSize === 'Solo';
                    const questionText = isSolo ? (q.Solo || q.solo) : (q.Team || q.team);
                    const advice = q.advice || 'Implement this practice to strengthen your foundations.';

                    // Collect tools
                    const tools = [];
                    if (q.tool1) tools.push(q.tool1);
                    if (q.tool2) tools.push(q.tool2);
                    if (q.tool3) tools.push(q.tool3);
                    if (q.tool4) tools.push(q.tool4);

                    const priority = idx === 0 ? 'Start Here' : idx === 1 ? 'Then This' : 'Next';

                    html += `
                        <div class="gap-card">
                            <div class="gap-header">
                                <h3>${idx + 1}. ${questionText}</h3>
                                <span class="gap-priority">${priority}</span>
                            </div>
                            <p><strong>Why:</strong> ${advice}</p>
                            ${tools.length > 0 ? `
                                <p style="margin-top: 12px;"><strong>How:</strong></p>
                                <ul style="margin-left: 20px;">
                                    ${tools.map(tool => `<li>${tool}</li>`).join('')}
                                </ul>
                            ` : ''}
                            ${q.book ? `<p style="margin-top: 12px;"><strong>Learn:</strong> ${q.book}</p>` : ''}
                        </div>
                    `;
                });

                html += '</div>';

                // WHAT Section (Stage progression guidance)
                html += '<div class="golden-circle-section what-section">';
                html += `<h2>What's Next</h2>`;
                html += generateStageGuidance(results, noAnswers.length);
                html += '</div>';

                // MATURITY Section - Show what best practice looks like
                if (typeof matureQuotes !== 'undefined' && matureQuotes[element]) {
                    html += '<div class="golden-circle-section" style="border-left: 4px solid #B89968;">';
                    html += `<h2>What Best Practice Looks Like</h2>`;
                    html += `<p style="font-style: italic; color: #E8C547;">When you've mastered ${element}, here's what you'll see:</p>`;

                    // Show mature quotes for this element
                    matureQuotes[element].forEach((quote, idx) => {
                        if (idx < 3) { // Limit to 3 quotes
                            html += `<p style="margin-top: 12px;">"${quote}"</p>`;
                        }
                    });

                    html += '</div>';
                }
            }

            document.getElementById('goldenCircleContent').innerHTML = html;
        }

        // Get Element Quote
        function getElementQuote(element) {
            const quotes = {
                'Governance': '73% of startup conflicts stem from unclear ownership and roles.',
                'Purpose': 'Companies with clear purpose have 46% higher employee retention.',
                'Strategy': '90% of startups fail due to market mistiming, not bad products.',
                'Marketing': 'Customer acquisition costs 5x more than retention.',
                'Finance': '82% of businesses fail due to cash flow problems, not lack of profit.',
                'Performance': 'What gets measured gets managed.',
                'People': 'A-players hire A-players, B-players hire C-players.',
                'Process': 'Systems run the business, people run the systems.',
                'Technology': 'Technology is the enabler, not the solution.'
            };
            return quotes[element] || 'Strong foundations prevent expensive mistakes later.';
        }

        // Get Element Context - Australian English
        function getElementContext(element) {
            const context = {
                'Governance': 'Solid governance prevents costly disputes, protects IP, and shows investors you\'re serious. Even solo founders need proper legal structure, decision frameworks, and compliance.',
                'Purpose': 'Clear purpose attracts the right customers, employees, and investors. It\'s your filter for every decisionwhat to build, who to hire, which opportunities to pursue.',
                'Strategy': 'Strategy is your roadmap from where you are to where you want to be. Without it, you\'re guessing. With it, you can test assumptions, measure progress, and pivot with confidence.',
                'Marketing': 'Marketing connects your solution to people who need it. Great products with poor marketing fail. Average products with great marketing thrive.',
                'Finance': 'Cash flow management is survival. Profit is nice, but running out of cash kills 82% of startups. Know your numbers, forecast ruthlessly.',
                'Performance': 'You can\'t improve what you don\'t measure. Performance metrics show what\'s working, what\'s broken, and where to focus your limited time and money.',
                'People': 'Your team is your competitive advantage. Hire too early and you burn cash. Hire too late and you burn out. Get culture and structure right from day one.',
                'Process': 'Processes free you from chaos. They enable delegation, prevent mistakes, and scale your impact. Document once, repeat forever.',
                'Technology': 'Technology should solve problems, not create them. Use existing tools unless custom code is genuinely necessary.'
            };
            return context[element] || 'This element is crucial for your business success.';
        }

        // Generate Stage Guidance (Rules logic) - Australian English
        function generateStageGuidance(results, noCount) {
            const stage = results.stage;
            const element = results.element;
            let html = '';

            if (noCount === 0) {
                // All Yes
                if (stage === 'Scale') {
                    html += `<p>You've mastered ${element} at Scale stage. Maintain these practices.</p>`;
                } else {
                    const nextStage = stage === 'Discovery' ? 'Validation' : stage === 'Validation' ? 'Efficiency' : 'Scale';
                    html += `<p>Ready to test the ${nextStage} stage.</p>`;
                }
            } else if (noCount < 2) {
                // 1 gap
                html += `<p>One gap to fix. Complete it, then reassess or move to the next element.</p>`;
            } else {
                // 2+ gaps
                html += `<p>${noCount} gaps identified. Focus here first. Don't progress to the next stage until you've addressed these fundamentals. Reassess in 2-4 weeks.</p>`;
            }

            return html;
        }

        // Back to Model
        function backToModel() {
            document.getElementById('resultsSection').classList.remove('active');
            document.getElementById('modelSection').classList.add('active');
            updateWebChart(); // Update the web chart visualization
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Update Web Chart with Scores
        function updateWebChart() {
            console.log(' updateWebChart() called');
            // Use multi-element progress data
            const results = multiElementProgress.results;
            console.log(' Results:', results);

            if (Object.keys(results).length === 0) {
                console.log(' No results to plot');
                document.getElementById('webChart').style.display = 'none';
                return;
            }

            // Element positions on the circle (NEW: dots at r=510) - ONLY 4 ACTIVE ELEMENTS FOR MVP
            // Center is at (650, 650), evenly spaced at 40 intervals starting from 0 (top)
            const elementPositions = {
                'Governance': { cx: 650, cy: 140 },       // 0 (12 o'clock) at r=510
                'Purpose': { cx: 978, cy: 259 },         // 40 at r=510
                'Strategy': { cx: 1152, cy: 561 },       // 80 at r=510
                'Marketing': { cx: 824, cy: 1129 }       // 160 at r=510
            };

            // Calculate points for web chart
            const centerX = 650;
            const centerY = 650;
            const points = [];
            const wedgesContainer = document.getElementById('webChartWedges');
            wedgesContainer.innerHTML = ''; // Clear previous wedges

            // For MVP, only plot the 4 active elements in clockwise order
            const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];

            // Stage radii (NEW: ring boundaries for scoring visualization)
            // Each stage has its own 100px band, 0-100% scores plot within that band
            const stageRadii = {
                'Discovery': { inner: 50, outer: 150 },      // First ring (100px band)
                'Validation': { inner: 150, outer: 250 },    // Second ring (100px band)
                'Efficiency': { inner: 250, outer: 350 },    // Third ring (100px band)
                'Scale': { inner: 350, outer: 450 }          // Fourth ring (100px band)
            };

            elementOrder.forEach(element => {
                const elementResult = results[element];
                const pos = elementPositions[element];

                console.log(` Checking ${element}:`, elementResult ? `score=${elementResult.score}, stage=${elementResult.highestStageReached}, answered=${elementResult.questionsAnswered}` : 'not assessed');

                // FIXED: Only plot elements that are in elementsCompleted array (user finished assessment for that element)
                const isCompleted = multiElementProgress.elementsCompleted.includes(element);

                if (pos && elementResult && isCompleted && elementResult.score !== undefined) {
                    console.log(` Plotting ${element} - completed, score=${elementResult.score}%, stage=${elementResult.highestStageReached}`);
                    // Element completed - plot based on ACTUAL stage reached, not hardcoded Discovery
                    const stage = elementResult.highestStageReached || 'Discovery';
                    const radii = stageRadii[stage] || { inner: 0, outer: 85 };

                    // Calculate position WITHIN the stage ring
                    // Score 0% = inner edge of stage ring
                    // Score 100% = outer edge of stage ring
                    const stageRadius = radii.inner + (radii.outer - radii.inner) * (elementResult.score / 100);

                    // Calculate full distance from center to dot
                    const fullDistance = Math.sqrt(Math.pow(pos.cx - centerX, 2) + Math.pow(pos.cy - centerY, 2));

                    // Calculate ratio to position within stage
                    const stageRatio = stageRadius / fullDistance;

                    const x = centerX + (pos.cx - centerX) * stageRatio;
                    const y = centerY + (pos.cy - centerY) * stageRatio;
                    points.push(`${x},${y}`);

                    // Add circle dot at endpoint for visibility
                    const dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    dot.setAttribute('cx', x);
                    dot.setAttribute('cy', y);
                    dot.setAttribute('r', '6');
                    dot.setAttribute('fill', '#C4FF00');
                    wedgesContainer.appendChild(dot);
                    console.log(` Circle dot added at (${x},${y})`);
                } else {
                    console.log(` Skipping ${element} - not completed yet. isCompleted=${isCompleted}`);
                }
            });

            // Update polygon points - create filled wedge from center through each result
            const webChart = document.getElementById('webChart');
            console.log(' Plotting points:', points);

            if (points.length >= 2) {
                // Create filled wedge polygon from center -> results -> back to center
                // Start from center, go to each point, back to center
                const wedgePoints = [`${centerX},${centerY}`, ...points, `${centerX},${centerY}`];
                webChart.setAttribute('points', wedgePoints.join(' '));
                webChart.style.display = 'block';
                console.log(' Web chart wedge shown with', points.length, 'result points');
                console.log(' Wedge points:', wedgePoints.join(' '));
            } else {
                webChart.style.display = 'none';
                console.log(' Not enough points to draw web chart yet (need at least 2)');
            }
        }

        // Download Report (Placeholder)
        function downloadReport() {
            alert('PDF download functionality coming soon! For now, you can print this page (Ctrl+P) or take screenshots.');
        }

        // Email Report (Placeholder)
        function emailReport() {
            const email = prompt('Enter your email address to receive this report:');
            if (!email) {
                return; // User cancelled
            }
            if (!email.includes('@')) {
                alert('Please enter a valid email address');
                return;
            }
            alert(`Report will be emailed to ${email}\n\n(Email functionality coming soon!)`);
        }

        // Pulse Next Element
        function pulseNextElement() {
            // Order of active elements: Governance -> Purpose -> Strategy -> Marketing
            const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
            const currentIndex = elementOrder.indexOf(currentElement);

            // Stop any existing animations first
            elementOrder.forEach(element => {
                const dotId = element.toLowerCase() + '-dot';
                const dot = document.getElementById(dotId);
                if (dot) {
                    dot.style.animation = 'none';
                }
            });

            if (currentIndex >= 0 && currentIndex < elementOrder.length - 1) {
                const nextElement = elementOrder[currentIndex + 1];
                const nextDotId = nextElement.toLowerCase() + '-dot';
                const nextDot = document.getElementById(nextDotId);

                if (nextDot) {
                    // Wait a moment then pulse
                    setTimeout(() => {
                        // Force reflow to restart animation
                        nextDot.style.animation = 'none';
                        void nextDot.offsetWidth; // Trigger reflow
                        // Slower pulse (2s), more iterations (5x) for better visibility
                        nextDot.style.animation = 'glow 2s ease-in-out 5';
                    }, 500);
                }
            }
        }

        // Suggest Higher Stage - Launch assessment at next stage level
        function suggestHigherStage(element, stage) {
            // Update user data with new stage
            userData.assessmentStartStage = stage;

            // Go back to model and start assessment for this element at higher stage
            backToModel();

            // Short delay then start assessment
            setTimeout(() => {
                startElementAssessment(element);
            }, 500);
        }

        // Initialize on page load - restore report visibility if progress exists
        function initializeAssessment() {
            // Check if user has started assessment (has multi-element progress)
            if (multiElementProgress && Object.keys(multiElementProgress.results).length > 0) {
                console.log(' Existing progress found, restoring report...');

                // Show report section with existing data
                const reportSection = document.getElementById('reportSection');
                if (reportSection) {
                    reportSection.style.display = 'block';

                    // Update report with existing data
                    updateReportLive();

                    // Update web chart with existing scores
                    updateWebChart();
                }
            }
        }

        // Run initialization when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeAssessment);
        } else {
            // DOM already loaded
            initializeAssessment();
        }

        // Mobile-specific fixes - hide sidebar buttons and fix layout
        function applyMobileFixes() {
            const isMobile = window.innerWidth <= 768;

            console.log(' Mobile Fix Running - Window Width:', window.innerWidth, 'isMobile:', isMobile);

            // Handle sidebar buttons visibility
            const sidebarButtons = ['webChartSidebar', 'reportSidebar', 'actionSidebar'];
            sidebarButtons.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    if (isMobile) {
                        el.style.display = 'none';
                        el.style.visibility = 'hidden';
                        console.log(' Hidden sidebar:', id);
                    } else {
                        el.style.display = 'block';
                        el.style.visibility = 'visible';
                        console.log(' Showing sidebar:', id);
                    }
                }
            });

            if (isMobile) {
                console.log(' Applying mobile fixes...');

                // Fix report section width
                const reportSection = document.getElementById('reportSection');
                if (reportSection) {
                    reportSection.style.paddingLeft = '8px';
                    reportSection.style.paddingRight = '8px';
                    reportSection.style.maxWidth = '100%';
                    reportSection.style.overflowX = 'hidden';
                }

                // Fix all report-section elements
                const reportSections = document.querySelectorAll('.report-section');
                reportSections.forEach(section => {
                    section.style.padding = '20px 12px';
                    section.style.marginLeft = '0';
                    section.style.marginRight = '0';
                    section.style.maxWidth = '100%';
                });

                // Fix container
                const container = document.querySelector('.container');
                if (container) {
                    container.style.maxWidth = '100%';
                    container.style.margin = '0';
                    container.style.padding = '8px 0';
                    container.style.overflowX = 'hidden';
                    console.log(' Container fixed');
                }

                // Fix preliminary section
                const prelimSection = document.querySelector('.prelim-section');
                if (prelimSection) {
                    prelimSection.style.maxWidth = '100%';
                    prelimSection.style.margin = '0 0 24px 0';
                    prelimSection.style.borderRadius = '0';
                    prelimSection.style.padding = '40px 16px';
                    console.log(' Prelim section fixed');
                }

                // Fix question container
                const questionContainer = document.querySelector('.question-container');
                if (questionContainer) {
                    questionContainer.style.maxWidth = '100%';
                    questionContainer.style.margin = '0';
                    questionContainer.style.borderRadius = '0';
                    questionContainer.style.padding = '24px 16px';
                    console.log(' Question container fixed');
                }

                // Fix score cards (Element Breakdown)
                const scoreCards = document.querySelectorAll('.score-card');
                scoreCards.forEach(card => {
                    card.style.flexDirection = 'column';
                    card.style.width = '100%';
                    card.style.padding = '16px';
                });
                if (scoreCards.length > 0) console.log(' Score cards fixed:', scoreCards.length);

                // Fix gap cards
                const gapCards = document.querySelectorAll('.gap-card');
                gapCards.forEach(card => {
                    card.style.padding = '16px 12px';
                    card.style.margin = '0 0 16px 0';
                    card.style.maxWidth = '100%';
                });
                if (gapCards.length > 0) console.log(' Gap cards fixed:', gapCards.length);

                // Fix two-column layouts to stack
                const twoColumns = document.querySelectorAll('.two-column, .gap-details');
                twoColumns.forEach(col => {
                    col.style.flexDirection = 'column';
                    col.style.gap = '16px';
                });

                // Fix individual columns
                const columns = document.querySelectorAll('.column, .gap-column');
                columns.forEach(col => {
                    col.style.width = '100%';
                    col.style.maxWidth = '100%';
                    col.style.padding = '0';
                });
                if (columns.length > 0) console.log(' Columns stacked:', columns.length);

                // Fix brown header boxes
                const brownHeaders = document.querySelectorAll('[style*="background: #3D2517"], [style*="background:#3D2517"]');
                brownHeaders.forEach(header => {
                    header.style.margin = '0';
                    header.style.borderRadius = '12px';
                    header.style.padding = '16px 12px';
                });

                // Fix assessment tooltip buttons
                const infoButtonsRow = document.querySelector('.info-buttons-row');
                if (infoButtonsRow) {
                    infoButtonsRow.style.justifyContent = 'flex-start';
                    infoButtonsRow.style.flexWrap = 'wrap';
                    infoButtonsRow.style.gap = '8px';
                    infoButtonsRow.style.margin = '0 0 16px 0';
                    console.log(' Assessment tooltip buttons fixed');
                }

                const infoButtons = document.querySelectorAll('.info-btn');
                infoButtons.forEach(btn => {
                    btn.style.fontSize = '11px';
                    btn.style.padding = '6px 10px';
                });

                // Fix Element Breakdown grid - 2 columns on mobile
                const elementGrid = document.getElementById('elementGrid');
                if (elementGrid) {
                    elementGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
                    elementGrid.style.gap = '12px';
                    elementGrid.style.padding = '0';
                    console.log(' Element grid fixed - 2 columns');
                }

                // Fix element cards
                const elementCards = document.querySelectorAll('.element-card, .score-item');
                elementCards.forEach(card => {
                    card.style.width = '100%';
                    card.style.maxWidth = '100%';
                    card.style.margin = '0';
                    card.style.padding = '16px 12px';
                });
                if (elementCards.length > 0) console.log(' Element cards fixed:', elementCards.length);

                // Fix filter sections
                const filterSections = document.querySelectorAll('.filter-section, .element-filter');
                filterSections.forEach(section => {
                    section.style.width = '100%';
                    section.style.padding = '12px';
                    section.style.margin = '0';
                });

                // Hide "Click an element" text
                const clickText = document.querySelector('[style*="opacity: 0.5"]');
                if (clickText && clickText.textContent.includes('Click an element')) {
                    clickText.style.display = 'none';
                    console.log(' "Click an element" text hidden');
                }

                const filterButtons = document.querySelectorAll('.filter-buttons, #elementFilterButtons');
                filterButtons.forEach(btns => {
                    btns.style.flexWrap = 'nowrap';
                    btns.style.justifyContent = 'flex-start';
                    btns.style.gap = '3px';
                    btns.style.overflowX = 'auto';
                });

                // Compress filter buttons - single line, 9px font
                const filterBtns = document.querySelectorAll('.filter-btn, .element-filter-btn');
                filterBtns.forEach(btn => {
                    btn.style.fontSize = '9px';
                    btn.style.padding = '6px 6px';
                    btn.style.whiteSpace = 'nowrap';
                    btn.style.flexShrink = '0';
                });
                if (filterBtns.length > 0) console.log(' Filter buttons compressed:', filterBtns.length);

                // Fix element headers with tooltips
                const elementHeaders = document.querySelectorAll('.element-header');
                elementHeaders.forEach(header => {
                    header.style.flexDirection = 'column';
                    header.style.alignItems = 'flex-start';
                    header.style.gap = '8px';
                });

                const elementTooltips = document.querySelectorAll('.element-tooltips');
                elementTooltips.forEach(tooltips => {
                    tooltips.style.width = '100%';
                    tooltips.style.justifyContent = 'flex-start';
                    tooltips.style.flexWrap = 'nowrap';
                    tooltips.style.gap = '4px';
                });

                // Compress tooltip buttons - same height (28px), one line
                const tooltipBtns = document.querySelectorAll('.element-tooltips button, .element-tooltips [style*="border"]');
                tooltipBtns.forEach(btn => {
                    btn.style.fontSize = '9px';
                    btn.style.padding = '6px 8px';
                    btn.style.height = '28px';
                    btn.style.lineHeight = '1';
                    btn.style.whiteSpace = 'nowrap';
                });

                // Fix gap items - same margins as Element heading containers
                const gapItems = document.querySelectorAll('.gap-item');
                gapItems.forEach(item => {
                    item.style.padding = '16px';
                    item.style.margin = '0 0 16px 0';
                    item.style.maxWidth = '100%';
                });
                if (gapItems.length > 0) console.log(' Gap items fixed with margins:', gapItems.length);

                // Fix research sections with LEFT/RIGHT MARGINS
                const researchSections = document.querySelectorAll('[style*="RESEARCH REFERENCES"]');
                researchSections.forEach(section => {
                    const parent = section.closest('div');
                    if (parent) {
                        parent.style.padding = '16px';
                        parent.style.margin = '0 16px 16px 16px';
                        parent.style.maxWidth = 'calc(100% - 32px)';
                    }
                });

                const researchItems = document.querySelectorAll('.research-item');
                researchItems.forEach(item => {
                    item.style.padding = '12px';
                    item.style.margin = '0 0 12px 0';
                });
                if (researchItems.length > 0) console.log(' Research items fixed:', researchItems.length);

                // Fix border-left boxes in research
                const researchBoxes = document.querySelectorAll('[style*="border-left: 4px solid"]');
                researchBoxes.forEach(box => {
                    box.style.padding = '12px';
                    box.style.margin = '0';
                });

                console.log(' All mobile fixes applied!');
            } else {
                console.log(' Desktop mode - no mobile fixes needed');
            }
        }

        // Apply on load
        applyMobileFixes();

        // Reapply on resize
        window.addEventListener('resize', applyMobileFixes);

        // Make entire radio option containers clickable
        document.addEventListener('click', function(e) {
            const radioOption = e.target.closest('.radio-option');
            if (radioOption) {
                const radioInput = radioOption.querySelector('input[type="radio"]');
                if (radioInput && e.target !== radioInput) {
                    radioInput.checked = true;
                    // Trigger change event for any listeners
                    radioInput.dispatchEvent(new Event('change', { bubbles: true }));
                }
            }
        });

        // SOVA center circle tooltip
        const sovaCenterCircle = document.getElementById('sova-center-circle');
        if (sovaCenterCircle) {
            sovaCenterCircle.addEventListener('mouseenter', (e) => {
                const tooltipTitle = tooltip.querySelector('.tooltip-title');
                const tooltipDesc = tooltip.querySelector('.tooltip-desc');

                tooltipTitle.textContent = 'Why 9 Elements?';
                tooltipDesc.innerHTML = `<strong>90% of startups fail due to operational inefficiencies, not bad ideas.</strong> Most founders treat these 9 business functions as separate problems, but they're deeply interconnected.<br><br>Sova's framework is built on proven business excellence models (<strong>Australian Business Excellence Framework</strong>, <strong>Baldrige Excellence Framework</strong>, <strong>EFQM Excellence Model</strong>, <strong>ISO 9001:2015</strong>) adapted specifically for startups. These frameworks represent decades of research into what makes organisations successful and sustainable.<br><br>By understanding how your 9 elements connect, you can diagnose root causes (not just symptoms) and build a sustainable business from day one.<br><br><a href="https://www.bpir.com/business-excellence-models/" target="_blank" style="color: #3D2517; font-weight: 700; text-decoration: underline;">Learn more about business excellence frameworks </a>`;

                // Get the bounding box of the SOVA center circle
                const circleRect = sovaCenterCircle.getBoundingClientRect();
                const circleCenterX = circleRect.left + circleRect.width / 2;
                const circleBottom = circleRect.bottom;

                // Center tooltip horizontally and position just below the circle
                // Make tooltip pointer-events: auto so links are clickable
                tooltip.style.pointerEvents = 'auto';
                tooltip.style.left = (circleCenterX - 200) + 'px'; // 200 is half of max-width 400px
                tooltip.style.top = (circleBottom + 10) + 'px';
                tooltip.style.maxWidth = '400px'; // Make it wider for this tooltip
                tooltip.classList.add('show');
            });

            sovaCenterCircle.addEventListener('mouseleave', () => {
                // Don't hide immediately - give time to move mouse to link
                setTimeout(() => {
                    if (!tooltip.matches(':hover')) {
                        tooltip.style.maxWidth = '300px'; // Reset to default
                        tooltip.style.pointerEvents = 'none'; // Reset to default
                        tooltip.classList.remove('show');
                    }
                }, 100);
            });

            // Hide tooltip when mouse leaves the tooltip itself
            tooltip.addEventListener('mouseleave', () => {
                tooltip.style.maxWidth = '300px'; // Reset to default
                tooltip.style.pointerEvents = 'none'; // Reset to default
                tooltip.classList.remove('show');
            });
        }

        // Scroll to next question on preliminary page after radio selection
        document.addEventListener('change', function(e) {
            if (e.target.type === 'radio') {
                const currentGroup = e.target.closest('.question-group');
                if (currentGroup && currentGroup.parentElement.id === 'step1Section') {
                    // Get all question groups in the preliminary section
                    const allGroups = Array.from(document.querySelectorAll('#step1Section .question-group'));
                    const currentIndex = allGroups.indexOf(currentGroup);

                    // Scroll to next question group if it exists
                    if (currentIndex >= 0 && currentIndex < allGroups.length - 1) {
                        setTimeout(() => {
                            const nextGroup = allGroups[currentIndex + 1];
                            if (nextGroup) {
                                nextGroup.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }, 300);
                    }
                }
            }
        });
    </script>
</body>
</html>
