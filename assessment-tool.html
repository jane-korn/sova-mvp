<!DOCTYPE html>
<!--
================================================================================
PROPRIETARY AND CONFIDENTIAL
Copyright (c) 2025 Sova Pty Ltd. All Rights Reserved.

This software and its documentation are protected by copyright law and
international treaties. Unauthorized reproduction, distribution, or use of
this software, in whole or in part, is strictly prohibited and may result
in severe civil and criminal penalties.

Protected by Australian Copyright Act 1968
Protected by Digital Millennium Copyright Act (DMCA)
================================================================================
-->
<!-- UPDATED: 2025-12-02 - Version 6.54 - Security headers, copyright, anti-copy protection -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Sova Business Assessment v3.0 - Multi-Element</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/variables.css">
    <script src="config.js?v=20251127"></script>
    <script src="questions-data.js?v=20251126"></script>
    <script src="article-urls.js?v=20251126"></script>
    <script src="content-data.js?v=20251126"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            font-weight: 300;
            background: #2d2828;
            color: #f5f5dc;
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 100px;
        }

        html {
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .bird-icon {
            position: fixed;
            bottom: 20px;
            right: 20px;
            height: 45px;
            width: auto;
            opacity: 0.4;
            z-index: 1000;
            transition: opacity 0.3s ease;
        }

        .bird-icon:hover {
            opacity: 0.7;
        }

        header {
            padding: 1rem 0;
            border-bottom: 1px solid rgba(234, 255, 196, 0.1);
            background: #2d2828;
        }

        .logo-text {
            font-size: 32px;
            font-weight: 800;
            color: #eaffc4;
            letter-spacing: 2px;
            text-shadow: 0 0 20px rgba(234, 255, 196, 0.3);
        }

        /* Preliminary Questions Section */
        .prelim-section {
            animation: fadeIn 0.6s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .prelim-section::before {
            display: none; /* Remove top gradient line */
            opacity: 0.8;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .prelim-section h2 {
            font-size: clamp(32px, 4vw, 42px);
            margin-bottom: 12px;
            color: #f5f5dc;
            font-weight: 800;
            letter-spacing: -0.5px;
            line-height: 1.2;
        }

        .prelim-section p {
            color: #b8d78f;
            margin-bottom: 40px;
            font-size: 18px;
            opacity: 0.7;
            font-weight: 400;
            line-height: 1.6;
        }

        .question-group {
            margin-bottom: 40px;
            padding: 32px;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            border: 2px solid rgba(45, 40, 40, 0.06);
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .question-group:hover {
            border-color: rgba(234, 255, 196, 0.3);
            box-shadow: 0 4px 16px rgba(234, 255, 196, 0.1);
            transform: translateY(-2px);
        }

        .question-label {
            display: block;
            font-weight: 700;
            margin-bottom: 8px;
            color: #2d2828;
            font-size: 20px;
            letter-spacing: -0.3px;
        }

        .radio-group {
            display: flex;
            gap: 16px;
            margin-bottom: 8px;
        }

        .radio-option {
            display: flex;
            align-items: flex-start;
            gap: 14px;
            padding: 20px;
            background: #ffffff;
            border-radius: 16px;
            border: 2px solid rgba(61, 37, 23, 0.1);
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
        }

        .radio-option:hover {
            border-color: rgba(196, 255, 0, 0.4);
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.05) 0%, rgba(255, 255, 255, 1) 100%);
            transform: translateX(4px);
            box-shadow: 0 4px 12px rgba(196, 255, 0, 0.15);
        }

        .radio-option input[type="radio"] {
            width: 22px;
            height: 22px;
            min-width: 22px;
            cursor: pointer;
            accent-color: #eaffc4;
            margin-top: 2px;
        }

        .radio-option input[type="radio"]:checked + label {
            font-weight: 700;
            color: #2d2828;
        }

        .radio-option label {
            cursor: pointer;
            font-size: 16px;
            color: #2d2828;
            transition: all 0.3s ease;
            line-height: 1.5;
            font-weight: 500;
        }

        .radio-option:has(input[type="radio"]:checked) {
            border-color: #eaffc4;
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.08) 0%, #ffffff 100%);
            box-shadow: 0 6px 20px rgba(196, 255, 0, 0.2);
        }

        /* Option Cards - Prelim & Validation (path-card inspired hover) */
        .option-card {
            position: relative;
            overflow: hidden;
        }

        .option-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 0;
            background: #eaffc4;
            transition: height 0.3s ease;
            border-radius: 2px 0 0 2px;
        }

        .option-card:hover::before {
            height: 100%;
        }

        .option-card:hover {
            background: rgba(245, 245, 220, 0.08) !important;
            border-color: #eaffc4 !important;
            transform: translateX(4px);
        }

        .option-card.selected {
            border-color: #eaffc4 !important;
            background: rgba(234, 255, 196, 0.1) !important;
        }

        .option-card.selected::before {
            height: 100%;
        }

        /* Validation option cards - smaller padding adjustment */
        .validation-option:hover {
            transform: translateX(2px);
        }

        /* Path Cards - Choose Your Flight Path */
        .path-card {
            background: rgba(245, 245, 220, 0.02);
            border: 2px solid rgba(234, 255, 196, 0.15);
            border-radius: 12px;
            padding: 2rem;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .path-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 0;
            background: #eaffc4;
            transition: height 0.3s ease;
        }

        .path-card:hover:not(.coming-soon)::before {
            height: 100%;
        }

        .path-card:hover:not(.coming-soon) {
            background: rgba(245, 245, 220, 0.04);
            border-color: #eaffc4;
            transform: translateX(4px);
        }

        .path-card.coming-soon {
            cursor: not-allowed;
            opacity: 0.5;
        }

        .path-number {
            position: absolute;
            top: 2rem;
            right: 2rem;
            font-size: 6rem;
            font-weight: 700;
            color: rgba(234, 255, 196, 0.05);
            line-height: 1;
        }

        .path-title {
            font-size: clamp(1.5rem, 3vw, 2rem);
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 1rem;
            position: relative;
            z-index: 1;
        }

        .path-desc {
            font-size: 1.0625rem;
            color: #b8d78f;
            margin-bottom: 1.5rem;
            line-height: 1.7;
            position: relative;
            z-index: 1;
        }

        .path-meta {
            display: flex;
            gap: 2rem;
            font-size: 0.9375rem;
            color: #b8d78f;
            position: relative;
            z-index: 1;
        }

        .meta-item {
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
        }

        .meta-label {
            font-weight: 400;
            opacity: 0.7;
        }

        .coming-soon-badge {
            display: inline-block;
            background: rgba(184, 215, 143, 0.15);
            color: #b8d78f;
            padding: 0.375rem 1rem;
            border-radius: 24px;
            font-size: 0.8125rem;
            font-weight: 600;
            margin-left: 0.75rem;
            letter-spacing: 0.05em;
            text-transform: uppercase;
        }

        /* Input Fields - Premium Redesign */
        input[type="text"],
        input[type="email"],
        select {
            width: 100%;
            padding: 18px 24px;
            border: 2px solid rgba(61, 37, 23, 0.15);
            border-radius: 16px;
            font-size: 16px;
            background: #ffffff;
            color: #2d2828;
            transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(61, 37, 23, 0.04);
        }

        input[type="text"]:hover,
        input[type="email"]:hover,
        select:hover {
            border-color: rgba(196, 255, 0, 0.4);
            box-shadow: 0 4px 16px rgba(196, 255, 0, 0.1);
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        select:focus {
            outline: none;
            border-color: #eaffc4;
            background: #ffffff;
            box-shadow: 0 0 0 4px rgba(196, 255, 0, 0.15), 0 8px 24px rgba(196, 255, 0, 0.2);
            transform: translateY(-2px);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%233D2517' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 20px;
            padding-right: 48px;
        }

        input::placeholder {
            color: rgba(61, 37, 23, 0.4);
        }

        select {
            cursor: pointer;
        }

        select option {
            background: #ffffff;
            color: #2d2828;
        }

        small {
            color: #2d2828 !important;
            font-size: 15px !important;
            opacity: 0.6;
            font-weight: 400;
            line-height: 1.5;
        }

        .btn-primary {
            background: linear-gradient(135deg, #eaffc4 0%, #b8d78f 100%);
            color: #2d2828;
            border: none;
            padding: 20px 56px;
            border-radius: 16px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.23, 1, 0.32, 1);
            box-shadow:
                0 2px 8px rgba(196, 255, 0, 0.2),
                0 8px 24px rgba(196, 255, 0, 0.15);
            letter-spacing: 0.3px;
            text-transform: uppercase;
            position: relative;
            overflow: hidden;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s ease;
            pointer-events: none; /* Allow clicks to pass through to button */
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow:
                0 4px 16px rgba(196, 255, 0, 0.3),
                0 12px 40px rgba(196, 255, 0, 0.25);
        }

        .btn-primary:active {
            transform: translateY(-1px);
        }

        /* Model Section */
        .model-section {
            display: none;
            text-align: center;
        }

        .model-section.active {
            display: block;
        }

        .model-wrapper {
            position: relative;
            max-width: 1000px;
            width: 100%;
            margin: 0 auto;
            margin-top: -60px;
            padding: 40px;
            padding-top: 20px;
            box-sizing: border-box;
            z-index: 1;
        }

        #sova-model {
            display: block;
            width: 100%;
            height: auto;
        }

        /* SVG Interactive Elements */
        .element-dot {
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .element-dot:hover {
            filter: brightness(1.3) drop-shadow(0 0 8px #eaffc4);
        }

        .element-dot.active {
            filter: drop-shadow(0 0 4px rgba(196, 255, 0, 0.6));
        }

        .element-dot.active:hover {
            filter: drop-shadow(0 0 12px #eaffc4) brightness(1.2);
        }

        .element-dot.locked {
            opacity: 0.2;
            cursor: not-allowed;
        }

        .element-dot.locked:hover {
            filter: none;
            transform: none;
        }

        /* Uncompleted/Not started MVP elements - hollow lime outline, prominent */
        .element-dot:not(.completed):not(.in-progress):not(.locked) {
            fill: none !important;
            stroke: #eaffc4 !important;
            stroke-width: 4 !important;
            opacity: 0.7;
            filter: drop-shadow(0 0 6px rgba(196, 255, 0, 0.4));
            pointer-events: all !important;
        }

        /* In-progress elements - hollow with strong glow */
        .element-dot.in-progress {
            fill: none !important;
            stroke: #eaffc4 !important;
            stroke-width: 5 !important;
            opacity: 0.9;
            filter: drop-shadow(0 0 10px rgba(196, 255, 0, 0.6));
            pointer-events: all !important;
        }

        /* Completed elements - fully filled with electric lime, maximum impact */
        .element-dot.completed {
            fill: #eaffc4 !important;
            stroke: #eaffc4 !important;
            stroke-width: 2 !important;
            filter: drop-shadow(0 0 16px #eaffc4) drop-shadow(0 0 8px #eaffc4);
            opacity: 1;
        }

        /* Locked non-MVP elements - dramatically dimmed */
        .element-dot.locked {
            fill: #2d2828 !important;
            opacity: 0.15 !important;
            filter: none !important;
        }

        /* Pulse animation for active clickable elements - beaming glow effect */
        @keyframes elementPulse {
            0%, 100% {
                filter: drop-shadow(0 0 8px rgba(234, 255, 196, 0.5)) drop-shadow(0 0 4px rgba(234, 255, 196, 0.3));
                transform: scale(1);
                opacity: 0.8;
            }
            50% {
                filter: drop-shadow(0 0 25px rgba(234, 255, 196, 1)) drop-shadow(0 0 12px rgba(234, 255, 196, 0.9)) drop-shadow(0 0 40px rgba(234, 255, 196, 0.6));
                transform: scale(1.1);
                opacity: 1;
            }
        }

        /* Hint text pulse animation */
        @keyframes hintPulse {
            0%, 100% { opacity: 0.4; transform: scale(0.9); }
            50% { opacity: 1; transform: scale(1.1); }
        }

        .element-dot.active:not(.completed):not(.in-progress) {
            animation: elementPulse 2s ease-in-out infinite;
            transform-origin: center;
            transform-box: fill-box;
        }

        /* Pause animation on hover for clear feedback */
        .element-dot.active:not(.completed):not(.in-progress):hover {
            animation-play-state: paused;
            transform: scale(1.15) !important;
            filter: drop-shadow(0 0 20px #eaffc4) brightness(1.2) !important;
        }

        .element-spoke {
            transition: opacity 0.3s ease;
        }

        #sova-model text {
            transition: all 0.3s ease;
        }

        .element-dot:hover + text,
        text:has(+ .element-dot:hover) {
            fill: #eaffc4 !important;
        }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: #f5f5dc;
            border: 2px solid #eaffc4;
            color: #2d2828;
            padding: 16px 20px;
            border-radius: 12px;
            min-width: 200px;
            max-width: 300px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 1000;
            box-shadow: 0 8px 32px rgba(196, 255, 0, 0.3);
        }

        .tooltip.show {
            opacity: 1;
        }

        .tooltip-title {
            font-weight: 700;
            margin-bottom: 6px;
            color: #2d2828;
            font-size: 15px;
        }

        .tooltip-desc {
            font-size: 13px;
            line-height: 1.5;
            color: #2d2828;
            opacity: 0.8;
        }

        /* Questionnaire Section */
        .questionnaire-section {
            display: none;
        }

        .questionnaire-section.active {
            display: block;
        }

        /* Results Section */
        .results-section {
            display: none;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .results-section.active {
            display: block;
        }

        .results-container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .results-header {
            text-align: center;
            margin-bottom: 48px;
        }

        .results-header h1 {
            font-size: 42px;
            color: #eaffc4;
            margin: 16px 0;
        }

        .results-header p {
            font-size: 18px;
            color: #f5f5dc;
            opacity: 0.8;
        }

        .score-card {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.1) 0%, rgba(197, 217, 82, 0.1) 100%);
            border: 2px solid rgba(196, 255, 0, 0.3);
            border-radius: 24px;
            padding: 40px;
            margin-bottom: 40px;
            display: flex;
            gap: 40px;
            align-items: center;
        }

        .score-visual svg {
            filter: drop-shadow(0 0 20px rgba(196, 255, 0, 0.3));
        }

        .score-details {
            flex: 1;
        }

        .score-details h2 {
            font-size: 32px;
            color: #eaffc4;
            margin-bottom: 16px;
        }

        .score-details p {
            font-size: 18px;
            color: #f5f5dc;
            opacity: 0.9;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .score-breakdown {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border-left: 4px solid #eaffc4;
        }

        .score-item-label {
            font-size: 16px;
            color: #f5f5dc;
            font-weight: 600;
        }

        .score-item-value {
            font-size: 18px;
            color: #eaffc4;
            font-weight: 700;
        }

        .recommendations-section, .tools-section, .next-steps-section {
            background: rgba(245, 241, 232, 0.05);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
        }

        .recommendations-section h2, .tools-section h2, .next-steps-section h2 {
            font-size: 28px;
            color: #eaffc4;
            margin-bottom: 24px;
        }

        .recommendation-card, .tool-card, .next-step-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(196, 255, 0, 0.2);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 16px;
        }

        .recommendation-card h3, .tool-card h3, .next-step-card h3 {
            font-size: 20px;
            color: #b8d78f;
            margin-bottom: 12px;
        }

        .recommendation-card p, .tool-card p, .next-step-card p {
            font-size: 16px;
            color: #f5f5dc;
            opacity: 0.9;
            line-height: 1.6;
        }

        /* Stage Tracker Styles */
        .stage-tracker {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(196, 255, 0, 0.2);
            border-radius: 16px;
            padding: 24px;
            margin: 32px 0;
        }

        .stage-tracker h3 {
            color: #eaffc4;
            font-size: 20px;
            margin-bottom: 20px;
        }

        .stage-progress-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .stage-item {
            text-align: center;
            flex: 0 0 auto;
        }

        .stage-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin: 0 auto 8px;
        }

        .stage-item.complete .stage-number {
            background: #eaffc4;
            color: #000;
        }

        .stage-item.current .stage-number {
            background: #b8d78f;
            color: #000;
        }

        .stage-item.pending .stage-number {
            background: rgba(255, 255, 255, 0.1);
            color: #b8d78f;
        }

        .stage-name {
            font-size: 14px;
            color: #f5f5dc;
        }

        .stage-connector {
            flex: 1;
            height: 2px;
            background: rgba(255, 255, 255, 0.1);
            margin: 0 8px;
        }

        .stage-connector.complete {
            background: #eaffc4;
        }

        /* Premium Tooltip Popovers (Jeton/Phamily/Osmo style) */
        .tooltip-trigger {
            position: relative;
            display: inline-block;
            color: #f5f5dc;
            font-size: 13px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1);
            text-decoration: none;
        }

        .tooltip-trigger.gold {
            background: linear-gradient(135deg, rgba(232, 197, 71, 0.15) 0%, rgba(232, 197, 71, 0.08) 100%);
            border: 1.5px solid rgba(232, 197, 71, 0.4);
        }

        .tooltip-trigger.lime {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.12) 0%, rgba(196, 255, 0, 0.06) 100%);
            border: 1.5px solid rgba(196, 255, 0, 0.4);
        }

        .tooltip-trigger:hover {
            /* Note: transform breaks position:fixed on child elements, so we use box-shadow only */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .tooltip-trigger.gold:hover {
            background: linear-gradient(135deg, rgba(232, 197, 71, 0.25) 0%, rgba(232, 197, 71, 0.15) 100%);
            border-color: rgba(232, 197, 71, 0.7);
        }

        .tooltip-trigger.lime:hover {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.2) 0%, rgba(196, 255, 0, 0.1) 100%);
            border-color: rgba(196, 255, 0, 0.7);
        }

        .tooltip-popover {
            position: fixed;
            top: 50px;
            bottom: auto;
            left: 50%;
            transform: translateX(-50%);
            background: #ffffff;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(61, 37, 23, 0.1);
            min-width: 280px;
            max-width: min(400px, calc(100vw - 32px));
            width: 400px;
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: opacity 0.3s ease, visibility 0.3s ease, top 0.3s ease;
            z-index: 999999 !important;
        }

        .tooltip-trigger:hover .tooltip-popover,
        .tooltip-trigger.active .tooltip-popover {
            opacity: 1;
            visibility: visible;
            pointer-events: auto;
        }

        /* Popover arrow - points DOWN to the button (default, above position) */
        .tooltip-popover::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: var(--arrow-offset, 50%);
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 10px solid transparent;
            border-right: 10px solid transparent;
            border-top: 10px solid #ffffff;
            border-bottom: none;
        }

        /* Arrow points UP when tooltip is below the button */
        .tooltip-popover.below::after {
            bottom: auto;
            top: -10px;
            border-top: none;
            border-bottom: 10px solid #ffffff;
        }

        .tooltip-popover-label {
            color: #2d2828;
            opacity: 0.5;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            margin-bottom: 10px;
        }

        .tooltip-popover-content {
            color: #2d2828;
            font-size: 14px;
            line-height: 1.6;
            font-style: italic;
            margin-bottom: 12px;
        }

        .tooltip-popover-link {
            color: #2d2828;
            font-size: 11px;
            font-weight: 700;
            text-decoration: none;
            border-bottom: 2px solid #2d2828;
            display: inline-block;
            transition: all 0.2s;
        }

        .tooltip-popover-link:hover {
            color: #eaffc4;
            border-bottom-color: #eaffc4;
        }

        /* Corner accent for tooltip */
        .tooltip-corner {
            position: absolute;
            top: 0;
            right: 0;
            width: 30px;
            height: 30px;
            border-radius: 0 12px 0 0;
            opacity: 0.15;
        }

        .tooltip-corner.gold {
            background: linear-gradient(135deg, transparent 50%, #b8d78f 50%);
        }

        .tooltip-corner.lime {
            background: linear-gradient(135deg, transparent 50%, #eaffc4 50%);
        }

        /* Golden Circle Sections */
        .golden-circle-section {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(196, 255, 0, 0.2);
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
        }

        .golden-circle-section h2 {
            color: #eaffc4;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .golden-circle-section p {
            color: #f5f5dc;
            line-height: 1.6;
        }

        .why-section {
            border-left: 4px solid #eaffc4;
        }

        .how-section {
            border-left: 4px solid #b8d78f;
        }

        .what-section {
            border-left: 4px solid #b8d78f;
        }

        /* Gap Cards */
        .gap-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(196, 255, 0, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
        }

        .gap-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 12px;
        }

        .gap-header h3 {
            flex: 1;
            color: #f5f5dc;
            font-size: 18px;
            margin: 0;
        }

        .gap-priority {
            background: #eaffc4;
            color: #000;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            white-space: nowrap;
            margin-left: 12px;
        }

        .gap-card p {
            color: #f5f5dc;
            margin: 8px 0;
        }

        .gap-card ul {
            color: #f5f5dc;
            margin-left: 20px;
        }

        .gap-card li {
            margin: 6px 0;
        }

        /* Guides Section */
        .guides-section {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(196, 255, 0, 0.1);
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
        }

        .guides-section h3 {
            color: #eaffc4;
            font-size: 20px;
            margin-bottom: 16px;
        }

        .guides-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .guide-item {
            padding: 16px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .guide-item strong {
            color: #b8d78f;
            display: block;
            margin-bottom: 8px;
        }

        .guide-item span {
            color: #f5f5dc;
            font-size: 14px;
            opacity: 0.8;
        }

        .results-actions {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-top: 48px;
        }

        .btn-secondary {
            padding: 14px 32px;
            font-size: 16px;
            border-radius: 8px;
            border: 2px solid #eaffc4;
            background: transparent;
            color: #eaffc4;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: rgba(196, 255, 0, 0.1);
            transform: translateY(-2px);
        }

        .questionnaire-container {
            background: #f5f5dc;
            padding: 48px;
            border-radius: 24px;
            border: 1px solid rgba(196, 255, 0, 0.3);
            box-shadow: 0 8px 32px rgba(196, 255, 0, 0.2);
            max-width: 800px;
            margin: 0 auto;
            position: relative;
        }

        .exit-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: none;
            color: #2d2828;
            font-size: 32px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
            line-height: 1;
        }

        .exit-btn:hover {
            background: rgba(61, 37, 23, 0.1);
            transform: rotate(90deg);
        }

        .progress-bar-container {
            margin-bottom: 32px;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-info #questionProgress {
            font-size: 14px;
            color: #2d2828;
            opacity: 0.7;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(61, 37, 23, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #eaffc4 0%, #b8d78f 100%);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .question-container {
            margin-bottom: 32px;
        }

        .element-badge {
            display: inline-block;
            background: #eaffc4;
            color: #2d2828;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .question-text {
            font-size: 22px;
            font-weight: 600;
            color: #2d2828;
            line-height: 1.5;
            margin-bottom: 24px;
        }

        /* Info buttons */
        .info-buttons-row {
            display: flex;
            justify-content: flex-end;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 4px;
            margin-bottom: 16px;
        }

        /* Resource button styling */
        .info-btn[style*="border: 2px solid #eaffc4"] {
            flex-basis: 100%;
            order: 2;
        }

        /* Other buttons stay on first line */
        .info-btn:not([style*="border: 2px solid #eaffc4"]) {
            order: 1;
        }

        .info-btn {
            padding: 8px 14px;
            border: 2px solid rgba(61, 37, 23, 0.2);
            border-radius: 6px;
            background: white;
            color: #2d2828;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            text-decoration: none;
            display: inline-block;
        }

        .info-btn:hover {
            border-color: #2d2828;
            background: rgba(61, 37, 23, 0.05);
        }

        .info-btn.active {
            background: #eaffc4;
            border-color: #eaffc4;
            color: #2d2828;
        }

        .info-content {
            display: none;
            background: rgba(61, 37, 23, 0.05);
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #eaffc4;
            position: relative;
        }

        .info-content.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .info-content h4 {
            color: #2d2828;
            font-size: 15px;
            font-weight: 700;
            margin-bottom: 12px;
        }

        .info-content p {
            color: #2d2828;
            font-size: 14px;
            line-height: 1.7;
            margin-bottom: 8px;
        }

        .info-content a {
            color: #2d2828;
            text-decoration: underline;
            font-weight: 600;
        }

        .info-content a:hover {
            color: #eaffc4;
        }

        .info-content blockquote {
            margin: 8px 0;
            padding: 12px 16px;
            background: white;
            border-left: 3px solid #eaffc4;
            font-style: italic;
            color: #2d2828;
            line-height: 1.6;
        }

        .answer-buttons {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
        }

        .answer-btn {
            flex: 1;
            padding: 12px 24px;
            border: 2px solid #2d2828;
            border-radius: 10px;
            background: white;
            color: #2d2828;
            font-size: 15px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .answer-btn:hover {
            border-color: #eaffc4;
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(196, 255, 0, 0.3);
        }

        .answer-btn.selected {
            background: #eaffc4;
            border-color: #eaffc4;
            color: #2d2828;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            gap: 16px;
        }

        .nav-btn {
            padding: 14px 32px;
            border: 2px solid #2d2828;
            border-radius: 8px;
            background: white;
            color: #2d2828;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn:hover:not(:disabled) {
            background: #2d2828;
            color: #f5f5dc;
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .nav-btn.next-btn {
            background: linear-gradient(135deg, #eaffc4 0%, #b8d78f 100%);
            border-color: #eaffc4;
            color: #2d2828;
            font-weight: 700;
        }

        .nav-btn.next-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(196, 255, 0, 0.3);
        }

        /* Stage recommendation */
        .stage-recommendation {
            background: rgba(196, 255, 0, 0.15);
            border: 2px solid #eaffc4;
            padding: 20px;
            margin-top: 24px;
            border-radius: 12px;
        }

        .stage-recommendation strong {
            color: #2d2828;
            font-weight: 700;
        }

        /* Validation section styling - compressed for one-page fit */
        #step2Section {
            background: #f5f5dc;
            padding: 48px;
            border-radius: 16px;
            border: 1px solid rgba(196, 255, 0, 0.3);
            box-shadow: 0 4px 16px rgba(196, 255, 0, 0.15);
            max-width: 1000px;
            margin: 0 auto;
        }

        #step2Section h2 {
            color: #2d2828;
            font-size: 20px;
            margin-bottom: 16px;
        }

        #validationQuestions .question-group label {
            color: #2d2828;
            font-size: 16px;
            font-weight: 500;
        }

        /* Enhanced glow animation - prominent pulse without movement */
        /* Using opacity and stroke-width for mobile compatibility (filter not supported on SVG in iOS) */
        @keyframes glow {
            0%, 100% {
                opacity: 0.7 !important;
                stroke-width: 4 !important;
            }
            50% {
                opacity: 1 !important;
                stroke-width: 10 !important;
            }
        }

        @keyframes smoothFadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes smoothZoomIn {
            from {
                transform: scale(0.9) translateY(20px);
                opacity: 0;
            }
            to {
                transform: scale(1) translateY(0);
                opacity: 1;
            }
        }

        @keyframes gentlePulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 8px 24px rgba(196, 255, 0, 0.3);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 12px 32px rgba(196, 255, 0, 0.5);
            }
        }

        .element-dot {
            transition: filter 0.3s ease;
        }

        /* Combined Report Section - Unique Sophisticated Layout */
        .report-section {
            width: 100%;
            background: #f5f5dc;
            padding: 0;
            min-height: 100vh;
            position: relative;
        }

        .report-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0;
        }

        .report-header {
            background: #2d2828;
            padding: 120px 60px 80px 60px;
            position: relative;
            overflow: hidden;
        }

        .report-header h2 {
            color: #eaffc4;
            font-size: clamp(48px, 8vw, 120px);
            font-weight: 700;
            margin: 0 0 24px 0;
            letter-spacing: -3px;
            line-height: 0.9;
        }

        .report-header p {
            color: #f5f5dc;
            font-size: clamp(18px, 2.5vw, 28px);
            opacity: 0.8;
            margin: 0;
            max-width: 800px;
        }

        .overall-progress {
            background: white;
            border-radius: 12px;
            padding: 40px;
            border-left: 6px solid #eaffc4;
            box-shadow: 0 4px 16px rgba(61, 37, 23, 0.08);
        }

        .progress-text {
            color: #2d2828;
            font-size: 16px;
            margin: 0;
        }

        /* Layered Card System - Jeton inspired */
        .report-card {
            background: white;
            border-radius: 16px;
            padding: 0;
            margin-bottom: 40px;
            position: relative;
            box-shadow: 0 2px 12px rgba(61, 37, 23, 0.06);
            transition: transform 0.4s cubic-bezier(0.23, 1, 0.32, 1);
        }

        .report-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(61, 37, 23, 0.12);
        }

        .section-heading {
            color: #1c1917;
            font-size: 32px;
            font-weight: 500;
            margin-bottom: 32px;
            letter-spacing: -0.8px;
        }

        .section-content {
            color: #44403c;
            font-size: 15px;
            line-height: 1.7;
        }

        .section-intro {
            color: #78716c;
            font-size: 15px;
            line-height: 1.6;
            margin: -8px 0 32px 0;
        }

        .placeholder-text {
            color: #a8a29e;
            font-style: normal;
            margin: 0;
            font-size: 15px;
        }

        /* Priority card - special styling */
        .priority-card {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.1) 0%, rgba(197, 217, 82, 0.1) 100%);
            border: 3px solid #eaffc4;
        }

        .priority-card .section-heading {
            color: #2d2828;
            font-size: 32px;
        }

        /* Strength card - positive styling */
        .strength-card {
            background: linear-gradient(135deg, rgba(197, 217, 82, 0.08) 0%, rgba(232, 197, 71, 0.08) 100%);
            border-left: 6px solid #b8d78f;
        }

        /* Checklist item */
        .checklist-item {
            background: white;
            border: 2px solid #2d2828;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
            transition: all 0.3s ease;
        }

        .checklist-item:hover {
            transform: translateX(4px);
            box-shadow: -4px 4px 0 #eaffc4;
        }

        .checklist-header {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
        }

        .checklist-number {
            background: #eaffc4;
            color: #2d2828;
            font-weight: 700;
            font-size: 14px;
            padding: 6px 12px;
            border-radius: 6px;
            flex-shrink: 0;
        }

        .checklist-title {
            color: #2d2828;
            font-size: 18px;
            font-weight: 700;
            margin: 0;
            line-height: 1.4;
        }

        .checklist-details {
            margin-left: 48px;
            color: #2d2828;
            font-size: 14px;
            line-height: 1.6;
        }

        .checklist-tools {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 12px;
        }

        .tool-tag {
            background: #f5f5dc;
            border: 1px solid #2d2828;
            color: #2d2828;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .tool-tag:hover {
            background: #eaffc4;
            transform: translateY(-2px);
        }

        /* Status badge */
        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .status-discovery {
            background: rgba(197, 217, 82, 0.2);
            color: #2d2828;
        }

        .status-validation {
            background: rgba(232, 197, 71, 0.3);
            color: #2d2828;
        }

        .status-efficiency {
            background: rgba(196, 255, 0, 0.4);
            color: #2d2828;
        }

        .status-scale {
            background: #eaffc4;
            color: #2d2828;
        }

        /* Element status card */
        .element-status {
            background: white;
            border-left: 4px solid #eaffc4;
            padding: 16px;
            margin-bottom: 12px;
            border-radius: 4px;
        }

        .element-status h4 {
            color: #2d2828;
            font-size: 18px;
            font-weight: 700;
            margin: 0 0 8px 0;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .element-score {
            font-size: 24px;
            font-weight: 700;
            color: #eaffc4;
            text-shadow: 1px 1px 0 #2d2828;
        }

        .report-actions {
            display: flex;
            gap: 16px;
            justify-content: center;
            margin-top: 40px;
        }

        .btn-primary, .btn-secondary {
            padding: 16px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid #2d2828;
        }

        .btn-primary {
            background: linear-gradient(135deg, #eaffc4 0%, #b8d78f 100%);
            color: #2d2828;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(196, 255, 0, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #2d2828;
        }

        .btn-secondary:hover {
            background: #2d2828;
            color: #f5f5dc;
        }

        /* Gap item styling */
        .gap-item {
            background: #f5f5dc;
            border-left: 4px solid #eaffc4;
            padding: 16px;
            margin-bottom: 16px;
            border-radius: 4px;
        }

        .gap-item h4 {
            color: #2d2828;
            font-size: 18px;
            font-weight: 700;
            margin: 0 0 8px 0;
        }

        .gap-item p {
            color: #2d2828;
            font-size: 14px;
            margin: 4px 0;
            line-height: 1.6;
        }

        .gap-priority {
            display: inline-block;
            background: #eaffc4;
            color: #2d2828;
            font-size: 12px;
            font-weight: 700;
            padding: 4px 12px;
            border-radius: 12px;
            margin-bottom: 8px;
        }

        .tool-recommendation {
            background: white;
            border: 1px solid #2d2828;
            border-radius: 8px;
            padding: 12px;
            margin-top: 8px;
        }

        .tool-recommendation strong {
            color: #2d2828;
            font-size: 14px;
        }

        /* Strength item styling */
        .strength-item {
            background: linear-gradient(135deg, rgba(196, 255, 0, 0.1) 0%, rgba(197, 217, 82, 0.1) 100%);
            border-left: 4px solid #b8d78f;
            padding: 16px;
            margin-bottom: 16px;
            border-radius: 4px;
        }

        .strength-item blockquote {
            margin: 0;
            padding: 12px 16px;
            background: white;
            border-left: 3px solid #eaffc4;
            font-style: italic;
            color: #2d2828;
            line-height: 1.6;
        }

        /* Interconnection insight styling */
        .interconnection-insight {
            background: linear-gradient(135deg, rgba(232, 197, 71, 0.15) 0%, rgba(197, 217, 82, 0.15) 100%);
            border: 2px solid #b8d78f;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 16px;
        }

        .interconnection-insight strong {
            color: #2d2828;
            font-size: 18px;
        }

        .interconnection-insight p {
            color: #2d2828;
            margin: 8px 0 0 0;
            line-height: 1.6;
        }

        /* ========================================
           STANDARDISED LINK STYLES
           View Source and Read More/Less links
           ======================================== */

        .source-link,
        .read-more-link {
            background: none;
            border: none;
            color: #2d2828;
            font-family: 'Montserrat', sans-serif;
            font-size: 11px;
            font-weight: 700;
            font-style: normal;
            text-decoration: none;
            cursor: pointer;
            padding: 0;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            transition: opacity 0.2s ease;
        }

        .source-link:hover,
        .read-more-link:hover {
            opacity: 0.7;
        }

        /* Arrow icons - using consistent short arrows */
        .source-link::after {
            content: '';
            font-size: 10px;
        }

        .read-more-link.expand::after {
            content: '';
            font-size: 10px;
        }

        .read-more-link.collapse::after {
            content: '';
            font-size: 10px;
        }

        /* ========================================
           MOBILE RESPONSIVE STYLES
           ======================================== */

        /* Desktop - ensure info buttons fit on one line */
        @media screen and (min-width: 769px) {
            .info-buttons-row {
                flex-wrap: nowrap !important;
                gap: 10px !important;
            }

            .info-btn {
                font-size: 12px;
                padding: 8px 12px;
                flex-shrink: 1;
            }

            /* Resource button inline on desktop */
            .info-btn[style*="border: 2px solid #eaffc4"] {
                flex-basis: auto !important;
                order: 1;
            }
        }

        /* Tablets and below (< 1024px) */
        @media screen and (max-width: 1024px) {
            .container {
                padding: 8px 20px;
            }

            .model-wrapper {
                padding: 20px;
                margin-top: -20px;
            }

            .score-card {
                flex-direction: column;
                gap: 24px;
                padding: 32px 24px;
            }
        }

        /* Mobile and small tablets (< 768px) */
        @media screen and (max-width: 768px) {
            body {
                font-size: 16px;
            }

            .container {
                padding: 8px 0;
                max-width: 100% !important;
                margin: 0 !important;
            }

            /* Header - Mobile */
            .logo-text {
                font-size: 24px;
                letter-spacing: 1px;
            }

            /* Preliminary Section - Mobile */
            .prelim-section {
                max-width: 100% !important;
            }

            /* Fix pilot phase note on mobile */
            #prelim-page-1 > div:first-child {
                max-width: 100% !important;
                box-sizing: border-box !important;
            }

            .prelim-section h2 {
                font-size: 28px;
                margin-bottom: 12px;
            }

            .prelim-section p {
                font-size: 16px;
                margin-bottom: 32px;
            }

            .question-group {
                padding: 24px 20px;
                margin-bottom: 32px;
            }

            .question-label {
                font-size: 18px;
                margin-bottom: 12px;
            }

            /* Radio buttons - Stack vertically on mobile */
            .radio-group {
                flex-direction: column;
                gap: 12px;
            }

            .radio-option {
                padding: 16px;
                width: 100%;
            }

            .radio-option input[type="radio"] {
                width: 24px;
                height: 24px;
                min-width: 24px;
            }

            .radio-option label {
                font-size: 15px;
            }

            /* Input fields - Mobile */
            input[type="text"],
            input[type="email"],
            select {
                padding: 16px 20px;
                font-size: 16px; /* Prevents zoom on iOS */
                border-radius: 12px;
            }

            small {
                font-size: 14px !important;
            }

            /* Primary button - Mobile optimised */
            .btn-primary {
                width: 100%;
                padding: 18px 32px;
                font-size: 16px;
                border-radius: 12px;
            }

            /* Model wrapper - Mobile */
            .model-wrapper {
                padding: 16px 8px;
                margin-top: -20px;
            }

            #sova-model {
                max-width: 100%;
                height: auto;
            }

            /* Tooltip - Mobile positioning */
            .tooltip {
                max-width: 280px;
                min-width: 180px;
                padding: 12px 16px;
                font-size: 14px;
            }

            .tooltip-title {
                font-size: 14px;
            }

            .tooltip-desc {
                font-size: 12px;
            }

            /* Path Cards - Mobile */
            .path-card {
                padding: 1.5rem;
            }

            .path-number {
                font-size: 4rem;
                top: 1.5rem;
                right: 1.5rem;
            }

            .path-meta {
                flex-direction: column;
                gap: 0.75rem;
            }

            /* Questionnaire - Mobile */
            .question-container {
                padding: 24px 16px;
                border-radius: 0;
                margin: 0;
                max-width: 100% !important;
            }

            .question-text {
                font-size: 18px;
                margin-bottom: 20px;
            }

            .answer-option {
                padding: 16px 18px;
                font-size: 15px;
            }

            .answer-option input[type="radio"] {
                width: 24px;
                height: 24px;
                min-width: 24px;
            }

            /* Info boxes - Mobile */
            .info-box {
                padding: 16px;
                border-radius: 12px;
                margin-bottom: 16px;
            }

            .info-box h4 {
                font-size: 15px;
            }

            .info-box p,
            .info-box ul {
                font-size: 14px;
            }

            /* Navigation buttons - Mobile */
            .nav-buttons {
                flex-direction: column;
                gap: 12px;
            }

            .btn-nav,
            .btn-back {
                width: 100%;
                padding: 16px 24px;
                font-size: 15px;
            }

            /* Results section - Mobile */
            .results-section {
                padding: 24px 16px;
            }

            .results-header h1 {
                font-size: 32px;
                margin: 12px 0;
            }

            .results-header p {
                font-size: 16px;
            }

            .score-card {
                padding: 24px 20px;
                gap: 20px;
            }

            .score-details h2 {
                font-size: 24px;
                margin-bottom: 12px;
            }

            /* Web chart - Mobile */
            .web-chart-container {
                padding: 20px 16px;
            }

            #webChart {
                max-width: 100%;
                height: auto;
            }

            /* Report sections - Mobile */
            .report-section {
                padding: 24px 20px;
                border-radius: 16px;
                margin-bottom: 20px;
            }

            .report-section h2 {
                font-size: 22px;
                margin-bottom: 16px;
            }

            .report-section h3 {
                font-size: 18px;
                margin-top: 20px;
                margin-bottom: 12px;
            }

            .gap-item,
            .strength-item {
                padding: 16px;
                margin-bottom: 12px;
            }

            .gap-priority {
                font-size: 11px;
                padding: 3px 10px;
            }

            /* Sidebar - Mobile */
            .sidebar {
                width: 100%;
                position: relative;
                padding: 20px;
                margin-bottom: 20px;
            }

            .sidebar-content {
                padding: 16px;
            }

            .sidebar h3 {
                font-size: 18px;
                margin-bottom: 12px;
            }

            .element-progress-item {
                padding: 12px;
                font-size: 14px;
            }

            /* Sidebar buttons visible on mobile */

            /* Fix report sections - proper padding and no cutoff */
            .report-section {
                padding: 20px 12px !important;
                margin-left: 0 !important;
                margin-right: 0 !important;
                max-width: 100% !important;
            }

            /* Ensure report content doesn't get cut off */
            #reportSection {
                padding: 0 8px !important;
                max-width: 100% !important;
                overflow-x: hidden !important;
            }

            /* Fix container width on mobile */
            .container {
                max-width: 100% !important;
                overflow-x: hidden !important;
            }

            /* Fix results section - Element Breakdown */
            .score-card {
                flex-direction: column !important;
                width: 100% !important;
                padding: 16px !important;
                gap: 16px !important;
            }

            /* Fix element cards wrapping */
            .score-details {
                width: 100% !important;
                max-width: 100% !important;
            }

            /* Fix gap cards - buttons and content */
            .gap-card {
                padding: 16px 12px !important;
                margin: 0 0 16px 0 !important;
                max-width: 100% !important;
            }

            /* Fix gap card header to prevent overflow */
            .gap-card-header {
                flex-wrap: wrap !important;
                gap: 8px !important;
            }

            /* Fix two-column layouts to stack on mobile */
            .two-column,
            .gap-details {
                flex-direction: column !important;
                gap: 16px !important;
            }

            .column,
            .gap-column {
                width: 100% !important;
                max-width: 100% !important;
                padding: 0 !important;
            }

            /* Fix brown header bar in gaps */
            .gap-header-box,
            [style*="background: #2d2828"] {
                margin: 0 !important;
                border-radius: 12px !important;
                padding: 16px 12px !important;
            }

            /* Fix tooltips/buttons on gap cards */
            .tooltip-btn,
            [style*="border: 2px solid"] {
                font-size: 12px !important;
                padding: 8px 12px !important;
                white-space: nowrap !important;
            }

            /* FIX: Assessment tooltip buttons - 3 info buttons on line 1 (right-justified), Resource on line 2 */
            .info-buttons-row {
                display: flex !important;
                flex-wrap: wrap !important;
                gap: 6px !important;
                width: 100%;
                margin: 4px 0 8px 0 !important;
                justify-content: flex-end !important;
            }

            /* Info buttons (Definitions, Why it matters, VC Perspective) - stay on one line */
            .info-btn {
                font-size: 11px !important;
                padding: 6px 10px !important;
                white-space: nowrap;
                flex: 0 0 auto;
                order: 1;
                height: 32px !important;
                display: inline-flex !important;
                align-items: center !important;
                justify-content: center !important;
            }

            /* Sova Resource button - same width as VC Perspective, aligned under it */
            .info-btn.resource-btn,
            .info-btn[onclick*="Resource"],
            a.info-btn[href] {
                flex: 0 0 auto !important;
                order: 2 !important;
                margin-top: 4px !important;
                height: 32px !important;
                margin-left: auto !important;
            }

            /* FIX: Answer buttons (YES/NO) - same width and aligned */
            .answer-buttons {
                display: flex !important;
                gap: 12px !important;
                margin-bottom: 20px !important;
            }

            .answer-btn {
                flex: 1 !important;
                min-width: 0 !important;
                padding: 14px 16px !important;
                font-size: 14px !important;
            }

            /* FIX: Navigation buttons (Previous, Save & Exit) - brown with green outline */
            .navigation-buttons {
                display: flex !important;
                gap: 12px !important;
            }

            .nav-btn {
                flex: 1 !important;
                min-width: 0 !important;
                padding: 14px 16px !important;
                font-size: 13px !important;
                text-align: center !important;
                background: #2d2828 !important;
                color: #eaffc4 !important;
                border: 2px solid #eaffc4 !important;
            }

            .nav-btn:hover:not(:disabled) {
                background: #3d3838 !important;
            }

            .nav-btn:disabled {
                background: #2d2828 !important;
                opacity: 0.4 !important;
            }

            /* STANDARDIZE ALL SECTION PADDING TO 16PX */
            [style*="background: #2d2828"],
            [style*="background: #f5f5dc"] {
                padding: 40px 16px !important;
            }

            /* All inner containers same margins */
            [style*="max-width: 1200px"],
            [style*="max-width: 1400px"] {
                max-width: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            /* FIX 1 & 2: Element Breakdown heading and tiles - 2 per row */
            #elementGrid {
                grid-template-columns: repeat(2, 1fr) !important;
                gap: 12px !important;
                padding: 0 !important;
            }

            .element-card,
            .score-item {
                width: 100% !important;
                max-width: 100% !important;
                margin: 0 !important;
                padding: 16px 12px !important;
            }

            /* Element Breakdown heading same margin as others */
            #elementGrid + h2,
            [style*="Element Breakdown"] {
                margin: 0 0 24px 0 !important;
            }

            /* FIX 3: Your Startup Health content same margins */
            #statusContent,
            #overallScoreVisual {
                padding: 0 !important;
                margin: 0 !important;
            }

            /* Startup Health grid stacks on mobile */
            [style*="grid-template-columns: 2fr 1fr"] {
                grid-template-columns: 1fr !important;
                gap: 24px !important;
            }

            /* FIX: Your Gaps heading section */
            [style*="Your Gaps"] {
                margin: 0 0 24px 0 !important;
            }

            /* FIX: Areas for Improvement header - stack vertically on mobile */
            .areas-header,
            [style*="justify-content: space-between"][style*="margin-bottom: 40px"] {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 8px !important;
                margin-bottom: 24px !important;
            }

            /* Areas for Improvement title - smaller on mobile */
            .areas-header h2,
            [style*="Areas for Improvement"] {
                font-size: 24px !important;
            }

            /* Hide "Click an element" text on mobile */
            [style*="Click an element"] {
                display: none !important;
            }

            /* FIX 4: Filter by Element - stack label above buttons, buttons scrollable */
            .filter-row {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 8px !important;
            }

            .filter-buttons {
                flex-wrap: nowrap !important;
                overflow-x: auto !important;
                gap: 6px !important;
                width: 100% !important;
                padding-bottom: 4px !important;
                -webkit-overflow-scrolling: touch !important;
            }

            .filter-btn {
                font-size: 11px !important;
                padding: 6px 12px !important;
                white-space: nowrap !important;
                flex-shrink: 0 !important;
            }

            /* FIX 5: Element section header - stack heading and buttons vertically */
            .element-section-header {
                padding: 20px 16px !important;
            }

            .element-header-row {
                flex-direction: column !important;
                align-items: flex-start !important;
                gap: 12px !important;
            }

            .element-header-row h3 {
                font-size: 24px !important;
            }

            .element-tooltip-buttons {
                gap: 6px !important;
                flex-wrap: wrap !important;
            }

            .element-tooltip-buttons .tooltip-trigger {
                font-size: 10px !important;
                padding: 5px 10px !important;
            }

            /* Prelim step indicator - keep on one line */
            .prelim-step-indicator {
                flex-direction: row !important;
                flex-wrap: nowrap !important;
                justify-content: space-between !important;
                align-items: center !important;
                padding: 0 !important;
                width: 100% !important;
            }

            /* Prelim container mobile padding */
            .prelim-container {
                padding: 0 1rem !important;
            }

            .element-title {
                width: 100% !important;
                margin: 0 !important;
            }

            .element-tooltips,
            [style*="display: flex"][style*="gap: 8px"]:not(.prelim-step-indicator):not(.start-fresh-row):not(.validation-info-buttons) {
                width: 100% !important;
                justify-content: flex-start !important;
                flex-wrap: nowrap !important;
                gap: 4px !important;
                margin: 0 !important;
                padding: 0 !important;
            }

            /* Start Fresh row - keep right justified */
            .start-fresh-row {
                justify-content: flex-end !important;
                width: 100% !important;
            }

            /* Validation info buttons - ensure visible on mobile */
            .validation-info-buttons {
                display: flex !important;
                flex-wrap: wrap !important;
                gap: 6px !important;
                justify-content: flex-end !important;
            }

            .validation-info-buttons button {
                flex-shrink: 0 !important;
                font-size: 11px !important;
                padding: 5px 10px !important;
            }

            /* FIX 5: Compress tooltip buttons - same height, one line */
            .element-tooltips button,
            [style*="padding: 8px 16px"][style*="border: 2px solid"] {
                font-size: 9px !important;
                padding: 6px 8px !important;
                height: 28px !important;
                line-height: 1 !important;
                white-space: nowrap !important;
                flex-shrink: 0 !important;
            }

            /* FIX: Report tooltip buttons (Definition, Why it matters, Experts) - fit within margins */
            .tooltip-trigger {
                font-size: 10px !important;
                padding: 4px 8px !important;
                white-space: nowrap !important;
            }

            /* FIX: Report element header tooltip buttons - ONE LINE, smaller text */
            [style*="display: flex"][style*="gap: 12px"][style*="z-index: 1000000"] {
                gap: 4px !important;
                flex-wrap: nowrap !important;
                max-width: 100% !important;
            }

            /* FIX: Make tooltip buttons fit on one line */
            [style*="z-index: 1000000"] .tooltip-trigger {
                font-size: 8px !important;
                padding: 4px 6px !important;
                white-space: nowrap !important;
            }

            /* FIX: Tooltip popovers centered on page and within margins */
            .tooltip-popover {
                left: 50% !important;
                right: auto !important;
                margin-left: 0 !important;
                transform: translateX(-50%) !important;
                width: calc(100vw - 32px) !important;
                max-width: 340px !important;
                min-width: unset !important;
                padding: 16px !important;
            }

            /* Arrow position will be set by JavaScript */

            /* Fix text overflow inside tooltip */
            .tooltip-popover-content {
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                white-space: normal !important;
                max-width: 100% !important;
            }

            .tooltip-popover-content div {
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                white-space: normal !important;
            }

            /* FIX 6: Element heading container same margins as Startup Health */
            .gap-card-header,
            [style*="background: #2d2828"][style*="padding: 24px"] {
                padding: 16px !important;
                margin: 0 !important;
            }

            /* FIX 7: Gap statement containers - more breathing room */
            .gap-item,
            [class*="gap-card"],
            [style*="border-radius: 16px"][style*="margin-bottom: 32px"] {
                padding: 20px !important;
                margin: 0 0 20px 0 !important;
                max-width: 100% !important;
            }

            /* FIX: Gap details - more padding for readability */
            .gap-details {
                padding: 12px 0 !important;
                margin: 0 !important;
            }

            .gap-column {
                width: 100% !important;
                padding: 12px 0 !important;
            }

            /* FIX: Shorten "How to address this" heading on mobile */
            h3:contains("HOW TO ADDRESS THIS"),
            [style*="HOW TO ADDRESS THIS"] {
                font-size: 11px !important;
            }

            /* FIX: Research References - LEFT/RIGHT MARGINS */
            .research-section,
            [style*="RESEARCH REFERENCES"] {
                padding: 16px !important;
                margin: 0 16px 16px 16px !important;
                max-width: calc(100% - 32px) !important;
            }

            .research-item {
                padding: 12px !important;
                margin: 0 0 12px 0 !important;
            }

            .research-quote {
                font-size: 13px !important;
                line-height: 1.5 !important;
                padding: 0 !important;
            }

            /* Fix research content box */
            [style*="border-left: 4px solid #eaffc4"] {
                padding: 12px !important;
                margin: 0 !important;
            }
        }

        /* Small mobile phones (< 480px) */
        @media screen and (max-width: 480px) {
            .container {
                padding: 8px 12px;
            }

            /* Fix pilot phase note on mobile */
            #prelim-page-1 > div:first-child {
                margin-left: 0 !important;
                margin-right: 0 !important;
                max-width: calc(100vw - 24px) !important;
                box-sizing: border-box !important;
            }

            .logo-text {
                font-size: 20px;
                letter-spacing: 0.5px;
            }

            .prelim-section {
                /* Removed container styles */
            }

            .prelim-section h2 {
                font-size: 24px;
                line-height: 1.3;
            }

            .prelim-section p {
                font-size: 15px;
            }

            .question-group {
                padding: 20px 16px;
            }

            .question-label {
                font-size: 16px;
            }

            .radio-option {
                padding: 14px;
            }

            .radio-option label {
                font-size: 14px;
            }

            .btn-primary {
                padding: 16px 24px;
                font-size: 15px;
            }

            /* Fix stage option cards text overflow */
            /* FIX 7: Stage buttons - prevent text overflow */
            .option-card {
                padding: 1rem !important;
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                white-space: normal !important;
            }

            .option-card div {
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                white-space: normal !important;
                max-width: 100% !important;
                font-size: 0.95rem !important;
                line-height: 1.4 !important;
            }

            .option-card div:first-child {
                font-size: 1.1rem !important;
            }

            .model-wrapper {
                padding: 12px 4px;
            }

            /* Increase SVG element labels for mobile readability */
            #sova-model text[font-size="24"] {
                font-size: 32px !important;
            }

            /* Increase stage labels on mobile - but differentiate from descriptions */
            #sova-model text.stage-label {
                font-size: 34px !important;
            }

            #sova-model text.stage-desc {
                font-size: 18px !important;
            }

            /* Make inactive elements more visible on mobile */
            #sova-model text[opacity="0.3"] {
                opacity: 0.6 !important;
            }

            /* Reduce sidebar tab width on mobile */
            #webChartSidebar, #reportSidebar, #actionSidebar {
                width: 45px !important;
                font-size: 11px !important;
            }

            /* FIX: Progress info layout - horizontal with element left, question count right */
            .progress-info {
                display: flex !important;
                flex-direction: row !important;
                justify-content: space-between !important;
                align-items: center !important;
                gap: 8px !important;
                margin-bottom: 8px !important;
            }

            /* Element badge - compact */
            .element-badge {
                font-size: 10px !important;
                padding: 4px 10px !important;
                white-space: nowrap !important;
                letter-spacing: 0.3px !important;
            }

            /* Question progress - right aligned */
            .progress-info #questionProgress {
                font-size: 11px !important;
                opacity: 0.7 !important;
                white-space: nowrap !important;
            }

            /* Progress bar closer to content */
            .progress-bar-container {
                margin-bottom: 12px !important;
                margin-top: 8px !important;
            }

            /* Exit button - on its own line at top right */
            .exit-btn {
                position: relative !important;
                top: 0 !important;
                right: 0 !important;
                margin-left: auto !important;
                margin-bottom: 8px !important;
                display: block !important;
            }

            /* Question container - tighter spacing */
            .question-container {
                padding: 0 !important;
                margin-bottom: 16px !important;
            }

            /* Question text - less margin */
            .question-text {
                font-size: 16px !important;
                margin-bottom: 16px !important;
            }

            /* Questionnaire modal - tighter padding on mobile */
            .questionnaire-container {
                padding: 24px 16px !important;
                border-radius: 16px !important;
            }

            .answer-option {
                padding: 14px 16px;
                font-size: 14px;
            }

            /* FIX 2: Read more / View source parent container alignment */
            [style*="margin-top: 4px"][style*="display: flex"][style*="gap: 12px"] {
                display: flex !important;
                align-items: center !important;
                gap: 12px !important;
                flex-wrap: nowrap !important;
            }

            [style*="margin-top: 4px"][style*="display: flex"] button,
            [style*="margin-top: 4px"][style*="display: flex"] a {
                display: inline-flex !important;
                align-items: center !important;
                white-space: nowrap !important;
            }

            /* FIX 3: Sidebar tabs - prevent overflow and center text */
            #webChartSidebar,
            #reportSidebar,
            #actionSidebar {
                width: 50px !important;
            }

            #webChartSidebar div,
            #reportSidebar div,
            #actionSidebar div {
                writing-mode: vertical-rl !important;
                transform: rotate(180deg) !important;
                font-size: 11px !important;
                letter-spacing: 1.2px !important;
                padding: 8px 0 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                white-space: nowrap !important;
                overflow: visible !important;
                line-height: 1.2 !important;
            }

            /* FIX 4: Tool names - prevent overflow */
            [style*="Recommended Tools"] + div,
            [style*="grid-template-columns"][style*="minmax(200px"] {
                grid-template-columns: 1fr !important;
                gap: 12px !important;
            }

            [style*="Recommended Tools"] + div a,
            [style*="Recommended Tools"] + div div {
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                white-space: normal !important;
                max-width: 100% !important;
                padding: 12px 16px !important;
                font-size: 13px !important;
                line-height: 1.4 !important;
            }

            /* FIX 5 & 6: Removed - conflicted with existing better solution above */

            /* Coming Soon tooltips */
            [style*="COMING SOON"] {
                position: fixed !important;
                left: 50% !important;
                top: 50% !important;
                transform: translate(-50%, -50%) !important;
                max-width: 85vw !important;
                width: auto !important;
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                white-space: normal !important;
                text-align: center !important;
            }

            .results-header h1 {
                font-size: 28px;
            }

            .results-header p {
                font-size: 15px;
            }

            .score-card {
                padding: 20px 16px;
            }

            .score-details h2 {
                font-size: 20px;
            }

            .report-section {
                padding: 20px 16px;
            }

            .report-section h2 {
                font-size: 20px;
            }

            .report-section h3 {
                font-size: 16px;
            }

            /* FIX: Gap card mobile - increase padding and fix overflow */
            .gap-card-wrapper {
                margin-bottom: 24px !important;
            }

            /* Gap card header - more breathing room */
            .gap-card-wrapper > div > div:first-child {
                padding: 20px 16px !important;
            }

            /* Gap card content - proper margins */
            .gap-card-wrapper [id^="gap-content-"] {
                padding: 20px 16px !important;
            }

            /* Research References box - prevent overflow */
            .gap-card-wrapper [style*="border-left: 3px solid #eaffc4"] {
                padding: 12px !important;
                margin-left: 0 !important;
                margin-right: 0 !important;
                max-width: 100% !important;
                box-sizing: border-box !important;
            }

            /* Research reference text - wrap properly */
            .gap-card-wrapper [style*="border-left: 3px solid #eaffc4"] p {
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                max-width: 100% !important;
            }

            /* Tool cards - single column, prevent overflow */
            .gap-card-wrapper [style*="grid-template-columns"] {
                grid-template-columns: 1fr !important;
            }

            .gap-card-wrapper [style*="grid-template-columns"] a,
            .gap-card-wrapper [style*="grid-template-columns"] div {
                max-width: 100% !important;
                box-sizing: border-box !important;
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
            }

            /* FIX: Element header padding - reduce on mobile */
            #gapsContent [style*="padding: 32px 40px"] {
                padding: 16px 12px !important;
            }

            /* FIX: Gaps container border/margin - reduce on mobile */
            #gapsContent [style*="margin-left: 12px"] {
                margin-left: 0 !important;
                padding-left: 8px !important;
                border-left-width: 2px !important;
            }

            /* FIX: Max-width container - full width on mobile */
            #gapsContent [style*="max-width: 1200px"] {
                padding-left: 0 !important;
                padding-right: 0 !important;
                margin-left: 0 !important;
                margin-right: 0 !important;
            }

            /* FIX: Tool cards overflow on mobile */
            #gapsContent [style*="border-left: 4px solid #eaffc4"],
            #gapsContent [style*="border-left: 4px solid #b8d78f"] {
                max-width: 100% !important;
                box-sizing: border-box !important;
                overflow: hidden !important;
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                padding: 12px !important;
                margin-right: 0 !important;
            }

            /* FIX: Tool text inside cards */
            #gapsContent [style*="border-left: 4px solid #eaffc4"] *,
            #gapsContent [style*="border-left: 4px solid #b8d78f"] * {
                max-width: 100% !important;
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
            }

            /* FIX: Gap card wrapper - tighter margins and overflow control */
            .gap-card-wrapper {
                margin-left: 0 !important;
                margin-right: 0 !important;
                max-width: 100% !important;
                overflow: hidden !important;
            }

            /* FIX: Gap card inner container - control overflow */
            .gap-card-wrapper > div {
                max-width: 100% !important;
                overflow: hidden !important;
            }

            /* FIX: Gap card header - reduce padding */
            .gap-card-wrapper div[onclick] {
                padding: 16px 12px !important;
            }

            /* FIX: Stage badge row - keep on same line with chevron */
            .gap-card-wrapper div[onclick] > div:first-child {
                display: flex !important;
                flex-wrap: nowrap !important;
                flex-direction: row !important;
                align-items: center !important;
                justify-content: space-between !important;
                margin-bottom: 12px !important;
                width: 100% !important;
            }

            /* FIX: Stage badge - keep pill container, left edge aligns with question text */
            .gap-card-wrapper div[onclick] > div:first-child > div:first-child {
                font-size: 9px !important;
                padding: 4px 8px !important;
                letter-spacing: 0.8px !important;
                white-space: nowrap !important;
                margin-right: auto !important;
                margin-left: 0 !important;
                flex-shrink: 0 !important;
            }

            /* FIX: Chevron and checkmark container - no changes needed, space-between handles it */

            /* FIX: Gap card content - reduce padding */
            .gap-card-wrapper div[id^="gap-content-"] {
                padding: 16px 12px !important;
                max-width: 100% !important;
                overflow: hidden !important;
                box-sizing: border-box !important;
            }

            /* FIX: Tool grid - single column */
            .gap-card-wrapper div[style*="display: grid"] {
                display: flex !important;
                flex-direction: column !important;
                gap: 8px !important;
                max-width: 100% !important;
            }

            /* FIX: Tool cards - proper sizing and no overflow */
            .gap-card-wrapper div[style*="display: grid"] a,
            .gap-card-wrapper div[style*="display: grid"] > div {
                padding: 12px !important;
                font-size: 13px !important;
                max-width: 100% !important;
                width: 100% !important;
                box-sizing: border-box !important;
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
                overflow: hidden !important;
                white-space: normal !important;
            }

            /* FIX: All content inside gap cards - prevent overflow */
            .gap-card-wrapper p,
            .gap-card-wrapper a,
            .gap-card-wrapper div {
                max-width: 100% !important;
                word-wrap: break-word !important;
                overflow-wrap: break-word !important;
            }
        }

        /* Landscape mobile orientation fixes */
        @media screen and (max-height: 500px) and (orientation: landscape) {
            .prelim-section {
                /* Removed container styles */
            }

            .model-wrapper {
                padding: 12px;
                margin-top: -10px;
            }

            .question-container {
                padding: 20px;
            }
        }

        /* Touch-friendly enhancements for all mobile devices */
        @media (hover: none) and (pointer: coarse) {
            /* Increase touch targets */
            .radio-option,
            .answer-option,
            button,
            .btn-primary,
            .btn-nav,
            .btn-back {
                min-height: 44px;
            }

            /* Disable hover effects on touch devices */
            .radio-option:hover,
            .answer-option:hover,
            .element-dot:hover {
                transform: none;
            }

            /* Better tap feedback */
            .radio-option:active,
            .answer-option:active,
            button:active,
            .btn-primary:active {
                transform: scale(0.98);
                opacity: 0.9;
            }
        }
    </style>
</head>
<body>
    <!-- Anti-copy protection -->
    <script>
    (function(){
        // Disable right-click
        document.addEventListener('contextmenu', function(e) { e.preventDefault(); return false; });

        // Disable keyboard shortcuts for view source/dev tools
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && (e.key === 'u' || e.key === 'U' || e.key === 's' || e.key === 'S')) { e.preventDefault(); return false; }
            if (e.key === 'F12') { e.preventDefault(); return false; }
            if (e.ctrlKey && e.shiftKey && (e.key === 'i' || e.key === 'I' || e.key === 'j' || e.key === 'J' || e.key === 'c' || e.key === 'C')) { e.preventDefault(); return false; }
        });

        // Disable text selection on page (but allow in input fields)
        document.addEventListener('DOMContentLoaded', function() {
            document.body.style.userSelect = 'none';
            document.body.style.webkitUserSelect = 'none';
            // Re-enable for inputs
            document.querySelectorAll('input, textarea').forEach(function(el) {
                el.style.userSelect = 'text';
                el.style.webkitUserSelect = 'text';
            });
        });
    })();
    </script>

    <!-- Header (outside container for full-width border) -->
    <header>
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <a href="index.html" style="display: flex; text-decoration: none;">
                    <img src="sova-logo-main-transparent.png" alt="Sova" style="height: 90px;">
                </a>
            </div>
        </div>
    </header>

    <div class="container">

        <!-- New One-Per-Page Preliminary Flow -->
        <div class="prelim-section" id="prelimFlow" style="min-height: 100vh; display: flex; align-items: flex-start; justify-content: center; padding-top: 1rem;">
            <div class="prelim-container" style="max-width: 800px; width: 100%; padding: 0 1rem; box-sizing: border-box; overflow: hidden;">

                <!-- Page 1: Team Size -->
                <div id="prelim-page-1" class="prelim-page">
                    <!-- Pilot Phase Note -->
                    <div style="border: 2px solid #eaffc4; padding: 1.5rem; margin-bottom: 2rem; background: rgba(234, 255, 196, 0.1); border-radius: 12px; text-align: left; overflow-wrap: break-word; word-wrap: break-word; box-sizing: border-box; max-width: 100%;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <p style="color: #eaffc4; font-size: 14px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.2px; margin: 0;">Pilot phase</p>
                            <button onclick="startFresh()" style="padding: 4px 10px; background: rgba(255, 107, 107, 0.7); color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600; transition: background 0.2s ease;" onmouseover="this.style.background='#ff6b6b'" onmouseout="this.style.background='rgba(255, 107, 107, 0.7)'">Start Fresh</button>
                        </div>
                        <p style="color: #f5f5dc; font-size: 15px; line-height: 1.7; margin: 0;">Sova is currently in pilot and we'd love your help. This version covers 4 core elements: Governance, Purpose, Strategy, and Marketing. The full system will include 9 elements.</p>
                        <p style="color: #f5f5dc; font-size: 15px; line-height: 1.7; margin: 1rem 0 0 0;">Complete the assessment, then <a href="https://forms.office.com/pages/responsepage.aspx?id=DQSIkWdsW0yxEjajBLZtrQAAAAAAAAAAAANAAThFnbJUNDA4WEY1M0I5NUMyMlczTkUzOEIyUFQwTS4u&route=shorturl" target="_blank" style="color: #eaffc4; text-decoration: underline;">share your feedback</a> to help us improve. Use <span style="color: #eaffc4;">Start Fresh</span> to clear your progress and begin again.</p>
                    </div>

                    <!-- Prelim Step Indicator - single line, left and right justified -->
                    <div class="prelim-step-indicator" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; gap: 8px;">
                        <span style="background: rgba(234, 255, 196, 0.15); color: #eaffc4; font-size: 10px; font-weight: 700; padding: 5px 10px; border-radius: 16px; text-transform: uppercase; letter-spacing: 0.5px; white-space: nowrap; flex-shrink: 0;">Getting to know you</span>
                        <span style="color: #b8d78f; font-size: 13px; opacity: 0.7; white-space: nowrap; flex-shrink: 0;">Question 1 of 3</span>
                    </div>

                    <h1 style="color: #eaffc4; font-size: clamp(1.75rem, 4vw, 2.5rem); font-weight: 700; margin-bottom: 1rem; line-height: 1.2;">Are you flying solo or with a team?</h1>
                    <p style="color: #b8d78f; font-size: 1.125rem; margin-bottom: 2rem;">This helps us tailor questions to your situation.</p>

                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <div class="option-card" onclick="selectPrelimOptionAndAdvance('teamSize', 'Solo', this, 2)" style="background: rgba(245, 245, 220, 0.05); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <div style="font-size: 1.25rem; font-weight: 600; color: #f5f5dc; margin-bottom: 0.5rem;">Solo</div>
                            <div style="font-size: 1rem; color: #b8d78f;">Just me for now</div>
                        </div>
                        <div class="option-card" onclick="selectPrelimOptionAndAdvance('teamSize', 'Team', this, 2)" style="background: rgba(245, 245, 220, 0.05); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <div style="font-size: 1.25rem; font-weight: 600; color: #f5f5dc; margin-bottom: 0.5rem;">Team</div>
                            <div style="font-size: 1rem; color: #b8d78f;">2 or more people</div>
                        </div>
                    </div>
                </div>

                <!-- Page 2: Stage Selection -->
                <div id="prelim-page-2" class="prelim-page" style="display: none;">
                    <!-- Prelim Step Indicator - single line, left and right justified -->
                    <div class="prelim-step-indicator" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; gap: 8px;">
                        <span style="background: rgba(234, 255, 196, 0.15); color: #eaffc4; font-size: 10px; font-weight: 700; padding: 5px 10px; border-radius: 16px; text-transform: uppercase; letter-spacing: 0.5px; white-space: nowrap; flex-shrink: 0;">Getting to know you</span>
                        <span style="color: #b8d78f; font-size: 13px; opacity: 0.7; white-space: nowrap; flex-shrink: 0;">Question 2 of 3</span>
                    </div>

                    <h1 style="color: #eaffc4; font-size: clamp(1.75rem, 4vw, 2.5rem); font-weight: 700; margin-bottom: 1rem; line-height: 1.2;">Where are you in your startup journey?</h1>
                    <p style="color: #b8d78f; font-size: 1.125rem; margin-bottom: 2.5rem;">Pick the closest match. You may sit between stages, and that's normal.</p>

                    <div style="display: flex; flex-direction: column; gap: 1rem;">
                        <div class="option-card" onclick="selectStageAndContinue('Discovery', this)" style="background: rgba(245, 245, 220, 0.05); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <div style="font-size: 1.25rem; font-weight: 600; color: #f5f5dc; margin-bottom: 0.5rem;">Discovery</div>
                            <div style="font-size: 1rem; color: #b8d78f;">Still exploring the problem, testing ideas, no paying customers yet</div>
                        </div>
                        <div class="option-card" onclick="selectStageAndContinue('Validation', this)" style="background: rgba(245, 245, 220, 0.05); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <div style="font-size: 1.25rem; font-weight: 600; color: #f5f5dc; margin-bottom: 0.5rem;">Validation</div>
                            <div style="font-size: 1rem; color: #b8d78f;">Have a product and some customers, testing if the model is repeatable</div>
                        </div>
                        <div class="option-card" onclick="selectStageAndContinue('Efficiency', this)" style="background: rgba(245, 245, 220, 0.05); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <div style="font-size: 1.25rem; font-weight: 600; color: #f5f5dc; margin-bottom: 0.5rem;">Efficiency</div>
                            <div style="font-size: 1rem; color: #b8d78f;">Model works, now optimising operations and unit economics</div>
                        </div>
                        <div class="option-card" onclick="selectStageAndContinue('Scale', this)" style="background: rgba(245, 245, 220, 0.05); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <div style="font-size: 1.25rem; font-weight: 600; color: #f5f5dc; margin-bottom: 0.5rem;">Scale</div>
                            <div style="font-size: 1rem; color: #b8d78f;">Proven model, focused on growth, expansion, and building systems</div>
                        </div>
                        <div class="option-card" onclick="selectStageAndContinue('Unsure', this)" style="background: rgba(245, 245, 220, 0.05); padding: 1.5rem; border-radius: 16px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; transition: all 0.3s ease;">
                            <div style="font-size: 1.25rem; font-weight: 600; color: #f5f5dc; margin-bottom: 0.5rem;">Unsure</div>
                            <div style="font-size: 1rem; color: #b8d78f;">Not sure where I fit. Help me figure it out.</div>
                        </div>
                    </div>
                </div>

                <!-- Validation Pages (Dynamic) -->
                <div id="validation-pages-container"></div>

                <!-- Page 4: Choose Your Path -->
                <div id="prelim-page-4" class="prelim-page" style="display: none;">
                    <!-- Prelim Step Indicator - single line, left and right justified -->
                    <div class="prelim-step-indicator" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; gap: 8px;">
                        <span style="background: rgba(234, 255, 196, 0.15); color: #eaffc4; font-size: 10px; font-weight: 700; padding: 5px 10px; border-radius: 16px; text-transform: uppercase; letter-spacing: 0.5px; white-space: nowrap; flex-shrink: 0;">Getting to know you</span>
                        <span style="color: #b8d78f; font-size: 13px; opacity: 0.7; white-space: nowrap; flex-shrink: 0;">Question 3 of 3</span>
                    </div>

                    <h1 style="color: #eaffc4; font-size: clamp(1.75rem, 4vw, 2.5rem); font-weight: 700; margin-bottom: 1rem; line-height: 1.2;">Choose Your Flight Path</h1>
                    <p style="color: #f5f5dc; font-size: clamp(1.125rem, 2vw, 1.375rem); line-height: 1.6; margin-bottom: 1.5rem; font-weight: 300;">
                        You're about to gain clarity on your business foundations across the elements that determine startup success.
                    </p>


                    <!-- Path Options -->
                    <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                        <!-- Path 1: Full Health Check -->
                        <div class="path-card" onclick="selectPathAndContinue('complete')">
                            <span class="path-number">1</span>
                            <h2 class="path-title">Full Health Check</h2>
                            <p class="path-desc">
                                Assess your startup across all 4 elements. Get a complete picture of your business foundations and where to focus.
                            </p>
                            <div class="path-meta">
                                <div class="meta-item">
                                    <span class="meta-label">Time:</span>
                                    <span>15-20 minutes</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">Output:</span>
                                    <span>Full report with action plan</span>
                                </div>
                            </div>
                        </div>

                        <!-- Path 2: Quick Start -->
                        <div class="path-card" onclick="selectPathAndContinue('zoomin')">
                            <span class="path-number">2</span>
                            <h2 class="path-title">Quick Start</h2>
                            <p class="path-desc">
                                Pick one area to focus on first. Great if you're short on time or already know where you need help. You can always complete the others later.
                            </p>
                            <div class="path-meta">
                                <div class="meta-item">
                                    <span class="meta-label">Time:</span>
                                    <span>5-7 minutes</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">Output:</span>
                                    <span>Targeted insights</span>
                                </div>
                            </div>
                        </div>

                        <!-- Path 3: Chatbot - Coming Soon -->
                        <div class="path-card coming-soon">
                            <span class="path-number">3</span>
                            <h2 class="path-title">
                                Chat with Sova
                                <span style="display: block; font-size: 12px; font-weight: 400; opacity: 0.7; margin-top: 4px;">Coming Soon</span>
                            </h2>
                            <p class="path-desc">
                                Have a specific question or issue? Talk it through with Sova and get tailored advice and resources.
                            </p>
                            <div class="path-meta">
                                <div class="meta-item">
                                    <span class="meta-label">Time:</span>
                                    <span>Your pace</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-label">Output:</span>
                                    <span>Conversational support</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Questionnaire Section -->
        <div class="questionnaire-section" id="questionnaireSection">
            <div class="questionnaire-container">
                <!-- Exit Button -->
                <button class="exit-btn" onclick="exitQuestionnaire()" title="Save and exit"></button>

                <!-- Progress Bar -->
                <div class="progress-bar-container">
                    <div class="progress-info">
                        <div class="element-badge" id="elementBadge">Governance</div>
                        <span id="questionProgress">Question 1 of 13</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                </div>

                <!-- Question -->
                <div class="question-container">

                    <!-- Info Buttons Row -->
                    <div class="info-buttons-row" id="infoButtonsRow"></div>

                    <!-- Info Content Sections -->
                    <div id="infoContent"></div>

                    <!-- Question Text -->
                    <div class="question-text" id="questionText">Loading question...</div>
                </div>

                <!-- Answer Buttons -->
                <div class="answer-buttons">
                    <button class="answer-btn" id="answerYes" onclick="selectAnswer(true)">Yes</button>
                    <button class="answer-btn" id="answerNo" onclick="selectAnswer(false)">No</button>
                </div>

                <!-- Navigation -->
                <div class="navigation-buttons">
                    <button class="nav-btn" id="prevBtn" onclick="previousQuestion()" disabled>Previous</button>
                    <button class="nav-btn" id="saveExitBtn" onclick="exitQuestionnaire()">Save & Exit</button>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection">
            <div class="results-container">
                <!-- Results Header -->
                <div class="results-header">
                    <h1 id="resultsTitle">Assessment Results</h1>
                    <p id="resultsSubtitle"></p>
                </div>

                <!-- Score and Stage Progression -->
                <div class="score-card">
                    <div class="score-visual">
                        <svg viewBox="0 0 200 200" width="200" height="200">
                            <circle cx="100" cy="100" r="90" fill="none" stroke="#b8d78f" stroke-width="4" opacity="0.2"/>
                            <circle id="scoreCircle" cx="100" cy="100" r="90" fill="none" stroke="#eaffc4" stroke-width="8"
                                    stroke-dasharray="565" stroke-dashoffset="565"
                                    transform="rotate(-90 100 100)" stroke-linecap="round"/>
                            <text x="100" y="95" text-anchor="middle" font-size="48" font-weight="bold" fill="#eaffc4" id="scorePercent">0%</text>
                            <text x="100" y="120" text-anchor="middle" font-size="16" fill="#f5f5dc" opacity="0.8" id="scoreLabel">Complete</text>
                        </svg>
                    </div>
                    <div class="score-details">
                        <h2 id="scoreHeading">Your Readiness Score</h2>
                        <p id="scoreDescription"></p>
                        <div class="score-breakdown" id="scoreBreakdown"></div>
                    </div>
                </div>

                <!-- Stage Progression Tracker -->
                <div id="stageProgressionTracker"></div>

                <!-- Golden Circle: Why, How, What -->
                <div id="goldenCircleContent"></div>

                <!-- Action Buttons -->
                <div class="results-actions">
                    <button class="btn-primary" onclick="downloadReport()">Download Report (PDF)</button>
                    <button class="btn-secondary" onclick="emailReport()">Email Report</button>
                    <button class="btn-secondary" onclick="backToModel()">Back to Assessment</button>
                </div>
            </div>
        </div>

        <!-- Model Section -->
        <div class="model-section" id="modelSection">
            <!-- Welcome section - orientation for the assessment -->
            <div id="modelIntro" style="max-width: 750px; margin: 0 auto; padding: 2rem 2rem 2.5rem; text-align: center;">
                <h1 id="modelHeading" style="color: #eaffc4; font-size: clamp(2rem, 5vw, 3rem); font-weight: 700; margin-bottom: 2rem; line-height: 1.2;">Welcome to the Sova Assessment</h1>

                <!-- How it works - step by step (Complete mode - guided) -->
                <div id="modelGuidanceComplete" style="background: rgba(234, 255, 196, 0.08); border: 1px solid rgba(234, 255, 196, 0.15); border-radius: 16px; padding: 1.5rem 2rem; text-align: left; display: none;">
                    <p style="color: #eaffc4; font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin: 0 0 1rem 0;">How it works</p>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="color: #eaffc4; font-weight: 700; font-size: 0.9rem; min-width: 20px;">1.</span>
                            <span style="color: #f5f5dc; font-size: 0.95rem; line-height: 1.5; opacity: 0.9;">We'll guide you through all 4 elements, starting with Governance</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="color: #eaffc4; font-weight: 700; font-size: 0.9rem; min-width: 20px;">2.</span>
                            <span style="color: #f5f5dc; font-size: 0.95rem; line-height: 1.5; opacity: 0.9;">Answer 3 to 5 yes/no questions honestly based on where you are today</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="color: #eaffc4; font-weight: 700; font-size: 0.9rem; min-width: 20px;">3.</span>
                            <span style="color: #f5f5dc; font-size: 0.95rem; line-height: 1.5; opacity: 0.9;">After each element, you'll move to the next automatically</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="color: #eaffc4; font-weight: 700; font-size: 0.9rem; min-width: 20px;">4.</span>
                            <span style="color: #f5f5dc; font-size: 0.95rem; line-height: 1.5; opacity: 0.9;">Your results build in real-time on the webchart and report below</span>
                        </div>
                    </div>
                    <p style="color: #b8d78f; font-size: 0.85rem; margin: 1rem 0 0 0; opacity: 0.8; font-style: italic;">Scroll down when you're ready to begin...</p>
                </div>

                <!-- How it works - step by step (Zoom In mode - self-directed) -->
                <div id="modelGuidanceZoom" style="background: rgba(234, 255, 196, 0.08); border: 1px solid rgba(234, 255, 196, 0.15); border-radius: 16px; padding: 1.5rem 2rem; text-align: left; display: none;">
                    <p style="color: #eaffc4; font-size: 0.85rem; font-weight: 600; text-transform: uppercase; letter-spacing: 1px; margin: 0 0 1rem 0;">How it works</p>
                    <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="color: #eaffc4; font-weight: 700; font-size: 0.9rem; min-width: 20px;">1.</span>
                            <span style="color: #f5f5dc; font-size: 0.95rem; line-height: 1.5; opacity: 0.9;">Click a glowing element on the diagram to start</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="color: #eaffc4; font-weight: 700; font-size: 0.9rem; min-width: 20px;">2.</span>
                            <span style="color: #f5f5dc; font-size: 0.95rem; line-height: 1.5; opacity: 0.9;">Answer 3 to 5 yes/no questions honestly based on where you are today</span>
                        </div>
                        <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                            <span style="color: #eaffc4; font-weight: 700; font-size: 0.9rem; min-width: 20px;">3.</span>
                            <span style="color: #f5f5dc; font-size: 0.95rem; line-height: 1.5; opacity: 0.9;">Your results are plotted on the webchart and report below as you go</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="model-wrapper">
                <svg id="sova-model" viewBox="-100 -100 1500 1500" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
                    <!-- Define curved paths for text -->
                    <defs>
                        <!-- Gradients for premium ring styling -->
                        <radialGradient id="discoveryGradient" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#b8d78f;stop-opacity:0.25" />
                            <stop offset="100%" style="stop-color:#b8d78f;stop-opacity:0.08" />
                        </radialGradient>
                        <radialGradient id="validationGradient" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#b8d78f;stop-opacity:0.25" />
                            <stop offset="100%" style="stop-color:#b8d78f;stop-opacity:0.08" />
                        </radialGradient>
                        <radialGradient id="efficiencyGradient" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#b8d78f;stop-opacity:0.25" />
                            <stop offset="100%" style="stop-color:#b8d78f;stop-opacity:0.08" />
                        </radialGradient>
                        <radialGradient id="scaleGradient" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#b8d78f;stop-opacity:0.25" />
                            <stop offset="100%" style="stop-color:#b8d78f;stop-opacity:0.08" />
                        </radialGradient>
                        <radialGradient id="centerGlow" cx="50%" cy="50%">
                            <stop offset="0%" style="stop-color:#eaffc4;stop-opacity:0.4" />
                            <stop offset="100%" style="stop-color:#eaffc4;stop-opacity:0.1" />
                        </radialGradient>

                        <!-- Paths for SCALE text (outermost scoring ring, top arc) - r=400 middle, center (650,650) -->
                        <path id="scalePath" d="M 250,650 A 400,400 0 0,1 1050,650" fill="none"/>
                        <path id="scaleSubPath" d="M 250,695 A 400,400 0 0,1 1050,695" fill="none"/>

                        <!-- Paths for EFFICIENCY text (third ring, top arc) - r=300 middle, center (650,650) -->
                        <path id="efficiencyPath" d="M 350,650 A 300,300 0 0,1 950,650" fill="none"/>
                        <path id="efficiencySubPath" d="M 350,695 A 300,300 0 0,1 950,695" fill="none"/>

                        <!-- Paths for VALIDATION text (second ring, top arc) - r=200 middle, center (650,650) -->
                        <path id="validationPath" d="M 450,650 A 200,200 0 0,1 850,650" fill="none"/>
                        <path id="validationSubPath" d="M 450,695 A 200,200 0 0,1 850,695" fill="none"/>

                        <!-- Paths for DISCOVERY text (innermost ring, top arc) - r=100 middle, center (650,650) -->
                        <path id="discoveryPath" d="M 550,650 A 100,100 0 0,1 750,650" fill="none"/>
                        <path id="discoverySubPath" d="M 550,695 A 100,100 0 0,1 750,695" fill="none"/>
                    </defs>

                    <!-- 4 Scoring Rings with premium styling - center (650,650) -->

                    <!-- Scale (outermost scoring ring: r=350 to r=450) -->
                    <circle cx="650" cy="650" r="450" fill="none" stroke="#b8d78f" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="350" fill="none" stroke="#b8d78f" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="400" fill="url(#scaleGradient)" stroke="none" stroke-width="100"/>

                    <!-- Efficiency (third ring: r=250 to r=350) -->
                    <circle cx="650" cy="650" r="350" fill="none" stroke="#b8d78f" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="250" fill="none" stroke="#b8d78f" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="300" fill="url(#efficiencyGradient)" stroke="none" stroke-width="100"/>

                    <!-- Validation (second ring: r=150 to r=250) -->
                    <circle cx="650" cy="650" r="250" fill="none" stroke="#b8d78f" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="150" fill="none" stroke="#b8d78f" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="200" fill="url(#validationGradient)" stroke="none" stroke-width="100"/>

                    <!-- Discovery (innermost ring: r=50 to r=150) -->
                    <circle cx="650" cy="650" r="150" fill="none" stroke="#b8d78f" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="50" fill="none" stroke="#b8d78f" stroke-width="3" opacity="0.5"/>
                    <circle cx="650" cy="650" r="100" fill="url(#discoveryGradient)" stroke="none" stroke-width="100"/>

                    <!-- Stage Labels - curved along circles (INCREASED SIZE FOR DESKTOP) -->
                    <!-- DISCOVERY -->
                    <text font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#f5f5dc" opacity="0.9" class="stage-label">
                        <textPath href="#discoveryPath" startOffset="50%" text-anchor="middle">DISCOVERY</textPath>
                    </text>
                    <text font-family="Arial, sans-serif" font-size="20" font-style="italic" fill="#b8d78f" opacity="0.8" class="stage-desc">
                        <textPath href="#discoverySubPath" startOffset="50%" text-anchor="middle">Building Foundations</textPath>
                    </text>

                    <!-- VALIDATION -->
                    <text font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#f5f5dc" opacity="0.9" class="stage-label">
                        <textPath href="#validationPath" startOffset="50%" text-anchor="middle">VALIDATION</textPath>
                    </text>
                    <text font-family="Arial, sans-serif" font-size="20" font-style="italic" fill="#b8d78f" opacity="0.8" class="stage-desc">
                        <textPath href="#validationSubPath" startOffset="50%" text-anchor="middle">Proving the Model</textPath>
                    </text>

                    <!-- EFFICIENCY -->
                    <text font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#f5f5dc" opacity="0.9" class="stage-label">
                        <textPath href="#efficiencyPath" startOffset="50%" text-anchor="middle">EFFICIENCY</textPath>
                    </text>
                    <text font-family="Arial, sans-serif" font-size="20" font-style="italic" fill="#b8d78f" opacity="0.8" class="stage-desc">
                        <textPath href="#efficiencySubPath" startOffset="50%" text-anchor="middle">Optimising Systems</textPath>
                    </text>

                    <!-- SCALE -->
                    <text font-family="Arial, sans-serif" font-size="28" font-weight="bold" fill="#f5f5dc" opacity="0.9" class="stage-label">
                        <textPath href="#scalePath" startOffset="50%" text-anchor="middle">SCALE</textPath>
                    </text>
                    <text font-family="Arial, sans-serif" font-size="20" font-style="italic" fill="#b8d78f" opacity="0.8" class="stage-desc">
                        <textPath href="#scaleSubPath" startOffset="50%" text-anchor="middle">Innovation &amp; Growth</textPath>
                    </text>

                    <!-- Web Chart Overlay (Score Visualization) -->
                    <!-- Individual element wedges (filled from center to score) -->
                    <g id="webChartWedges"></g>
                    <!-- Connecting polygon (when 3+ elements completed) -->
                    <polygon id="webChart" points="" fill="rgba(234, 255, 196, 0.25)" stroke="#eaffc4" stroke-width="4" stroke-linejoin="round" style="display: none; filter: drop-shadow(0 0 8px rgba(234, 255, 196, 0.4));"/>

                    <!-- Center Circle - Premium Styling (INCREASED SIZE) -->
                    <g id="sova-center-circle" style="cursor: help;">
                        <circle cx="650" cy="650" r="50" fill="url(#centerGlow)"/>
                        <circle cx="650" cy="650" r="50" fill="#eaffc4" opacity="0.95"/>
                        <text x="650" y="650" font-family="Arial, sans-serif" font-size="28" font-weight="900" fill="#2d2828" text-anchor="middle" dominant-baseline="middle" letter-spacing="-0.5">SOVA</text>
                    </g>

                    <!-- Element Dots on Outer Ring (r=510) with Premium Styling - center (650,650) -->
                    <!-- 9 elements evenly spaced at 40 intervals, starting from 0 (12 o'clock) clockwise -->
                    <!-- Lines start at r=50 (edge of center circle), dots at r=510 -->

                    <!-- GOVERNANCE (0 / 12 o'clock) - ACTIVE (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre (y=180 instead of y=140) -->
                    <line x1="650" y1="600" x2="650" y2="180" stroke="#b8d78f" stroke-width="2.5" opacity="0.7" class="element-spoke"/>
                    <circle cx="650" cy="140" r="24" fill="#b8d78f" class="element-dot active" id="governance-dot" style="cursor: pointer;" onclick="startElementAssessment('Governance')"/>
                    <text x="650" y="108" font-family="Arial, sans-serif" font-size="24" font-weight="800" fill="#eaffc4" text-anchor="middle" letter-spacing="0.5" style="cursor: pointer;" onclick="startElementAssessment('Governance')">GOVERNANCE</text>

                    <!-- PURPOSE (40) - ACTIVE (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre -->
                    <line x1="682" y1="612" x2="951" y2="278" stroke="#b8d78f" stroke-width="2.5" opacity="0.7"/>
                    <circle cx="978" cy="259" r="24" fill="#b8d78f" class="element-dot active" id="purpose-dot" style="cursor: pointer;" onclick="startElementAssessment('Purpose')"/>
                    <text x="1020" y="245" font-family="Arial, sans-serif" font-size="24" font-weight="800" fill="#b8d78f" text-anchor="start" letter-spacing="0.5" style="cursor: pointer;" onclick="startElementAssessment('Purpose')">PURPOSE</text>

                    <!-- STRATEGY (80) - ACTIVE (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre -->
                    <line x1="699" y1="641" x2="1115" y2="568" stroke="#b8d78f" stroke-width="2.5" opacity="0.7"/>
                    <circle cx="1152" cy="561" r="24" fill="#b8d78f" class="element-dot active" id="strategy-dot" style="cursor: pointer;" onclick="startElementAssessment('Strategy')"/>
                    <text x="1188" y="569" font-family="Arial, sans-serif" font-size="24" font-weight="800" fill="#eaffc4" text-anchor="start" letter-spacing="0.5" style="cursor: pointer;" onclick="startElementAssessment('Strategy')">STRATEGY</text>

                    <!-- PERFORMANCE (120) - LOCKED (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre -->
                    <line x1="693" y1="675" x2="1058" y2="882" stroke="#b8d78f" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="1092" cy="905" r="24" fill="#b8d78f" class="element-dot locked" id="performance-dot" opacity="0.4"/>
                    <text x="1133" y="925" font-family="Arial, sans-serif" font-size="24" fill="#f5f5dc" text-anchor="start" opacity="0.3" letter-spacing="0.5">PERFORMANCE</text>

                    <!-- MARKETING (160) - ACTIVE (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre -->
                    <line x1="667" y1="697" x2="811" y2="1091" stroke="#b8d78f" stroke-width="2.5" opacity="0.7"/>
                    <circle cx="824" cy="1129" r="24" fill="#b8d78f" class="element-dot active" id="marketing-dot" style="cursor: pointer;" onclick="startElementAssessment('Marketing')"/>
                    <text x="824" y="1175" font-family="Arial, sans-serif" font-size="24" font-weight="800" fill="#eaffc4" text-anchor="middle" letter-spacing="0.5" style="cursor: pointer;" onclick="startElementAssessment('Marketing')">MARKETING</text>

                    <!-- FINANCE (200) - LOCKED (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre -->
                    <line x1="633" y1="697" x2="489" y2="1091" stroke="#b8d78f" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="476" cy="1129" r="24" fill="#b8d78f" class="element-dot locked" id="finance-dot" opacity="0.4"/>
                    <text x="476" y="1168" font-family="Arial, sans-serif" font-size="24" fill="#f5f5dc" text-anchor="middle" opacity="0.3" letter-spacing="0.5">FINANCE</text>

                    <!-- PEOPLE (240) - LOCKED (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre -->
                    <line x1="607" y1="675" x2="242" y2="882" stroke="#b8d78f" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="208" cy="905" r="24" fill="#b8d78f" class="element-dot locked" id="people-dot" opacity="0.4"/>
                    <text x="167" y="925" font-family="Arial, sans-serif" font-size="24" fill="#f5f5dc" text-anchor="end" opacity="0.3" letter-spacing="0.5">PEOPLE</text>

                    <!-- PROCESS (280) - LOCKED (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre -->
                    <line x1="601" y1="641" x2="185" y2="568" stroke="#b8d78f" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="148" cy="561" r="24" fill="#b8d78f" class="element-dot locked" id="process-dot" opacity="0.4"/>
                    <text x="112" y="569" font-family="Arial, sans-serif" font-size="24" fill="#f5f5dc" text-anchor="end" opacity="0.3" letter-spacing="0.5">PROCESS</text>

                    <!-- TECHNOLOGY (320) - LOCKED (LARGER TEXT, MOVED FURTHER) -->
                    <!-- Line stops 40 units before dot centre -->
                    <line x1="618" y1="612" x2="349" y2="278" stroke="#b8d78f" stroke-width="2.5" opacity="0.3"/>
                    <circle cx="322" cy="259" r="24" fill="#b8d78f" class="element-dot locked" id="technology-dot" opacity="0.4"/>
                    <text x="280" y="245" font-family="Arial, sans-serif" font-size="24" fill="#f5f5dc" text-anchor="end" opacity="0.3" letter-spacing="0.5">TECHNOLOGY</text>
                </svg>

                <!-- Tooltip -->
                <div class="tooltip" id="tooltip">
                    <div class="tooltip-title"></div>
                    <div class="tooltip-desc"></div>
                </div>

            </div>
        </div>

        <!-- Combined Report Section - Visible from start, updates live -->
        <div class="report-section" id="reportSection" style="display: none; margin-top: 120px;">
            <div class="report-container">
                <!-- DASHBOARD LAYOUT - Completely New Approach -->

                <!-- Hero Score Overview -->
                <div style="background: #2d2828; padding: 80px 60px 80px 60px; position: relative; overflow: hidden;">
                    <div style="max-width: 1200px; margin: 0 auto;">
                        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 60px; align-items: center;">
                            <!-- Left: Title + Summary -->
                            <div>
                                <h1 style="color: #eaffc4; font-size: clamp(28px, 5vw, 60px); font-weight: 800; margin: 0 0 24px 0; letter-spacing: -2px; line-height: 1; white-space: nowrap;">Your Startup Health</h1>
                                <div id="statusContent">
                                    <p style="color: #f5f5dc; font-size: 20px; line-height: 1.6; margin: 0; opacity: 0.9;">Your assessment results appear here...</p>
                                </div>
                            </div>

                            <!-- Right: Big Visual Score (to be populated by JS) -->
                            <div id="overallScoreVisual" style="text-align: center;">
                                <!-- Will be populated with large score circle -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 4-Column Element Comparison Grid -->
                <div style="background: #f5f5dc; padding: 60px;">
                    <div style="max-width: 1400px; margin: 0 auto;">
                        <h2 style="color: #2d2828; font-size: 32px; font-weight: 700; margin: 0 0 40px 0; letter-spacing: -1px;">Element Breakdown</h2>

                        <!-- Element Cards Grid -->
                        <div id="elementGrid" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px;">
                            <!-- Will be populated with element cards -->
                        </div>
                    </div>
                </div>

                <!-- Expandable Areas for Improvement Section -->
                <div style="background: #f5f5dc; padding: 60px;">
                    <div style="max-width: 1200px; margin: 0 auto;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px;">
                            <h2 style="color: #2d2828; font-size: 32px; font-weight: 700; margin: 0; letter-spacing: -1px;">Areas for Improvement</h2>
                            <p style="color: #2d2828; opacity: 0.5; margin: 0; font-size: 14px;">Click an element above to filter</p>
                        </div>
                        <div id="gapsContent">
                            <p class="placeholder-text">Your areas for improvement will appear here...</p>
                        </div>
                    </div>
                </div>

                <!-- Sticky Web Chart Sidebar (above Report on right) - Hidden until pictorial shown -->
                <div id="webChartSidebar" style="display: none; position: fixed; right: 0; bottom: 320px; width: 60px; height: 100px; background: #eaffc4; border-radius: 12px 0 0 12px; cursor: pointer; transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); z-index: 1000; box-shadow: -4px 0 12px rgba(0,0,0,0.1); text-align: center; line-height: 100px; border: 2px solid transparent;" onclick="scrollToWebChart()" onmouseover="this.style.width='75px'; this.style.boxShadow='-8px 0 20px rgba(45,40,40,0.3)'; this.style.background='#2d2828'; this.style.borderColor='#eaffc4'; this.querySelector('div').style.color='#eaffc4';" onmouseout="this.style.width='60px'; this.style.boxShadow='-4px 0 12px rgba(0,0,0,0.1)'; this.style.background='#eaffc4'; this.style.borderColor='transparent'; this.querySelector('div').style.color='#2d2828';">
                    <div style="writing-mode: vertical-rl; transform: rotate(180deg); display: inline-block; vertical-align: middle; line-height: normal; color: #2d2828; font-weight: 700; font-size: 14px; letter-spacing: 1px; transition: color 0.3s ease; white-space: nowrap;">WEBCHART</div>
                </div>

                <!-- Sticky Report Sidebar (above Actions on right) - Hidden until pictorial shown -->
                <div id="reportSidebar" style="display: none; position: fixed; right: 0; bottom: 200px; width: 60px; height: 100px; background: #eaffc4; border-radius: 12px 0 0 12px; cursor: pointer; transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); z-index: 1000; box-shadow: -4px 0 12px rgba(0,0,0,0.1); text-align: center; line-height: 100px; border: 2px solid transparent;" onclick="scrollToReport()" onmouseover="this.style.width='75px'; this.style.boxShadow='-8px 0 20px rgba(45,40,40,0.3)'; this.style.background='#2d2828'; this.style.borderColor='#eaffc4'; this.querySelector('div').style.color='#eaffc4';" onmouseout="this.style.width='60px'; this.style.boxShadow='-4px 0 12px rgba(0,0,0,0.1)'; this.style.background='#eaffc4'; this.style.borderColor='transparent'; this.querySelector('div').style.color='#2d2828';">
                    <div style="writing-mode: vertical-rl; transform: rotate(180deg); display: inline-block; vertical-align: middle; line-height: normal; color: #2d2828; font-weight: 700; font-size: 14px; letter-spacing: 1px; transition: color 0.3s ease;">REPORT</div>
                </div>

                <!-- Sticky Action Sidebar (at bottom on right) -->
                <div id="actionSidebar" style="position: fixed; right: 0; bottom: 80px; width: 60px; height: 100px; background: #eaffc4; border-radius: 12px 0 0 12px; cursor: pointer; transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); z-index: 1000; box-shadow: -4px 0 12px rgba(0,0,0,0.1); text-align: center; line-height: 100px; border: 2px solid transparent;" onclick="toggleActionPanel()" onmouseover="this.style.width='75px'; this.style.boxShadow='-8px 0 20px rgba(45,40,40,0.3)'; this.style.background='#2d2828'; this.style.borderColor='#eaffc4'; this.querySelector('div').style.color='#eaffc4';" onmouseout="this.style.width='60px'; this.style.boxShadow='-4px 0 12px rgba(0,0,0,0.1)'; this.style.background='#eaffc4'; this.style.borderColor='transparent'; this.querySelector('div').style.color='#2d2828';">
                    <div style="writing-mode: vertical-rl; transform: rotate(180deg); display: inline-block; vertical-align: middle; line-height: normal; color: #2d2828; font-weight: 700; font-size: 14px; letter-spacing: 1px; transition: color 0.3s ease;">ACTIONS</div>
                </div>

                <!-- Slide-out Action Panel -->
                <div id="actionPanel" style="position: fixed; right: -400px; top: 0; bottom: 0; width: 400px; background: white; box-shadow: -8px 0 24px rgba(0,0,0,0.15); z-index: 999; transition: right 0.4s cubic-bezier(0.23, 1, 0.32, 1); overflow-y: auto;">
                    <div style="background: #2d2828; padding: 32px; position: sticky; top: 0; z-index: 1;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="color: #eaffc4; font-size: 24px; font-weight: 700; margin: 0; letter-spacing: -0.5px;">Priority Actions</h3>
                            <button onclick="toggleActionPanel()" style="background: none; border: none; color: #eaffc4; font-size: 28px; cursor: pointer; padding: 0; line-height: 1;"></button>
                        </div>
                    </div>
                    <div id="todoContent" style="padding: 32px;">
                        <p class="placeholder-text">Your action checklist will appear here...</p>
                    </div>
                </div>

                <script>
                function scrollToWebChart() {
                    const modelSection = document.getElementById('modelSection');
                    if (modelSection) {
                        modelSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }

                function scrollToReport() {
                    const reportSection = document.getElementById('reportSection');
                    if (reportSection) {
                        reportSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                }

                function toggleActionPanel() {
                    const panel = document.getElementById('actionPanel');
                    const sidebar = document.getElementById('actionSidebar');
                    if (panel && sidebar) {
                        if (panel.style.right === '0px') {
                            panel.style.right = '-400px';
                            sidebar.style.right = '0';
                        } else {
                            panel.style.right = '0px';
                            sidebar.style.right = '400px';
                        }
                    }
                }

                // ===================================================================
                // TWO-WAY SYNC: Task Completion Functions (Actions  Report)
                // ===================================================================

                // 1. Complete task from Actions sidebar (simple checkbox)
                function completeTaskFromActions(taskId, isChecked) {
                    if (isChecked) {
                        // Mark as complete without feedback (bypassing thumbs/notes)
                        userData.completedTasks[taskId] = {
                            completed: true,
                            satisfaction: null, // No feedback from Actions
                            notes: '',
                            completedAt: new Date().toISOString(),
                            source: 'actions'
                        };
                    } else {
                        // Uncheck = remove completion
                        delete userData.completedTasks[taskId];
                    }

                    // Save to localStorage
                    localStorage.setItem('sovaUserData', JSON.stringify(userData));

                    // Re-render both Actions and Report
                    updateReportLive();
                }

                // 2. Toggle gap completion form visibility in Report
                function toggleGapCompletion(taskId) {
                    const form = document.getElementById(`gap-completion-${taskId}`);
                    if (form) {
                        const isVisible = form.style.display !== 'none';
                        form.style.display = isVisible ? 'none' : 'block';
                    }
                }

                // 3. Complete gap from Report (with thumbs up/down)
                function completeGap(taskId, satisfaction) {
                    const notesField = document.getElementById(`notes-${taskId}`);
                    const notes = notesField ? notesField.value : '';
                    const completedAt = new Date().toISOString();

                    // Save to userData
                    userData.completedTasks[taskId] = {
                        completed: true,
                        satisfaction: satisfaction,
                        notes: notes,
                        completedAt: completedAt,
                        source: 'report'
                    };

                    // Save to localStorage
                    localStorage.setItem('sovaUserData', JSON.stringify(userData));

                    // Update Actions checkbox
                    const actionCheckbox = document.getElementById(`action-check-${taskId}`);
                    if (actionCheckbox) {
                        actionCheckbox.checked = true;
                    }

                    // Submit feedback to Google Form
                    submitGapFeedback(taskId, satisfaction, notes, completedAt);

                    // Re-render both Actions and Report
                    updateReportLive();
                }

                // Submit gap feedback to Google Form
                function submitGapFeedback(taskId, satisfaction, notes, completedAt) {
                    // Get gap details from taskId (format: task-0, task-1, etc.)
                    const gapIndex = parseInt(taskId.replace('task-', ''));
                    const gapData = window.currentAllGaps ? window.currentAllGaps[gapIndex] : null;

                    if (!gapData) {
                        console.warn('Gap data not found for', taskId);
                        return;
                    }

                    // Get question text
                    const questionText = userData.teamSize === 'Solo'
                        ? (gapData.question.Solo || gapData.question.Team)
                        : (gapData.question.Team || gapData.question.Solo);

                    // Get or create session ID
                    let sessionId = localStorage.getItem('sovaSessionId');
                    if (!sessionId) {
                        sessionId = 'session-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                        localStorage.setItem('sovaSessionId', sessionId);
                    }

                    // Google Form entry IDs
                    const formId = '1FAIpQLSdTOWZGqVoKqIFkO4OHDHESNTPDlua9InbfHPkZYJqQ9el9eg';
                    const entryIds = {
                        sessionId: '692417882',
                        element: '1977777150',
                        stage: '1690374263',
                        question: '1219793943',
                        rating: '2045483238',
                        feedback: '62288543',
                        assessmentMode: '415723265',
                        completedAt: '1029134294'
                    };

                    // Build form data
                    const formData = new URLSearchParams();
                    formData.append(`entry.${entryIds.sessionId}`, sessionId);
                    formData.append(`entry.${entryIds.element}`, gapData.element);
                    formData.append(`entry.${entryIds.stage}`, gapData.stage);
                    formData.append(`entry.${entryIds.question}`, questionText || 'Unknown question');
                    formData.append(`entry.${entryIds.rating}`, satisfaction === 'up' ? 'Helpful' : 'Needs work');
                    formData.append(`entry.${entryIds.feedback}`, notes || '');
                    formData.append(`entry.${entryIds.assessmentMode}`, userData.assessmentMode || 'complete');
                    formData.append(`entry.${entryIds.completedAt}`, completedAt);

                    // Submit via fetch (fire and forget - no CORS issues with Google Forms)
                    fetch(`https://docs.google.com/forms/d/e/${formId}/formResponse`, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded'
                        },
                        body: formData.toString()
                    }).then(() => {
                        console.log('Feedback submitted to Google Form');
                    }).catch(err => {
                        console.warn('Feedback submission failed (may still have succeeded):', err);
                    });
                }

                // Helper: Expand completion input
                function expandCompletion(taskId) {
                    const defaultEl = document.getElementById(`completion-default-${taskId}`);
                    const expandedEl = document.getElementById(`completion-expanded-${taskId}`);
                    if (defaultEl) defaultEl.style.display = 'none';
                    if (expandedEl) expandedEl.style.display = 'block';
                }

                // Helper: Collapse completion input
                function collapseCompletion(taskId) {
                    const defaultEl = document.getElementById(`completion-default-${taskId}`);
                    const expandedEl = document.getElementById(`completion-expanded-${taskId}`);
                    if (defaultEl) defaultEl.style.display = 'flex';
                    if (expandedEl) expandedEl.style.display = 'none';
                    // Reset rating selection
                    const thumbUp = document.getElementById(`thumb-up-${taskId}`);
                    const thumbDown = document.getElementById(`thumb-down-${taskId}`);
                    if (thumbUp) { thumbUp.style.opacity = '0.25'; thumbUp.classList.remove('selected'); }
                    if (thumbDown) { thumbDown.style.opacity = '0.25'; thumbDown.classList.remove('selected'); }
                    // Reset submit button
                    const submitBtn = document.getElementById(`submit-${taskId}`);
                    if (submitBtn) { submitBtn.disabled = true; submitBtn.style.opacity = '0.4'; }
                    // Clear any pending rating
                    if (window.pendingRatings) delete window.pendingRatings[taskId];
                }

                // Helper: Select rating (thumb up/down)
                function selectRating(taskId, rating) {
                    const thumbUp = document.getElementById(`thumb-up-${taskId}`);
                    const thumbDown = document.getElementById(`thumb-down-${taskId}`);
                    const submitBtn = document.getElementById(`submit-${taskId}`);

                    // Reset both
                    if (thumbUp) { thumbUp.style.opacity = '0.25'; thumbUp.classList.remove('selected'); }
                    if (thumbDown) { thumbDown.style.opacity = '0.25'; thumbDown.classList.remove('selected'); }

                    // Highlight selected
                    if (rating === 'up' && thumbUp) {
                        thumbUp.style.opacity = '1';
                        thumbUp.classList.add('selected');
                    } else if (rating === 'down' && thumbDown) {
                        thumbDown.style.opacity = '1';
                        thumbDown.classList.add('selected');
                    }

                    // Enable submit button
                    if (submitBtn) {
                        submitBtn.disabled = false;
                        submitBtn.style.opacity = '1';
                    }

                    // Store rating temporarily
                    if (!window.pendingRatings) window.pendingRatings = {};
                    window.pendingRatings[taskId] = rating;
                }

                // Helper: Submit completion with rating
                function submitCompletion(taskId) {
                    const rating = window.pendingRatings?.[taskId];
                    if (rating) {
                        completeGap(taskId, rating);
                        delete window.pendingRatings[taskId];

                        // Show completed badge in header
                        const badge = document.getElementById(`gap-completed-badge-${taskId}`);
                        if (badge) badge.style.display = 'flex';

                        // Collapse current gap card
                        collapseGapCard(taskId);

                        // Find and expand next uncompleted gap
                        setTimeout(() => {
                            expandNextGap(taskId);
                        }, 300);
                    }
                }

                // Toggle gap card expand/collapse
                function toggleGapCard(taskId) {
                    const content = document.getElementById(`gap-content-${taskId}`);
                    const chevron = document.getElementById(`gap-chevron-${taskId}`);
                    if (!content) return;

                    const isExpanded = content.style.display !== 'none';
                    if (isExpanded) {
                        collapseGapCard(taskId);
                    } else {
                        expandGapCard(taskId);
                    }
                }

                // Expand a gap card with smooth animation
                function expandGapCard(taskId) {
                    const content = document.getElementById(`gap-content-${taskId}`);
                    const chevron = document.getElementById(`gap-chevron-${taskId}`);
                    if (content) {
                        content.style.display = 'block';
                        content.style.opacity = '0';
                        content.style.maxHeight = '0';
                        content.style.overflow = 'hidden';
                        content.style.transition = 'opacity 0.8s ease-out, max-height 1s ease-out';
                        // Trigger reflow then animate
                        requestAnimationFrame(() => {
                            content.style.opacity = '1';
                            content.style.maxHeight = '2000px';
                        });
                    }
                    if (chevron) {
                        chevron.style.transition = 'transform 0.5s ease';
                        chevron.style.transform = 'rotate(180deg)';
                    }
                }

                // Collapse a gap card with smooth animation
                function collapseGapCard(taskId) {
                    const content = document.getElementById(`gap-content-${taskId}`);
                    const chevron = document.getElementById(`gap-chevron-${taskId}`);
                    if (content) {
                        content.style.transition = 'opacity 0.6s ease-out, max-height 0.8s ease-out';
                        content.style.opacity = '0';
                        content.style.maxHeight = '0';
                        content.style.overflow = 'hidden';
                        // Hide after animation completes
                        setTimeout(() => {
                            content.style.display = 'none';
                        }, 800);
                    }
                    if (chevron) {
                        chevron.style.transition = 'transform 0.5s ease';
                        chevron.style.transform = 'rotate(0deg)';
                    }
                }

                // Expand next uncompleted gap after current one
                function expandNextGap(currentTaskId) {
                    const allGapCards = document.querySelectorAll('.gap-card-wrapper');
                    let foundCurrent = false;
                    let nextGapId = null;

                    for (const card of allGapCards) {
                        const cardId = card.id.replace('gap-card-', '');

                        if (foundCurrent) {
                            // Check if this gap is not completed
                            if (!(userData.completedTasks[cardId] && userData.completedTasks[cardId].completed)) {
                                nextGapId = cardId;
                                break;
                            }
                        }

                        if (cardId === currentTaskId) {
                            foundCurrent = true;
                        }
                    }

                    if (nextGapId) {
                        const nextCard = document.getElementById(`gap-card-${nextGapId}`);
                        if (nextCard) {
                            // Step 1: Wait for collapse animation to fully complete
                            setTimeout(() => {
                                // Step 2: Scroll the next gap into view (center it for visibility)
                                nextCard.scrollIntoView({ behavior: 'smooth', block: 'center' });

                                // Step 3: After scroll completes, add highlight effect and expand
                                setTimeout(() => {
                                    // Add a subtle highlight pulse to draw attention
                                    nextCard.style.transition = 'box-shadow 0.8s ease-out, background-color 0.8s ease-out';
                                    nextCard.style.boxShadow = '0 0 0 4px rgba(234, 255, 196, 0.6)';
                                    nextCard.style.backgroundColor = 'rgba(234, 255, 196, 0.1)';

                                    // Expand the gap card after highlight appears
                                    setTimeout(() => {
                                        expandGapCard(nextGapId);
                                    }, 400);

                                    // Step 4: Slowly fade out highlight
                                    setTimeout(() => {
                                        nextCard.style.transition = 'box-shadow 1.5s ease-out, background-color 1.5s ease-out';
                                        nextCard.style.boxShadow = 'none';
                                        nextCard.style.backgroundColor = '';
                                    }, 2000);
                                }, 1000);
                            }, 1000);
                        }
                    }
                }

                // Initialize gap cards - expand first uncompleted, collapse others
                function initializeGapCards() {
                    const allGapCards = document.querySelectorAll('.gap-card-wrapper');
                    let firstUncompletedExpanded = false;

                    for (const card of allGapCards) {
                        const cardId = card.id.replace('gap-card-', '');
                        const isCompleted = userData.completedTasks[cardId] && userData.completedTasks[cardId].completed;

                        if (!isCompleted && !firstUncompletedExpanded) {
                            // Expand first uncompleted gap card
                            expandGapCard(cardId);
                            // Keep completion UI collapsed - user must click "Mark complete" to expand
                            firstUncompletedExpanded = true;
                        } else {
                            // Collapse all others
                            collapseGapCard(cardId);
                        }

                        // Show completed badge if needed
                        if (isCompleted) {
                            const badge = document.getElementById(`gap-completed-badge-${cardId}`);
                            if (badge) badge.style.display = 'flex';
                        }
                    }
                }

                // 4. Uncomplete gap from Report
                function uncompleteGap(taskId) {
                    // Remove from userData
                    delete userData.completedTasks[taskId];

                    // Save to localStorage
                    localStorage.setItem('sovaUserData', JSON.stringify(userData));

                    // Update Actions checkbox
                    const actionCheckbox = document.getElementById(`action-check-${taskId}`);
                    if (actionCheckbox) {
                        actionCheckbox.checked = false;
                    }

                    // Hide completed badge
                    const badge = document.getElementById(`gap-completed-badge-${taskId}`);
                    if (badge) badge.style.display = 'none';

                    // Re-render both Actions and Report
                    updateReportLive();
                }

                // Track currently filtered element for gaps section
                let currentFilterElement = null;

                function filterGapsByElement(elementName) {
                    // Update filter state
                    if (elementName === null || elementName === 'null') {
                        currentFilterElement = null; // Show all
                    } else if (currentFilterElement === elementName) {
                        currentFilterElement = null; // Toggle off if clicking same element
                    } else {
                        currentFilterElement = elementName; // Filter to this element
                    }

                    // Re-render gaps with filter applied
                    updateReportLive();

                    // Scroll to gaps section after re-render
                    setTimeout(() => {
                        const gapsSection = document.getElementById('gapsContent');
                        if (gapsSection && gapsSection.parentElement) {
                            gapsSection.parentElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
                        }
                    }, 100);
                }
                </script>

                <!-- Action Buttons -->
                <div class="report-actions" id="reportActions" style="display: none;">
                    <button class="btn-primary" onclick="downloadPDF()">Download PDF Report</button>
                    <button class="btn-secondary" onclick="emailReport()">Email Report to Me</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Element data
        const elements = {
            'governance-dot': { name: 'Governance', desc: 'Values, controls, ethics, accountability', active: true, questions: 13 },
            'purpose-dot': { name: 'Purpose', desc: 'Vision, mission, why you exist', active: true, questions: 12 },
            'strategy-dot': { name: 'Strategy', desc: 'Plans, priorities, positioning', active: true, questions: 11 },
            'marketing-dot': { name: 'Marketing', desc: 'Customer experience and branding', active: true, questions: 9 },
            'performance-dot': { name: 'Performance', desc: 'KPIs, metrics, data-driven decisions', active: false, questions: 16 },
            'finance-dot': { name: 'Finance', desc: 'Financial management and planning', active: false, questions: 16 },
            'people-dot': { name: 'People', desc: 'Talent, culture, development', active: false, questions: 16 },
            'process-dot': { name: 'Process', desc: 'Processes, workflows, systems', active: false, questions: 14 },
            'technology-dot': { name: 'Technology', desc: 'Digital tools and infrastructure', active: false, questions: 16 }
        };

        // Store user data
        let userData = {
            teamSize: '',
            selectedStage: '',
            location: '',
            aimingForVC: true, // Always show VC considerations
            validationPassed: false,
            assessmentStartStage: '',
            completedTasks: {} // { taskId: { completed: true, satisfaction: 'up'|'down', notes: 'text' } }
        };

        // Validation questions by stage - now loaded from shared config.js
        // This ensures chatbot and assessment-tool use the same data
        const validationQuestions = sovaConfig.validationQuestions;

        // Store preliminary flow state
        let prelimData = {
            teamSize: null,
            stage: null,
            currentPage: 1,
            totalPages: 2, // Will be updated based on validation questions
            validationAnswers: []
        };

        // Start Fresh - Clear all progress
        function startFresh() {
            if (confirm('This will clear all your progress and start fresh. Are you sure?')) {
                // Clear ALL localStorage keys for complete reset
                localStorage.removeItem('sovaMultiElementProgress');
                localStorage.removeItem('sovaUserData');
                localStorage.removeItem('sovaAssessmentProgress');
                localStorage.removeItem('sovaAllResults');
                console.log(' All session data cleared - complete reset');

                // Force hard refresh to bypass cache
                // This ensures the latest JavaScript code is loaded
                window.location.href = window.location.href + '?t=' + new Date().getTime();
            }
        }

        // Navigate between preliminary pages
        function nextPrelimPage(pageNum) {
            // Hide all pages
            document.querySelectorAll('.prelim-page').forEach(p => p.style.display = 'none');

            // Show target page
            const targetPage = document.getElementById(`prelim-page-${pageNum}`);
            if (targetPage) {
                targetPage.style.display = 'block';
            }

            // Update progress (3 main pages + validation pages)
            prelimData.currentPage = pageNum;

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Select option in preliminary flow
        function selectPrelimOption(field, value, element) {
            // Store selection
            prelimData[field] = value;

            // Visual feedback - remove selected class from siblings
            const parent = element.parentElement;
            parent.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selected class to clicked element
            element.classList.add('selected');
        }

        // Select option and auto-advance to next page
        function selectPrelimOptionAndAdvance(field, value, element, nextPage) {
            // Store selection and show visual feedback
            selectPrelimOption(field, value, element);

            // Brief delay to show selection, then advance
            setTimeout(() => {
                nextPrelimPage(nextPage);
            }, 300);
        }

        // Select stage and continue (handles validation flow)
        function selectStageAndContinue(stage, element) {
            // Store selection and show visual feedback
            selectPrelimOption('stage', stage, element);

            // Brief delay to show selection, then continue
            setTimeout(() => {
                if (stage === 'Discovery' || stage === 'Unsure') {
                    // No validation needed, go straight to assessment
                    finalizePrelimAndStart('Discovery');
                } else {
                    // Show validation questions for this stage
                    showValidationFlow(stage);
                }
            }, 300);
        }

        // Check stage and show validation if needed
        function checkStageAndContinue() {
            const stage = prelimData.stage;

            if (stage === 'Discovery' || stage === 'Unsure') {
                // No validation needed, go straight to assessment
                finalizePrelimAndStart('Discovery');
            } else {
                // Show validation questions for this stage
                showValidationFlow(stage);
            }
        }

        // Show validation questions - all on one page with Definition, Why it matters, VC Perspective
        function showValidationFlow(stage) {
            const questions = validationQuestions[stage].questions;
            const heading = validationQuestions[stage].heading;
            const container = document.getElementById('validation-pages-container');

            // Build all questions on one page with info buttons
            let questionsHTML = '';
            questions.forEach((qData, index) => {
                const definition = qData.definition || '';
                const whyMatters = qData.whyMatters || '';
                const vcPerspective = qData.vcPerspective || '';

                // Combine hint into definition
                const fullDefinition = qData.hint ? `${qData.hint}. ${definition}` : definition;

                questionsHTML += `
                    <div class="validation-question-block" data-question-index="${index}" style="margin-bottom: 2.5rem;">
                        <!-- Info buttons row - right justified, above question -->
                        ${(fullDefinition || whyMatters || vcPerspective) ? `
                            <div class="validation-info-buttons" style="display: flex; gap: 8px; margin-bottom: 0.75rem; flex-wrap: wrap; justify-content: flex-end;">
                                ${fullDefinition ? `
                                    <button type="button" onclick="toggleValidationInfo('def-${index}')" style="background: rgba(234, 255, 196, 0.1); border: 1px solid rgba(234, 255, 196, 0.25); border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 600; color: #eaffc4; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgba(234, 255, 196, 0.2)'" onmouseout="this.style.background='rgba(234, 255, 196, 0.1)'">Definition</button>
                                ` : ''}
                                ${whyMatters ? `
                                    <button type="button" onclick="toggleValidationInfo('why-${index}')" style="background: rgba(234, 255, 196, 0.1); border: 1px solid rgba(234, 255, 196, 0.25); border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 600; color: #eaffc4; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgba(234, 255, 196, 0.2)'" onmouseout="this.style.background='rgba(234, 255, 196, 0.1)'">Why it matters</button>
                                ` : ''}
                                ${vcPerspective ? `
                                    <button type="button" onclick="toggleValidationInfo('vc-${index}')" style="background: rgba(234, 255, 196, 0.1); border: 1px solid rgba(234, 255, 196, 0.25); border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 600; color: #eaffc4; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgba(234, 255, 196, 0.2)'" onmouseout="this.style.background='rgba(234, 255, 196, 0.1)'">VC Perspective</button>
                                ` : ''}
                            </div>
                        ` : ''}

                        <h3 style="color: #f5f5dc; font-size: 1.125rem; font-weight: 600; margin-bottom: 1rem; line-height: 1.4;">${qData.q}</h3>

                        <!-- Info content panels (hidden by default) -->
                        ${fullDefinition ? `
                            <div id="val-info-def-${index}" style="display: none; background: rgba(234, 255, 196, 0.08); border-left: 3px solid #eaffc4; padding: 12px 16px; margin-bottom: 1rem; border-radius: 0 8px 8px 0;">
                                <p style="font-size: 13px; color: #f5f5dc; line-height: 1.6; margin: 0;">${fullDefinition}</p>
                            </div>
                        ` : ''}
                        ${whyMatters ? `
                            <div id="val-info-why-${index}" style="display: none; background: rgba(234, 255, 196, 0.08); border-left: 3px solid #eaffc4; padding: 12px 16px; margin-bottom: 1rem; border-radius: 0 8px 8px 0;">
                                <p style="font-size: 13px; color: #f5f5dc; line-height: 1.6; margin: 0;">${whyMatters}</p>
                            </div>
                        ` : ''}
                        ${vcPerspective ? `
                            <div id="val-info-vc-${index}" style="display: none; background: rgba(234, 255, 196, 0.08); border-left: 3px solid #eaffc4; padding: 12px 16px; margin-bottom: 1rem; border-radius: 0 8px 8px 0;">
                                <p style="font-size: 13px; color: #f5f5dc; line-height: 1.6; margin: 0;">${vcPerspective}</p>
                            </div>
                        ` : ''}

                        <div style="display: flex; gap: 0.75rem;">
                            <div class="option-card validation-option" onclick="selectValidationAnswer(${index}, 'Yes', this)" style="background: rgba(245, 245, 220, 0.05); padding: 0.75rem 1.5rem; border-radius: 12px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; flex: 1; text-align: center;">
                                <div style="font-size: 1rem; font-weight: 600; color: #f5f5dc;">Yes</div>
                            </div>
                            <div class="option-card validation-option" onclick="selectValidationAnswer(${index}, 'No', this)" style="background: rgba(245, 245, 220, 0.05); padding: 0.75rem 1.5rem; border-radius: 12px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; flex: 1; text-align: center;">
                                <div style="font-size: 1rem; font-weight: 600; color: #f5f5dc;">No</div>
                            </div>
                            <div class="option-card validation-option" onclick="selectValidationAnswer(${index}, 'Partially', this)" style="background: rgba(245, 245, 220, 0.05); padding: 0.75rem 1.5rem; border-radius: 12px; border: 2px solid rgba(234, 255, 196, 0.1); cursor: pointer; flex: 1; text-align: center;">
                                <div style="font-size: 1rem; font-weight: 600; color: #f5f5dc;">Partially</div>
                            </div>
                        </div>
                    </div>
                `;
            });

            const pageHTML = `
                <div id="prelim-page-3" class="prelim-page" style="display: none;">
                    <h1 style="color: #eaffc4; font-size: clamp(1.75rem, 4vw, 2.5rem); font-weight: 700; margin-bottom: 0.5rem; line-height: 1.2;">${heading}</h1>
                    <p style="color: #b8d78f; font-size: 1rem; margin-bottom: 2rem;">To double check you are ready for ${stage}</p>

                    ${questionsHTML}
                </div>
            `;

            container.innerHTML = pageHTML;

            // Update total pages (2 main pages + 1 validation page)
            prelimData.totalPages = 3;
            prelimData.validationAnswers = new Array(questions.length).fill(null);

            // Show validation page
            nextPrelimPage(3);
        }

        // Select validation answer
        function selectValidationAnswer(questionIndex, answer, element) {
            prelimData.validationAnswers[questionIndex] = answer;

            // Visual feedback - remove selected class from this question's options
            const parent = element.parentElement;
            parent.querySelectorAll('.option-card').forEach(card => {
                card.classList.remove('selected');
            });

            // Add selected class to clicked element
            element.classList.add('selected');

            // Auto-advance when all questions answered
            const allAnswered = prelimData.validationAnswers.every(a => a !== null);
            if (allAnswered) {
                setTimeout(() => {
                    checkValidationResults();
                }, 300);
            } else {
                // Scroll to next unanswered question
                const nextUnansweredIndex = prelimData.validationAnswers.findIndex(a => a === null);
                if (nextUnansweredIndex !== -1) {
                    setTimeout(() => {
                        const nextQuestion = document.querySelector(`.validation-question-block[data-question-index="${nextUnansweredIndex}"]`);
                        if (nextQuestion) {
                            nextQuestion.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 200);
                }
            }
        }

        // Check validation results and recommend stage
        function checkValidationResults() {
            const yesCount = prelimData.validationAnswers.filter(a => a === 'Yes').length;
            const totalQuestions = prelimData.validationAnswers.length;
            const selectedStage = prelimData.stage;
            const previousStage = getPreviousStage(selectedStage);

            // Hide validation page
            document.getElementById('prelim-page-3').style.display = 'none';

            // Determine recommendation
            let recommendedStage;
            let message;
            let buttonText;

            if (yesCount >= Math.ceil(totalQuestions * 0.67)) { // 2/3 or more Yes
                recommendedStage = selectedStage;
                message = `Great! You've completed the ${previousStage} foundations.`;
                buttonText = `Continue with ${selectedStage}`;
            } else {
                recommendedStage = previousStage;
                message = `It looks like you're still building your ${previousStage} foundations.`;
                buttonText = `Start with ${previousStage}`;
            }

            // Create recommendation page
            const recommendationHTML = `
                <div id="prelim-page-recommendation" class="prelim-page" style="display: block;">
                    <h1 style="color: #eaffc4; font-size: clamp(1.75rem, 4vw, 2.5rem); font-weight: 700; margin-bottom: 1rem; line-height: 1.2;">Here's what we recommend</h1>
                    <p style="color: #b8d78f; font-size: 1.25rem; margin-bottom: 3rem;">${message}</p>

                    <div style="display: flex; flex-direction: column; gap: 1rem; margin-bottom: 3rem;">
                        <button onclick="finalizePrelimAndStart('${recommendedStage}')" style="background: #eaffc4; color: #2d2828; padding: 1.5rem 2rem; border-radius: 16px; border: none; font-weight: 600; cursor: pointer; font-size: 1.125rem; text-align: left;">
                            <div style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem;">${buttonText}</div>
                            <div style="font-size: 0.95rem; opacity: 0.8;">Recommended based on your answers</div>
                        </button>
                        ${recommendedStage !== selectedStage ? `
                        <button onclick="finalizePrelimAndStart('${selectedStage}')" style="background: rgba(245, 245, 220, 0.05); color: #f5f5dc; padding: 1.5rem 2rem; border-radius: 16px; border: 2px solid rgba(234, 255, 196, 0.2); cursor: pointer; font-weight: 600; font-size: 1.125rem; text-align: left;">
                            <div style="font-size: 1.25rem; font-weight: 700; margin-bottom: 0.5rem;">Continue with ${selectedStage} anyway</div>
                            <div style="font-size: 0.95rem; opacity: 0.8; color: #b8d78f;">Your original choice</div>
                        </button>
                        ` : ''}
                    </div>

                    <button onclick="nextPrelimPage(3)" style="background: transparent; color: #b8d78f; border: 2px solid #b8d78f; padding: 1rem 2rem; border-radius: 32px; cursor: pointer;">Back to Questions</button>
                </div>
            `;

            document.getElementById('validation-pages-container').innerHTML += recommendationHTML;
        }

        // Get previous stage
        function getPreviousStage(stage) {
            const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
            const index = stages.indexOf(stage);
            return index > 0 ? stages[index - 1] : 'Discovery';
        }

        // Finalize preliminary data and show path selection
        function finalizePrelimAndStart(assessmentStage) {
            // Store user data
            userData.teamSize = prelimData.teamSize;
            userData.selectedStage = prelimData.stage;
            userData.assessmentStartStage = assessmentStage;
            userData.location = 'Not specified';
            userData.aimingForVC = true;

            // Clear old assessment data
            multiElementProgress = {
                elementsCompleted: [],
                elementsRemaining: ['Governance', 'Purpose', 'Strategy', 'Marketing'],
                allComplete: false,
                results: {}
            };
            localStorage.removeItem('sovaMultiElementProgress');

            // Save userData to localStorage
            localStorage.setItem('sovaUserData', JSON.stringify(userData));

            // Show path selection page (page 4)
            nextPrelimPage(4);
        }

        // Go to chatbot page with context
        function goToChatbot() {
            // Build URL with context parameters
            const params = new URLSearchParams();
            params.set('from', 'assessment');
            params.set('stage', prelimData.stage || 'Discovery');
            if (prelimData.teamSize) {
                params.set('team', prelimData.teamSize);
            }

            // Navigate to chatbot
            window.location.href = 'chatbot.html?' + params.toString();
        }

        // Select path and continue to assessment
        function selectPathAndContinue(mode) {
            // Store the chosen mode
            userData.assessmentMode = mode;
            localStorage.setItem('sovaUserData', JSON.stringify(userData));

            // Hide preliminary flow
            document.getElementById('prelimFlow').style.display = 'none';

            // Update intro text on pictorial page
            const headingEl = document.getElementById('modelHeading');
            if (headingEl) {
                headingEl.textContent = "Welcome to the Sova Assessment";
            }

            // Show the pictorial based on mode
            if (mode === 'complete') {
                console.log(' Starting complete assessment with auto-pulse');
                showModel();
            } else if (mode === 'zoomin') {
                console.log(' Starting zoom-in mode - no auto-pulse');
                showModelManual();
            }
        }

        // Update progress bar
        function updatePrelimProgress() {
            const progress = (prelimData.currentPage / prelimData.totalPages) * 100;
            document.getElementById('prelimProgress').style.width = progress + '%';
        }

        // OLD FUNCTIONS - Keep for compatibility but not used
        function continueToValidation() {
            console.log('Continue button clicked');

            // Validate required fields
            const teamSize = document.querySelector('input[name="teamSize"]:checked')?.value;
            const stage = document.querySelector('input[name="stage"]:checked')?.value;
            const location = document.getElementById('location').value || 'Not specified';

            console.log('Form values:', { teamSize, stage, location });

            if (!teamSize) {
                alert('Please select Solo or Team');
                return;
            }
            if (!stage) {
                alert('Please select your stage');
                return;
            }

            // FIXED: Clear old assessment data when starting fresh assessment
            console.log(' Clearing old assessment data...');
            multiElementProgress = {
                elementsCompleted: [],
                elementsRemaining: ['Governance', 'Purpose', 'Strategy', 'Marketing'],
                allComplete: false,
                results: {}
            };
            localStorage.removeItem('sovaMultiElementProgress');
            console.log(' Assessment data cleared');

            // Store data
            userData.teamSize = teamSize;
            userData.selectedStage = stage;
            userData.location = location;
            userData.aimingForVC = true; // Always show VC considerations

            // Hide Step 1
            document.getElementById('step1Section').style.display = 'none';

            // Check if validation needed
            if (stage === 'Discovery' || stage === 'Unsure') {
                // No validation needed, go straight to model
                userData.assessmentStartStage = 'Discovery';
                showModel();
            } else {
                // Show validation questions
                showValidationQuestions(stage);
            }
        }

        // STEP 2: Show validation questions
        function showValidationQuestions(stage) {
            const validationData = validationQuestions[stage];

            // Set heading
            document.getElementById('validationHeading').textContent = validationData.heading;

            // Build validation questions HTML with info buttons (Definition, Why it matters, VC Perspective)
            let questionsHTML = '<div style="display: flex; flex-direction: column; gap: 16px;">';
            validationData.questions.forEach((qData, index) => {
                const question = typeof qData === 'string' ? qData : qData.q;
                const hint = qData.hint || '';
                const definition = qData.definition || '';
                const whyMatters = qData.whyMatters || '';
                const vcPerspective = qData.vcPerspective || '';

                questionsHTML += `
                    <div style="margin-bottom: 8px; padding: 20px; background: white; border-radius: 12px; border: 1px solid rgba(61, 37, 23, 0.1);">
                        <label style="display: block; font-size: 16px; font-weight: 600; color: #2d2828; margin-bottom: 8px; line-height: 1.4;">${question}</label>
                        ${hint ? `<p style="font-size: 13px; color: #2d2828; opacity: 0.6; margin: 0 0 12px 0;">${hint}</p>` : ''}

                        <!-- Info buttons row -->
                        ${(definition || whyMatters || vcPerspective) ? `
                            <div style="display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap;">
                                ${definition ? `
                                    <button type="button" onclick="toggleValidationInfo('def-${index}')" style="background: rgba(61, 37, 23, 0.05); border: 1px solid rgba(61, 37, 23, 0.15); border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 600; color: #2d2828; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgba(61, 37, 23, 0.1)'" onmouseout="this.style.background='rgba(61, 37, 23, 0.05)'">Definition</button>
                                ` : ''}
                                ${whyMatters ? `
                                    <button type="button" onclick="toggleValidationInfo('why-${index}')" style="background: rgba(61, 37, 23, 0.05); border: 1px solid rgba(61, 37, 23, 0.15); border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 600; color: #2d2828; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgba(61, 37, 23, 0.1)'" onmouseout="this.style.background='rgba(61, 37, 23, 0.05)'">Why it matters</button>
                                ` : ''}
                                ${vcPerspective ? `
                                    <button type="button" onclick="toggleValidationInfo('vc-${index}')" style="background: rgba(61, 37, 23, 0.05); border: 1px solid rgba(61, 37, 23, 0.15); border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 600; color: #2d2828; cursor: pointer; transition: all 0.2s;" onmouseover="this.style.background='rgba(61, 37, 23, 0.1)'" onmouseout="this.style.background='rgba(61, 37, 23, 0.05)'">VC Perspective</button>
                                ` : ''}
                            </div>

                            <!-- Info content panels (hidden by default) -->
                            ${definition ? `
                                <div id="val-info-def-${index}" style="display: none; background: rgba(234, 255, 196, 0.15); border-left: 3px solid #b8d78f; padding: 12px 16px; margin-bottom: 12px; border-radius: 0 8px 8px 0;">
                                    <p style="font-size: 13px; color: #2d2828; line-height: 1.6; margin: 0;">${definition}</p>
                                </div>
                            ` : ''}
                            ${whyMatters ? `
                                <div id="val-info-why-${index}" style="display: none; background: rgba(234, 255, 196, 0.15); border-left: 3px solid #b8d78f; padding: 12px 16px; margin-bottom: 12px; border-radius: 0 8px 8px 0;">
                                    <p style="font-size: 13px; color: #2d2828; line-height: 1.6; margin: 0;">${whyMatters}</p>
                                </div>
                            ` : ''}
                            ${vcPerspective ? `
                                <div id="val-info-vc-${index}" style="display: none; background: rgba(234, 255, 196, 0.15); border-left: 3px solid #b8d78f; padding: 12px 16px; margin-bottom: 12px; border-radius: 0 8px 8px 0;">
                                    <p style="font-size: 13px; color: #2d2828; line-height: 1.6; margin: 0;">${vcPerspective}</p>
                                </div>
                            ` : ''}
                        ` : ''}

                        <div style="display: flex; gap: 16px;">
                            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 20px; background: #f5f5dc; border: 2px solid rgba(61, 37, 23, 0.2); border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; color: #2d2828; transition: all 0.2s ease;">
                                <input type="radio" name="val${index}" value="yes" id="val${index}-yes" style="margin: 0;">
                                <span>Yes</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 8px; padding: 10px 20px; background: #f5f5dc; border: 2px solid rgba(61, 37, 23, 0.2); border-radius: 8px; cursor: pointer; font-size: 15px; font-weight: 600; color: #2d2828; transition: all 0.2s ease;">
                                <input type="radio" name="val${index}" value="no" id="val${index}-no" style="margin: 0;">
                                <span>No</span>
                            </label>
                        </div>
                    </div>
                `;
            });
            questionsHTML += '</div>';

            document.getElementById('validationQuestions').innerHTML = questionsHTML;

            // Show check button
            document.getElementById('validationButtons').innerHTML = `
                <button class="btn-primary" onclick="checkValidation()">Check My Stage</button>
            `;

            // Show Step 2
            document.getElementById('step2Section').style.display = 'block';
        }

        // Toggle validation info panels (Definition, Why it matters, VC Perspective)
        function toggleValidationInfo(panelId) {
            const panel = document.getElementById('val-info-' + panelId);
            if (panel) {
                const isVisible = panel.style.display !== 'none';
                // Hide all panels for this question first
                const questionIndex = panelId.split('-')[1];
                ['def', 'why', 'vc'].forEach(type => {
                    const otherPanel = document.getElementById('val-info-' + type + '-' + questionIndex);
                    if (otherPanel) otherPanel.style.display = 'none';
                });
                // Toggle the clicked panel
                panel.style.display = isVisible ? 'none' : 'block';
            }
        }

        // Check validation answers
        function checkValidation() {
            const stage = userData.selectedStage;
            const validationData = validationQuestions[stage];

            // Check all answers
            const answers = [];
            for (let i = 0; i < validationData.questions.length; i++) {
                const answer = document.querySelector(`input[name="val${i}"]:checked`)?.value;
                if (!answer) {
                    alert('Please answer all validation questions');
                    return;
                }
                answers.push(answer);
            }

            // Check if all YES
            const allYes = answers.every(a => a === 'yes');
            userData.validationPassed = allYes;

            const resultDiv = document.getElementById('validationResult');
            const buttonsDiv = document.getElementById('validationButtons');

            if (allYes) {
                // Passed - proceed to selected stage
                resultDiv.innerHTML = `
                    <div style="background: #d4f4dd; border-left: 4px solid #4caf50; padding: 12px; border-radius: 4px;">
                        <strong style="color: #1a5928; font-size: 16px;">Great! Let's assess your ${stage} stage</strong>
                    </div>
                `;
                userData.assessmentStartStage = stage;

                buttonsDiv.innerHTML = `
                    <button class="btn-primary" onclick="window.location.href='choose-path.html'">Continue</button>
                `;
            } else {
                // Failed - recommend previous stage
                const previousStage = (stage === 'Validation') ? 'Discovery' :
                                     (stage === 'Efficiency') ? 'Validation' : 'Efficiency';

                resultDiv.innerHTML = `
                    <div style="background: #ffe08a; border-left: 4px solid #ff9800; padding: 12px; border-radius: 4px; color: #2d2828;">
                        <strong style="font-size: 15px;">We'd recommend starting at ${previousStage} to build foundations first</strong>
                    </div>
                `;

                // Clear parent div styles to prevent flex interference
                buttonsDiv.style.display = 'block';
                buttonsDiv.style.gap = '0';

                buttonsDiv.innerHTML = `
                    <div style="display: flex; flex-direction: column; gap: 12px; width: 100%;">
                        <button class="btn-primary" onclick="startAtStage('${previousStage}')" style="width: 100%; white-space: normal; min-height: 48px; padding: 12px 16px;">Start at ${previousStage}</button>
                        <button class="btn-primary" style="width: 100%; background: white; color: var(--sova-coffee); border: 2px solid var(--sova-coffee); white-space: normal; min-height: 48px; padding: 12px 16px;" onclick="startAtStage('${stage}')">No, I want ${stage} anyway</button>
                    </div>
                `;
            }

            resultDiv.style.display = 'block';
        }

        // Start at specific stage
        function startAtStage(stage) {
            userData.assessmentStartStage = stage;
            userData.overrideStage = (stage !== userData.selectedStage);
            showModel();
        }

        // Show model section with demo animation
        function showModel() {
            // Preliminary flow is already hidden by finalizePrelimAndStart()
            document.getElementById('modelSection').classList.add('active');

            // Show sidebars and report section now that we're on pictorial
            document.getElementById('reportSection').style.display = 'block';
            document.getElementById('webChartSidebar').style.display = 'block';
            document.getElementById('reportSidebar').style.display = 'block';

            // Show Complete mode guidance (hide Zoom mode)
            document.getElementById('modelGuidanceComplete').style.display = 'block';
            document.getElementById('modelGuidanceZoom').style.display = 'none';

            // Store data in localStorage
            localStorage.setItem('sovaUserData', JSON.stringify(userData));

            console.log('User data stored:', userData);

            // Update web chart with any completed assessments
            updateWebChart();

            // Scroll to top of page so user can read guidance
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Load completion status
            loadCompletionStatus();

            // Start demo animation after a longer delay so user can read instructions
            // 3 seconds gives time to read before pulsing starts
            setTimeout(() => {
                startDemoAnimation();
            }, 3000);
        }

        // Show model WITHOUT auto-pulse animation (for Zoom In mode)
        function showModelManual() {
            // Preliminary flow is already hidden by finalizePrelimAndStart()
            document.getElementById('modelSection').classList.add('active');

            // Show sidebars and report section now that we're on pictorial
            document.getElementById('reportSection').style.display = 'block';
            document.getElementById('webChartSidebar').style.display = 'block';
            document.getElementById('reportSidebar').style.display = 'block';

            // Show Zoom mode guidance (hide Complete mode)
            document.getElementById('modelGuidanceComplete').style.display = 'none';
            document.getElementById('modelGuidanceZoom').style.display = 'block';

            // Store data in localStorage
            localStorage.setItem('sovaUserData', JSON.stringify(userData));

            console.log('User data stored (manual mode):', userData);

            // Update web chart with any completed assessments
            updateWebChart();

            // Scroll to top of page
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Load completion status
            loadCompletionStatus();

            // NO auto-pulse animation - user manually selects elements
            console.log(' Manual mode: Ready for user to select elements');
        }

        // Demo animation: glow the next element and gracefully zoom into assessment
        function startDemoAnimation() {
            console.log(' startDemoAnimation() called');
            console.log(' multiElementProgress:', multiElementProgress);

            // Determine which element to start next
            const nextElement = getNextElementToAssess();
            console.log(' Next element to assess:', nextElement);

            if (!nextElement) {
                // All elements complete - no animation needed
                console.log(' All elements complete - no animation');
                return;
            }

            const dotId = nextElement.toLowerCase() + '-dot';
            const dot = document.getElementById(dotId);
            console.log(' Trying to find dot element:', dotId);
            console.log(' Dot found?:', dot ? 'YES' : 'NO');

            if (!dot) {
                console.error(' Dot element not found! ID:', dotId);
                console.log(' All elements with class element-dot:', document.querySelectorAll('.element-dot'));
                return;
            }

            // Scroll to element dot ONLY for Marketing (at bottom of pictorial)
            if (nextElement === 'Marketing') {
                const marketingDot = document.getElementById('marketing-dot');
                if (marketingDot) {
                    // Scroll to center the Marketing dot on the page
                    const dotRect = marketingDot.getBoundingClientRect();
                    const absoluteTop = window.pageYOffset + dotRect.top;
                    const middle = absoluteTop - (window.innerHeight / 2) + (dotRect.height / 2);
                    window.scrollTo({ top: middle, behavior: 'smooth' });
                }
            }

            console.log(' Applying JavaScript-based pulse animation for mobile compatibility...');

            // JavaScript-based animation (CSS animations don't work well on SVG in iOS)
            const originalR = parseFloat(dot.getAttribute('r')) || 24;
            const originalOpacity = parseFloat(dot.getAttribute('opacity')) || 1;
            let pulseCount = 0;
            const maxPulses = 4;

            function pulse() {
                if (pulseCount >= maxPulses) {
                    // Reset and zoom to assessment
                    dot.setAttribute('r', originalR);
                    dot.setAttribute('opacity', originalOpacity);
                    console.log(' Pulse complete! Starting zoom transition...');
                    gracefulZoomToAssessment(nextElement);
                    return;
                }

                // Pulse out (grow bigger and brighter)
                let progress = 0;
                const pulseOut = setInterval(() => {
                    progress += 0.05;
                    if (progress >= 1) {
                        clearInterval(pulseOut);
                        // Start pulse in
                        let progressIn = 0;
                        const pulseIn = setInterval(() => {
                            progressIn += 0.05;
                            if (progressIn >= 1) {
                                clearInterval(pulseIn);
                                pulseCount++;
                                pulse(); // Next pulse
                            } else {
                                const r = originalR + (6 * (1 - progressIn));
                                const opacity = originalOpacity - (0.3 * (1 - progressIn));
                                dot.setAttribute('r', r);
                                dot.setAttribute('opacity', opacity);
                            }
                        }, 30);
                    } else {
                        const r = originalR + (6 * progress);
                        const opacity = originalOpacity - (0.3 * progress);
                        dot.setAttribute('r', r);
                        dot.setAttribute('opacity', opacity);
                    }
                }, 30);
            }

            pulse(); // Start pulsing
        }

        // Graceful Zoom Transition to Assessment
        function gracefulZoomToAssessment(elementName) {
            // Create elegant transition overlay
            const transitionOverlay = document.createElement('div');
            transitionOverlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: radial-gradient(circle at center, rgba(61, 37, 23, 0.8) 0%, rgba(61, 37, 23, 0.95) 100%);
                z-index: 9999;
                opacity: 0;
                transition: opacity 0.6s ease-in-out;
            `;

            document.body.appendChild(transitionOverlay);

            // Fade in overlay
            requestAnimationFrame(() => {
                transitionOverlay.style.opacity = '1';
            });

            // After fade completes, start assessment and fade out
            setTimeout(() => {
                startAssessment(elementName);

                // Fade out overlay
                transitionOverlay.style.opacity = '0';
                setTimeout(() => {
                    transitionOverlay.remove();
                }, 600);
            }, 600);
        }

        // Get Next Element to Assess
        function getNextElementToAssess() {
            const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
            console.log(' Elements completed:', multiElementProgress.elementsCompleted);

            // Find first element not yet completed
            for (let element of elementOrder) {
                if (!multiElementProgress.elementsCompleted.includes(element)) {
                    console.log(' Returning next element:', element);
                    return element;
                }
            }

            console.log(' All elements completed');
            return null; // All complete
        }

        // Auto-start Next Element with elegant transition
        function autoStartNextElement(elementName) {
            console.log(`Auto-starting ${elementName} assessment...`);

            // Show elegant overlay with smooth transitions
            const overlay = document.createElement('div');
            overlay.id = 'elementTransitionOverlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(135deg, rgba(61, 37, 23, 0.95) 0%, rgba(61, 37, 23, 0.98) 100%);
                backdrop-filter: blur(8px);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                opacity: 0;
                animation: smoothFadeIn 0.6s ease-out forwards;
            `;

            // Get element-specific accent colour
            const accentColour = getElementAccentColour(elementName);

            overlay.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #f5f5dc 0%, #ffffff 100%);
                    padding: 48px 56px;
                    border-radius: 24px;
                    max-width: 540px;
                    text-align: center;
                    box-shadow:
                        0 20px 60px rgba(0, 0, 0, 0.3),
                        0 0 0 1px rgba(196, 255, 0, 0.1),
                        inset 0 1px 0 rgba(255, 255, 255, 0.9);
                    transform: scale(0.9) translateY(20px);
                    opacity: 0;
                    animation: smoothZoomIn 0.6s ease-out 0.2s forwards;
                ">
                    <div style="
                        width: 80px;
                        height: 80px;
                        margin: 0 auto 24px;
                        background: linear-gradient(135deg, ${accentColour} 0%, #eaffc4 100%);
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        box-shadow: 0 8px 24px rgba(196, 255, 0, 0.3);
                        animation: gentlePulse 2s ease-in-out infinite;
                    ">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#2d2828" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                    </div>

                    <h2 style="
                        color: #2d2828;
                        font-size: 28px;
                        font-weight: 600;
                        margin-bottom: 12px;
                        letter-spacing: -0.5px;
                    ">Let's assess your ${elementName}</h2>

                    <p style="
                        color: #6b5d52;
                        font-size: 16px;
                        line-height: 1.6;
                        margin-bottom: 32px;
                        opacity: 0.9;
                    ">
                        We'll start with Discovery and advance based on your answers
                    </p>

                    <div style="display: flex; gap: 12px; justify-content: center;">
                        <button
                            onclick="this.closest('#elementTransitionOverlay').remove(); startAssessment('${elementName}');"
                            style="
                                background: linear-gradient(135deg, #eaffc4 0%, #a8d600 100%);
                                color: #2d2828;
                                border: none;
                                padding: 14px 32px;
                                font-size: 16px;
                                font-weight: 600;
                                border-radius: 12px;
                                cursor: pointer;
                                box-shadow: 0 4px 12px rgba(196, 255, 0, 0.3);
                                transition: all 0.3s ease;
                            "
                            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(196, 255, 0, 0.4)';"
                            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 12px rgba(196, 255, 0, 0.3)';"
                        >
                            Start Assessment
                        </button>

                        <button
                            onclick="this.closest('#elementTransitionOverlay').remove();"
                            style="
                                background: white;
                                color: #2d2828;
                                border: 2px solid #e0d9cf;
                                padding: 14px 28px;
                                font-size: 16px;
                                font-weight: 500;
                                border-radius: 12px;
                                cursor: pointer;
                                transition: all 0.3s ease;
                            "
                            onmouseover="this.style.borderColor='#2d2828'; this.style.background='#fafaf8';"
                            onmouseout="this.style.borderColor='#e0d9cf'; this.style.background='white';"
                        >
                            Save & Exit
                        </button>
                    </div>
                </div>
            `;

            document.body.appendChild(overlay);
        }

        // Get element-specific accent colour
        function getElementAccentColour(elementName) {
            const colours = {
                'Governance': '#eaffc4',
                'Purpose': '#b8d78f',
                'Strategy': '#b8d78f',
                'Marketing': '#A8D600'
            };
            return colours[elementName] || '#eaffc4';
        }

        // Tooltip functionality
        const tooltip = document.getElementById('tooltip');

        Object.keys(elements).forEach(dotId => {
            const dot = document.getElementById(dotId);
            const data = elements[dotId];

            dot.addEventListener('mouseenter', (e) => {
                const tooltipTitle = tooltip.querySelector('.tooltip-title');
                const tooltipDesc = tooltip.querySelector('.tooltip-desc');

                tooltipTitle.textContent = data.name;
                if (data.active) {
                    tooltipDesc.textContent = `${data.desc}. Click to start assessment.`;
                } else {
                    tooltipDesc.innerHTML = '<strong>Coming Soon</strong><br>Available after MVP launch';
                }

                const dotRect = dot.getBoundingClientRect();
                const dotCenterX = dotRect.left + dotRect.width / 2;
                const dotBottom = dotRect.bottom;

                // Center tooltip horizontally and position just below the dot
                tooltip.style.left = (dotCenterX - 100) + 'px';
                tooltip.style.top = (dotBottom + 10) + 'px';
                tooltip.classList.add('show');
            });

            dot.addEventListener('mouseleave', () => {
                tooltip.classList.remove('show');
            });

            dot.addEventListener('click', () => {
                if (data.active) {
                    startAssessment(data.name);
                }
                // Removed alert for locked dots - tooltip already shows "Coming Soon"
            });
        });

        // WHY Quotes by Element (from Report - Why tab in Excel) WITH hyperlinks
        // Why it Matters quotes from Report - Why tab (up to 5 quotes per element)
        const whyQuotes = {
            'Governance': {
                quotes: [
                    { text: "Ultimately, governance is how you want to run your business. By investing time in it right at the start of founding your company, you will not only gain a far greater understanding of what it is you want to achieve but you will enable others to believe in and grow with your company.", link: "https://startupsmagazine.co.uk/article-why-good-governance-matters-startups" },
                    { text: "As well as getting governance right from the beginning, you need to maintain it for the future to ensure the culture stays healthy and the business continues to operate efficiently. Maintenance is far easier and less time-consuming than trying to implement good governance when the company is bigger so take heart from future-proofing your business as a start-up and supporting it from day one to enable growth and development into a successful company.", link: "https://startupsmagazine.co.uk/article-why-good-governance-matters-startups" },
                    { text: "Startups can have the best foundational bricks in place; however, without proper startup governance, it is only a matter of time before this structure crumbles.", link: "https://www.dilitrust.com/startup-corporate-governance/" },
                    { text: "Investor confidence is higher in a well goverened company and access to capital, essential for a young startup, is much easier. Strong frameworks also help mitigate risks before they escalate into major crises, lead to smarter decisions and significanly more efficient operations", link: "https://lightbox.vc/new-thinking/detail/why-good-governance-is-critical-for-startup-success" },
                    { text: "A unidirectional approach to success by tracking merely the financial metrics is no longer enough; keeping tabs on start-up governance best practices will help companies set themselves up for long-term success.", link: "https://www.ey.com/en_in/insights/start-ups/how-start-ups-can-enhance-governance-for-growth-and-ethical-alignment" }
                ]
            },
            'Purpose': {
                quotes: [
                    { text: "An effective purpose can have a proven, positive impact on bottom-line performance, but few founders make it a priority to consider their business purpose.", link: "https://www.hsbcinnovationbanking.com/gb/en/resources/purpose-top-priority" },
                    { text: "The research supporting the fact that purpose-driven businesses outperform their purpose-lacking competitors is abundant. According to a study by Havas Media Group that examined over 700 brands worldwide, meaningful brands outperform the stock market by an incredible 120%.", link: "https://orspartners.com/on-startups-creating-a-brand-purpose-worth-remembering/" },
                    { text: "People don't buy and continue to buy their products because they're the most fashionable (sorry Patagonia) or the cheapest. They buy their products because they're voting with their money to support companies that share their values. Integrity is a competitive advantage and communicating your purpose clearly lets people know what values you stand for. If you stand for nothing, don't be surprised when something else comes along and wipes you out.", link: "https://startupsmagazine.co.uk/index.php/article-how-having-clear-purpose-can-help-your-startup-thrive" },
                    { text: "Defining your company's reason for existence at the very outset is crucial. When moving quickly, it's essential to take a step back, reflect on your ultimate objective, and ensure that your foundations are solid. Crafting your vision, mission, and values will help you stay focused, orient resources in the most productive way, and inspire and align your team.", link: "https://medium.com/uncorkcapital/mission-vision-and-values-setting-your-startup-up-for-success-f20568df0ae6" }
                ]
            },
            'Strategy': {
                quotes: [
                    { text: "Startups die in two ways: slowly, then suddenly. And in most cases, it's not for lack of hustle, it's for lack of strategy.", link: "https://www.futureventures.ca/insights/master-strategic-planning-for-startups-a-roadmap-to-success" },
                    { text: "Without a clear strategic vision and a well-defined strategic plan, your efforts can quickly turn into chaos, which can be extremely costly.", link: "https://www.forbes.com/councils/forbestechcouncil/2024/09/24/strategy-vs-chaos-why-startups-always-need-a-strategic-plan/" },
                    { text: "Entrepreneurship is often romanticized as a journey of passion, risk-taking, and relentless hustle. While these traits are undoubtedly significant, one critical element often overlooked in this narrative is strategy. A well-thought-out strategy acts as the backbone of a successful entrepreneurial venture, providing direction, focus, and a roadmap to achieve long-term goals.", link: "https://www.linkedin.com/pulse/importance-strategy-entrepreneurship-chinmay-saraf-hmjff/" },
                    { text: "Startups navigate in an environment of uncertainty and unpredictability, making strategy especially important.", link: "https://www.forbes.com/councils/forbestechcouncil/2024/09/24/strategy-vs-chaos-why-startups-always-need-a-strategic-plan/" }
                ]
            },
            'Marketing': {
                quotes: [
                    { text: "Good marketing results do not just magically happen, they need to be planned and created so if you do not have a strategy in place now is the time to do it. The more thought and time put into a marketing strategy, the more you will gain from it, building opportunities and ultimately business.", link: "https://startupsmagazine.co.uk/article-why-having-marketing-strategy-important-all-startups" },
                    { text: "We all know marketing is essential for all businesses, but it's even more important for startups. Unless people know about your startup and what it offers, they probably won't buy your products or services.", link: "https://www.forbes.com/sites/forbesagencycouncil/2018/05/30/five-essential-marketing-strategies-for-any-startup/" },
                    { text: "Twenty-two percent of startups fail because of marketing problems, emphasising the importance of effective marketing initiatives.", link: "https://stripe.com/au/resources/more/marketing-tactics-for-startups" },
                    { text: "When it comes to early-stage startups, marketing is an absolute must. Without effective marketing, your business may struggle to gain traction and find its place in the market.", link: "https://www.growthmentor.com/blog/marketing-in-early-stage-startups/" }
                ]
            }
        };

        // Questionnaire State
        let currentQuestions = [];
        let currentQuestionIndex = 0;
        let currentElement = '';
        let currentStage = '';  // Track current stage being assessed
        let answers = {};
        let assessmentProgress = JSON.parse(localStorage.getItem('sovaAssessmentProgress')) || {};

        // Load completed tasks from localStorage
        const savedUserData = JSON.parse(localStorage.getItem('sovaUserData'));
        if (savedUserData && savedUserData.completedTasks) {
            userData.completedTasks = savedUserData.completedTasks;
        }

        // Multi-Element Assessment Tracking
        let multiElementProgress = JSON.parse(localStorage.getItem('sovaMultiElementProgress')) || {
            elementsCompleted: [],  // ['Governance', 'Purpose']
            elementsRemaining: ['Governance', 'Purpose', 'Strategy', 'Marketing'],
            allComplete: false,
            results: {}  // Will store per-element results
            // results['Governance'] = {
            //   stagesCompleted: ['Discovery'],
            //   currentStage: 'Validation',
            //   stageFailed: 'Validation',
            //   answers: { 'Discovery': [true, true, true], 'Validation': [true, false] },
            //   score: 67,
            //   questionsAnswered: 6,
            //   questionsYes: 4,
            //   highestStageReached: 'Validation'
            // }
        };

        // Start Assessment - MULTI-ELEMENT VERSION with stage advancement
        function startAssessment(elementName) {
            currentElement = elementName;

            // Initialize element result if doesn't exist
            if (!multiElementProgress.results[elementName]) {
                // Use the stage determined in prelim/validation
                const startingStage = userData.assessmentStartStage || 'Discovery';
                multiElementProgress.results[elementName] = {
                    stagesCompleted: [],
                    currentStage: startingStage,  // Start at stage determined in prelim
                    stageFailed: null,
                    answers: {},
                    score: 0,
                    questionsAnswered: 0,
                    questionsYes: 0,
                    highestStageReached: null
                };
            }

            // Start at current stage (or resume from where they left off)
            const elementResult = multiElementProgress.results[elementName];
            currentStage = elementResult.currentStage || userData.assessmentStartStage || 'Discovery';
            currentQuestionIndex = 0;

            // Initialize answers for this stage if needed
            if (!elementResult.answers[currentStage]) {
                elementResult.answers[currentStage] = [];
            }
            answers = elementResult.answers[currentStage];

            console.log(`Starting ${elementName} at ${currentStage} stage`);

            // Mark as in-progress
            markElementStatus(elementName, 'in-progress');

            // Hide model, report, and sidebars - show questionnaire
            document.getElementById('modelSection').classList.remove('active');
            document.getElementById('reportSection').style.display = 'none';
            document.getElementById('webChartSidebar').style.display = 'none';
            document.getElementById('reportSidebar').style.display = 'none';
            document.getElementById('actionSidebar').style.display = 'none';
            document.getElementById('questionnaireSection').classList.add('active');

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Load questions for this element and current stage
            loadQuestionsForStage();
        }

        // Exit Questionnaire
        function exitQuestionnaire() {
            // Save current progress
            saveMultiElementProgress();

            // Go back to model WITHOUT auto-continuing (user chose to exit)
            document.getElementById('questionnaireSection').classList.remove('active');
            document.getElementById('modelSection').classList.add('active');

            // Show report section and sidebars with current progress
            document.getElementById('reportSection').style.display = 'block';
            document.getElementById('webChartSidebar').style.display = 'block';
            document.getElementById('reportSidebar').style.display = 'block';
            document.getElementById('actionSidebar').style.display = 'block';
            updateReportLive(); // Update report with latest answers
            updateWebChart(); // Update web chart with progress

            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Show custom styled message confirming save
            setTimeout(() => {
                showSovaModal('Progress saved!<br><br>You can continue anytime by clicking on any element.');
            }, 500);
        }

        // Custom Sova-styled modal (replaces basic alert)
        function showSovaModal(message) {
            // Remove any existing modal
            const existingModal = document.getElementById('sovaModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Create modal overlay
            const modal = document.createElement('div');
            modal.id = 'sovaModal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.85);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
            `;

            // Create modal content
            const modalContent = document.createElement('div');
            modalContent.style.cssText = `
                background: #2d2828;
                padding: 18px 14px;
                border-radius: 12px;
                max-width: 280px;
                width: 80%;
                margin: 0 auto;
                text-align: center;
                box-shadow: 0 8px 24px rgba(196, 255, 0, 0.3);
                border: 2px solid #eaffc4;
                box-sizing: border-box;
                overflow: hidden;
            `;

            modalContent.innerHTML = `
                <p style="color: #f5f5dc; font-size: 14px; line-height: 1.5; margin: 0 0 18px 0; padding: 0; word-break: normal; overflow-wrap: anywhere; hyphens: auto; width: 100%; box-sizing: border-box; white-space: normal;">
                    ${message}
                </p>
                <button onclick="document.getElementById('sovaModal').remove()" style="
                    background: #eaffc4;
                    color: #2d2828;
                    border: none;
                    padding: 10px 24px;
                    font-size: 15px;
                    font-weight: 600;
                    border-radius: 8px;
                    cursor: pointer;
                    transition: all 0.2s ease;
                " onmouseover="this.style.background='#2d2828'; this.style.color='#eaffc4'; this.style.border='2px solid #eaffc4';"
                   onmouseout="this.style.background='#eaffc4'; this.style.color='#2d2828'; this.style.border='none';">
                    OK
                </button>
            `;

            modal.appendChild(modalContent);
            document.body.appendChild(modal);

            // Close on click outside
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            });

            // Close on Escape key
            const escapeHandler = (e) => {
                if (e.key === 'Escape') {
                    modal.remove();
                    document.removeEventListener('keydown', escapeHandler);
                }
            };
            document.addEventListener('keydown', escapeHandler);
        }

        // Save Progress
        function saveProgress() {
            assessmentProgress[currentElement] = {
                status: 'in-progress',
                currentQuestion: currentQuestionIndex,
                answers: answers,
                totalQuestions: currentQuestions.length,
                lastSaved: new Date().toISOString()
            };

            localStorage.setItem('sovaAssessmentProgress', JSON.stringify(assessmentProgress));
        }

        // Mark Element Status
        function markElementStatus(elementName, status) {
            const dotId = elementName.toLowerCase() + '-dot';
            const dot = document.getElementById(dotId);

            if (dot) {
                dot.classList.remove('in-progress', 'completed');
                if (status === 'in-progress') {
                    dot.classList.add('in-progress');
                } else if (status === 'completed') {
                    dot.classList.add('completed');
                }
            }

            // Update text label opacity to match
            // Find the text element that comes after this dot (next sibling in SVG)
            const allTexts = document.querySelectorAll('text');
            allTexts.forEach(text => {
                if (text.textContent.trim() === elementName.toUpperCase()) {
                    if (status === 'completed') {
                        text.style.opacity = '1';
                        text.style.fill = '#eaffc4';
                        text.style.fontWeight = '900';
                        text.style.fontSize = '24px';
                        text.style.filter = 'drop-shadow(0 0 4px rgba(196, 255, 0, 0.6))';
                    } else if (status === 'in-progress') {
                        text.style.opacity = '0.9';
                        text.style.fill = '#eaffc4';
                        text.style.fontWeight = '800';
                        text.style.fontSize = '24px';
                        text.style.filter = 'drop-shadow(0 0 2px rgba(196, 255, 0, 0.4))';
                    } else {
                        // Not started - bright lime to stand out from locked elements
                        text.style.opacity = '0.7';
                        text.style.fill = '#eaffc4';
                        text.style.fontWeight = '800';
                        text.style.fontSize = '24px';
                        text.style.filter = 'none';
                    }
                }
            });

            // Note: Status is tracked in multiElementProgress, not assessmentProgress
            // No need to save here as it's saved by saveMultiElementProgress()
        }

        // Load completion status on page load
        function loadCompletionStatus() {
            // Load completion status from multiElementProgress
            multiElementProgress.elementsCompleted.forEach(elementName => {
                markElementStatus(elementName, 'completed');
            });

            // Mark any in-progress elements
            Object.keys(multiElementProgress.results).forEach(elementName => {
                if (!multiElementProgress.elementsCompleted.includes(elementName)) {
                    markElementStatus(elementName, 'in-progress');
                }
            });
        }

        // Load Questions based on element
        function loadQuestions() {
            const isSolo = userData.teamSize === 'Solo';
            const stage = userData.assessmentStartStage;

            console.log('loadQuestions called:', { currentElement, stage, isSolo });

            // Questions by Element and Stage with References (from Self Assessment Structure.xlsx)
            // Loaded from external file: questions-data.js
            const allQuestions = allQuestionsData;

            console.log('allQuestionsData available:', typeof allQuestionsData, Object.keys(allQuestionsData || {}));

            // Get questions for this element and stage
            let questions = allQuestions[currentElement]?.[stage] || [];

            console.log('Questions loaded:', questions.length, 'for', currentElement, stage);

            // Filter out questions based on user type
            if (isSolo) {
                // For solo users, keep only questions with Solo text (check capitalized Excel field)
                questions = questions.filter(q => {
                    const soloText = q.Solo || q.solo;
                    return soloText !== null && soloText !== undefined && soloText !== '' && soloText !== 'NA';
                });
                console.log('After solo filter:', questions.length);
            } else {
                // For team users, keep only questions with Team text (check capitalized Excel field)
                questions = questions.filter(q => {
                    const teamText = q.Team || q.team;
                    return teamText !== null && teamText !== undefined && teamText !== '' && teamText !== 'NA';
                });
                console.log('After team filter:', questions.length);
            }

            currentQuestions = questions;
            console.log('currentQuestions set to:', currentQuestions.length);
            displayQuestion();
        }

        // Load Questions for Current Stage (MULTI-ELEMENT VERSION)
        function loadQuestionsForStage() {
            const isSolo = userData.teamSize === 'Solo';

            console.log('loadQuestionsForStage:', { currentElement, currentStage, isSolo });

            // Get questions for this element and current stage
            const allQuestions = allQuestionsData;
            let questions = allQuestions[currentElement]?.[currentStage] || [];

            console.log(` DEBUG: allQuestionsData.Governance.Efficiency.length =`, allQuestionsData.Governance.Efficiency.length);
            console.log(`Found ${questions.length} questions for ${currentElement} ${currentStage}`);

            // Filter based on Solo vs Team (check both capitalized and lowercase field names)
            // IMPORTANT: Store original index for each question so we can match answers later
            if (isSolo) {
                questions = questions.map((q, originalIndex) => ({...q, _originalIndex: originalIndex}))
                    .filter(q => {
                        const soloText = q.Solo || q.solo;
                        return soloText !== null && soloText !== undefined && soloText !== '' && soloText !== 'NA';
                    });
                console.log('After solo filter:', questions.length);
            } else {
                questions = questions.map((q, originalIndex) => ({...q, _originalIndex: originalIndex}))
                    .filter(q => {
                        const teamText = q.Team || q.team;
                        return teamText !== null && teamText !== undefined && teamText !== '' && teamText !== 'NA';
                    });
                console.log('After team filter:', questions.length);
            }

            currentQuestions = questions;

            if (currentQuestions.length === 0) {
                // No questions for this stage - might be at end
                console.log(`No questions for ${currentElement} at ${currentStage}`);
                checkStageCompletion();
                return;
            }

            // Initialize answers array for this stage if needed
            const elementResult = multiElementProgress.results[currentElement];
            if (!elementResult.answers[currentStage]) {
                elementResult.answers[currentStage] = [];
            }

            answers = elementResult.answers[currentStage];
            currentQuestionIndex = 0;
            displayQuestion();
        }

        // Display Current Question
        function displayQuestion() {
            const question = currentQuestions[currentQuestionIndex];
            const isSolo = userData.teamSize === 'Solo';

            // Update progress
            document.getElementById('questionProgress').textContent =
                `Question ${currentQuestionIndex + 1} of ${currentQuestions.length}`;
            // Shorter badge text on mobile
            const isMobileView = window.innerWidth <= 768;
            document.getElementById('elementBadge').textContent = isMobileView
                ? `${currentElement}  ${currentStage}`
                : `${currentElement} at ${currentStage} Stage`;

            const progressPercent = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progressPercent + '%';

            // Display question text with proper pronouns for team (check capitalized field names)
            let questionText = isSolo ? (question.Solo || question.solo) : (question.Team || question.team);

            // FIXED: Convert I/my/me/mine to we/our/us/ours for team users
            if (!isSolo && questionText) {
                questionText = questionText
                    .replace(/\bI\/We\b/g, 'We')
                    .replace(/\bI\s/g, 'We ')
                    .replace(/\bI'm\b/g, 'We\'re')
                    .replace(/\bI've\b/g, 'We\'ve')
                    .replace(/\bI'd\b/g, 'We\'d')
                    .replace(/\bI'll\b/g, 'We\'ll')
                    .replace(/\bI,\b/g, 'We,')
                    .replace(/\bmy\b/gi, 'our')
                    .replace(/\bmine\b/gi, 'ours')
                    .replace(/\bme\b/gi, 'us')
                    .replace(/\bmyself\b/gi, 'ourselves')
                    .replace(/\bMy\b/g, 'Our');
            }

            document.getElementById('questionText').textContent = questionText;

            // Display info buttons and content
            // Pass full question object so formatReferences can access quote fields
            displayInfoButtons(question);

            // Load saved answer if exists
            const savedAnswer = answers[currentQuestionIndex];
            updateAnswerButtons(savedAnswer);

            // Update navigation buttons
            document.getElementById('prevBtn').disabled = (currentQuestionIndex === 0);
        }

        // Display Info Buttons
        function displayInfoButtons(references) {
            const buttonsContainer = document.getElementById('infoButtonsRow');
            const contentContainer = document.getElementById('infoContent');

            // Clear previous content
            buttonsContainer.innerHTML = '';
            contentContainer.innerHTML = '';

            if (!references) return;

            const isVC = userData.aimingForVC;

            // Define button configurations (removed tools, advice, book, quotes - quotes for report only)
            // Resource button goes on separate line
            const buttonConfigs = [
                { key: 'keyTerms', label: 'Definitions' },
                { key: 'articles', label: 'Why it matters' },
                { key: 'vcMapping', label: 'VC Perspective', showIf: isVC }
            ];

            const resourceConfig = { key: 'resources', label: 'Sova Resource', isLink: true };

            // Create buttons and content sections for available data
            buttonConfigs.forEach(config => {
                if (config.showIf === false) return;

                // Map config keys to actual Excel column names
                const fieldMap = {
                    'keyTerms': 'Key Terms Defined',
                    'articles': 'Article References',
                    'vcMapping': 'VC requirements mapping',
                    'resources': 'Resources'
                };

                const excelFieldName = fieldMap[config.key];
                const data = references[excelFieldName] || references[config.key];

                // Special handling for Resources
                if (config.isLink) {
                    const linkFieldName = excelFieldName + 'Link';
                    const hasLink = references[linkFieldName] || references[config.key + 'Link'];

                    if (hasLink) {
                        // Create clickable link if URL exists
                        const link = document.createElement('a');
                        link.className = 'info-btn';
                        link.textContent = config.label;
                        link.href = references[linkFieldName] || references[config.key + 'Link'];
                        link.target = '_blank';
                        link.style.textDecoration = 'none';
                        link.style.display = 'inline-block';
                        buttonsContainer.appendChild(link);
                        return;
                    } else if (data) {
                        // Create "Coming Soon" button if data exists but no link
                        const button = document.createElement('button');
                        button.className = 'info-btn';
                        button.textContent = config.label;
                        button.dataset.infoKey = config.key;
                        button.onclick = () => toggleInfo(config.key);
                        buttonsContainer.appendChild(button);

                        // Create Coming Soon content
                        const contentDiv = document.createElement('div');
                        contentDiv.className = 'info-content';
                        contentDiv.id = `info-${config.key}`;
                        contentDiv.innerHTML = `<h4>${config.label}</h4><p>Coming Soon</p>`;
                        contentContainer.appendChild(contentDiv);
                        return;
                    } else {
                        // No data at all, skip this button
                        return;
                    }
                }

                if (!data) return;

                // Create button for toggle content
                const button = document.createElement('button');
                button.className = 'info-btn';
                button.textContent = config.label;
                button.dataset.infoKey = config.key; // Add data attribute for easier lookup
                button.onclick = () => toggleInfo(config.key);
                buttonsContainer.appendChild(button);

                // Create content section
                const contentDiv = document.createElement('div');
                contentDiv.className = 'info-content';
                contentDiv.id = `info-${config.key}`;

                let contentHTML = `<h4>${config.label}</h4>`;

                // Special handling for VC content - rewrite for beginners
                if (config.key === 'vcMapping') {
                    const simplified = simplifyVCContent(data);
                    const vcLink = references['VC requirements mappingLink'] || '';
                    contentHTML += `<p>${simplified}</p>`;
                    if (vcLink) {
                        contentHTML += `<a href="${vcLink}" target="_blank" class="source-link" style="margin-top: 8px; display: inline-flex;">View Source</a>`;
                    }
                }
                // References - now shows quotes with "View Source" link
                else if (config.key === 'articles') {
                    contentHTML += formatReferences(references);
                }
                // Regular content (definitions)
                else {
                    contentHTML += `<p>${data}</p>`;
                }

                contentDiv.innerHTML = contentHTML;
                contentContainer.appendChild(contentDiv);
            });

            // Handle Resource button - same row as other buttons
            const resourceData = references['Resources'];
            const resourceLink = references['ResourcesLink'];

            if (resourceLink) {
                // Create button - exactly like other buttons but with green outline and opens link
                const button = document.createElement('button');
                button.className = 'info-btn resource-btn';
                button.textContent = 'Sova Resource';
                button.style.border = '2px solid #eaffc4';
                button.onclick = () => {
                    window.open(resourceLink, '_blank');
                };
                buttonsContainer.appendChild(button);
            }
        }

        // Simplify and expand VC content for clarity
        function simplifyVCContent(vcText) {
            let simplified = vcText;

            // Expand acronyms and add context
            simplified = simplified.replace(/\bTAM\b/g, 'Total Addressable Market (TAM)');
            simplified = simplified.replace(/\bSAM\b/g, 'Serviceable Available Market (SAM)');
            simplified = simplified.replace(/\bICP\b/g, 'Ideal Customer Profile (ICP)');
            simplified = simplified.replace(/\bABN\b/g, 'Australian Business Number (ABN)');
            simplified = simplified.replace(/\bACN\b/g, 'Australian Company Number (ACN)');
            simplified = simplified.replace(/\bIP\b/g, 'Intellectual Property (IP)');

            // Replace shorthand with explanatory phrases
            simplified = simplified.replace(/VC Criteria:\s*/gi, 'If you\'re seeking investment, investors typically evaluate: ');
            simplified = simplified.replace(/VCs check:\s*/gi, 'When reviewing your business, investors will want to see: ');
            simplified = simplified.replace(/VCs assess:\s*/gi, 'Investors will evaluate: ');
            simplified = simplified.replace(/Red flags:\s*/gi, 'Warning signs that concern investors: ');
            simplified = simplified.replace(/Benchmark:\s*/gi, 'What successful funded startups typically have: ');

            // Add context to weights
            simplified = simplified.replace(/\((\d+)% weight\)/gi, (match, percent) => {
                return `(this is ${percent}% of their investment decision)`;
            });

            // Expand equity vesting terms
            simplified = simplified.replace(/4-year.*?cliff/gi, 'founders earn their ownership over 4 years, with nothing earned in the first year');
            simplified = simplified.replace(/vesting/gi, 'earning ownership over time');

            // Make "no X" statements more conversational
            simplified = simplified.replace(/No market sising/gi, 'You haven\'t calculated your market size');
            simplified = simplified.replace(/No written agreement/gi, 'You don\'t have written agreements');
            simplified = simplified.replace(/No legal structure/gi, 'Your business isn\'t formally registered');
            simplified = simplified.replace(/No differentiation/gi, 'You can\'t explain what makes you different');

            // Add explanatory context to technical terms
            if (simplified.includes('Total Addressable Market')) {
                simplified = simplified.replace(/Total Addressable Market \(TAM\) >\$1B/gi,
                    'Total Addressable Market (the maximum possible revenue) should be over $1 billion');
            }

            return simplified;
        }

        // Format references with actual article hyperlinks
        function formatReferences(question) {
            // Displays ONLY the first startup failure quote from Excel column P "Quote (startup failure)"
            let html = '';

            // First startup failure quote only
            if (question['Quote (startup failure)']) {
                html += `
                    <p style="color: #2d2828; font-size: 14px; line-height: 1.7; margin: 0 0 10px 0;">${question['Quote (startup failure)'].replace(/^[""]|[""]$/g, '')}</p>
                    ${question['Quote (startup failure)Link'] ? `<a href="${question['Quote (startup failure)Link']}" target="_blank" class="source-link" style="margin-top: 8px; display: inline-flex;">View Source</a>` : ''}
                `;
            }

            // If no quotes, return a friendly message explaining the context
            if (!html) {
                html = '<p style="color: #2d2828; font-size: 12px; opacity: 0.6; font-style: italic;">Research insights for this question are being compiled.</p>';
            }

            return html;
        }

        // Toggle Info Content
        function toggleInfo(key) {
            const contentDiv = document.getElementById(`info-${key}`);
            if (!contentDiv) {
                console.error(`Content div not found for key: ${key}`);
                return;
            }

            const buttons = document.querySelectorAll('.info-btn');
            const button = Array.from(buttons).find(btn => btn.dataset.infoKey === key);

            // Close all other sections
            document.querySelectorAll('.info-content').forEach(div => {
                if (div.id !== `info-${key}`) {
                    div.classList.remove('active');
                }
            });
            buttons.forEach(btn => {
                if (btn !== button && btn.dataset.infoKey) {
                    btn.classList.remove('active');
                }
            });

            // Toggle current section
            const isActive = contentDiv.classList.toggle('active');
            if (button) {
                if (isActive) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            }
        }

        // Select Answer and auto-advance (MULTI-ELEMENT VERSION)
        function selectAnswer(answer) {
            console.log(' selectAnswer called with:', answer);
            console.log('Current question index:', currentQuestionIndex);
            console.log('Total questions:', currentQuestions.length);

            answers[currentQuestionIndex] = answer;
            updateAnswerButtons(answer);

            // Save to multi-element progress
            multiElementProgress.results[currentElement].answers[currentStage][currentQuestionIndex] = answer;
            saveMultiElementProgress();

            // Update web chart and report LIVE after every answer
            updateWebChart();
            updateReportLive();

            // Auto-advance after a brief delay (500ms) to let user see their selection
            console.log(' Setting timeout to advance...');
            setTimeout(() => {
                console.log(' Timeout fired!');
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    // Move to next question
                    console.log(' Moving to next question');
                    currentQuestionIndex++;
                    displayQuestion();

                    // Smooth scroll to question text after advancing (slight delay for DOM update)
                    setTimeout(() => {
                        const questionText = document.getElementById('questionText');
                        if (questionText) {
                            questionText.scrollIntoView({ behavior: 'smooth', block: 'center' });
                        }
                    }, 100);
                } else {
                    // Completed all questions in this stage - check for advancement
                    console.log(' Stage complete, checking advancement');
                    checkStageCompletion();
                }
            }, 500);
        }

        // Update Answer Button Styles
        function updateAnswerButtons(answer) {
            const yesBtn = document.getElementById('answerYes');
            const noBtn = document.getElementById('answerNo');

            // Only highlight if answer is explicitly true or false (not undefined/null)
            if (answer === true) {
                yesBtn.classList.add('selected');
                noBtn.classList.remove('selected');
            } else if (answer === false) {
                yesBtn.classList.remove('selected');
                noBtn.classList.add('selected');
            } else {
                // No answer yet - remove both selections
                yesBtn.classList.remove('selected');
                noBtn.classList.remove('selected');
            }
        }

        // Previous Question
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        // Complete Assessment
        function completeAssessment() {
            // Calculate score
            const yesCount = Object.values(answers).filter(a => a === true).length;
            const totalQuestions = currentQuestions.length;
            const scorePercent = Math.round((yesCount / totalQuestions) * 100);

            // Store results
            const assessmentResults = {
                element: currentElement,
                stage: userData.assessmentStartStage,
                answers: answers,
                score: scorePercent,
                yesCount: yesCount,
                totalQuestions: totalQuestions,
                completedAt: new Date().toISOString()
            };

            // Get existing results or create new array
            let allResults = JSON.parse(localStorage.getItem('sovaAllResults') || '[]');

            // Remove previous result for this element if exists
            allResults = allResults.filter(r => r.element !== currentElement);

            // Add new result
            allResults.push(assessmentResults);

            // Save all results
            localStorage.setItem('sovaAllResults', JSON.stringify(allResults));

            // Mark as completed
            markElementStatus(currentElement, 'completed');

            // Show results page
            showResults(assessmentResults);

            // Pulse the next element (for when they return to model)
            pulseNextElement();
        }

        // ========== MULTI-ELEMENT FLOW FUNCTIONS ==========

        // Check Stage Completion - Advance or Stop
        function checkStageCompletion() {
            const elementResult = multiElementProgress.results[currentElement];
            const stageAnswers = elementResult.answers[currentStage];

            // Check if ALL answers are YES (true)
            const allYes = stageAnswers.every(answer => answer === true);

            // Check if ALL answers are NO (false)
            const allNo = stageAnswers.every(answer => answer === false);

            console.log(`Stage ${currentStage} complete. All YES? ${allYes}, All NO? ${allNo}`);
            console.log('Answers:', stageAnswers);

            if (allYes && currentStage !== 'Scale') {
                // ALL YES - check if next higher stage was already tested at 0%
                const nextStage = getNextStage(currentStage);

                if (nextStage) {
                    // Check if next stage was already tested and got 0% (all NO)
                    const nextStageAnswers = elementResult.answers[nextStage];
                    const nextWas0 = nextStageAnswers && nextStageAnswers.every(a => a === false);

                    if (nextWas0) {
                        // Next stage already tested at 0% - complete at 0% for that higher stage
                        console.log(`All YES at ${currentStage}, but ${nextStage} was already tested at 0% - completing at 0% ${nextStage}`);
                        elementResult.score = 0; // Score is 0% because highest stage attempted (nextStage) failed
                        elementResult.highestStageReached = nextStage; // Highest stage attempted (even though failed)
                        saveMultiElementProgress();
                        elementComplete();
                    } else {
                        // Next stage not tested or not 0% - suggest testing it
                        showStageSuggestion('higher', currentStage, nextStage);
                    }
                } else {
                    // No more stages - element fully complete at 100%
                    console.log(`${currentElement} complete at 100%!`);
                    elementResult.score = 100;
                    elementResult.highestStageReached = currentStage; // Reached this stage
                    saveMultiElementProgress();
                    elementComplete();
                }
            } else if (allYes && currentStage === 'Scale') {
                // ALL YES at Scale - 100% complete
                console.log(`${currentElement} complete at 100%!`);
                elementResult.score = 100;
                elementResult.highestStageReached = currentStage; // Reached Scale
                saveMultiElementProgress();
                elementComplete();
            } else if (allNo && currentStage !== 'Discovery') {
                // ALL NO - check if previous lower stage was already tested at 100%
                const lowerStage = getPreviousStage(currentStage);

                if (lowerStage) {
                    // Check if lower stage was already tested and got 100% (all YES)
                    const lowerStageAnswers = elementResult.answers[lowerStage];
                    const lowerWas100 = lowerStageAnswers && lowerStageAnswers.every(a => a === true);

                    if (lowerWas100) {
                        // Lower stage already tested at 100% - complete at 0% for current stage (highest attempted)
                        console.log(`All NO at ${currentStage}, but ${lowerStage} was already tested at 100% - completing at 0% ${currentStage}`);
                        elementResult.score = 0; // Score is 0% because highest stage attempted (currentStage) failed
                        elementResult.highestStageReached = currentStage; // Highest stage attempted (even though failed)
                        saveMultiElementProgress();
                        elementComplete();
                    } else {
                        // Lower stage not tested or not 100% - suggest testing it
                        showStageSuggestion('lower', currentStage, lowerStage);
                    }
                } else {
                    // No lower stage - complete at 0%
                    console.log(`All NO at Discovery - completing at 0%`);
                    elementResult.score = 0;
                    elementResult.highestStageReached = 'Discovery';
                    saveMultiElementProgress();
                    elementComplete();
                }
            } else if (allNo && currentStage === 'Discovery') {
                // ALL NO at Discovery - complete at 0%
                console.log(`All NO at Discovery - completing at 0%`);
                elementResult.score = 0;
                elementResult.highestStageReached = 'Discovery'; // Failed at Discovery
                saveMultiElementProgress();
                elementComplete();
            } else {
                // MIXED answers - calculate percentage score and complete element
                const isSolo = userData.teamSize === 'Solo';
                const totalQuestions = currentQuestions.filter(q => {
                    // Exclude NA questions for Solo users
                    if (isSolo && (q.Solo === 'NA' || q.solo === 'NA')) return false;
                    return true;
                }).length;
                const yesCount = stageAnswers.filter(a => a === true).length;
                const scorePercent = totalQuestions > 0 ? Math.round((yesCount / totalQuestions) * 100) : 0;

                console.log(`Mixed answers - ${yesCount} YES out of ${totalQuestions} questions = ${scorePercent}%`);
                elementResult.score = scorePercent;
                elementResult.highestStageReached = currentStage; // Reached this stage with mixed results
                saveMultiElementProgress();
                elementComplete();
            }
        }

        // Get Next Stage
        function getNextStage(currentStageName) {
            const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
            const currentIndex = stages.indexOf(currentStageName);

            if (currentIndex < stages.length - 1) {
                return stages[currentIndex + 1];
            }
            return null;  // No next stage
        }

        // Get Previous Stage
        function getPreviousStage(currentStageName) {
            const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
            const currentIndex = stages.indexOf(currentStageName);

            if (currentIndex > 0) {
                return stages[currentIndex - 1];
            }
            return null;  // No previous stage
        }

        // Show Stage Suggestion Modal
        function showStageSuggestion(direction, currentStageName, suggestedStage) {
            const elementResult = multiElementProgress.results[currentElement];
            const elementName = currentElement; // Capture current element in closure
            const stageAtTimeOfSuggestion = currentStageName; // Capture stage in closure

            // Generic message for both directions
            const message = `Based on your results, we recommend testing the ${suggestedStage} stage.`;
            const reasoning = `This will give you a more accurate assessment of your maturity.`;

            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;

            // Create modal content
            const modalContent = document.createElement('div');
            modalContent.style.cssText = 'background: #f5f5dc; padding: 40px; border-radius: 12px; max-width: 500px; text-align: center;';

            const heading = document.createElement('h2');
            heading.style.cssText = 'color: #2d2828; margin-bottom: 16px;';
            heading.textContent = message;

            const para = document.createElement('p');
            para.style.cssText = 'color: #2d2828; font-size: 16px; line-height: 1.6; margin-bottom: 24px;';
            para.textContent = reasoning;

            const buttonContainer = document.createElement('div');
            buttonContainer.style.cssText = 'display: flex; gap: 12px; justify-content: center;';

            const declineBtn = document.createElement('button');
            declineBtn.className = 'btn-secondary';
            declineBtn.textContent = 'No, Continue';
            declineBtn.style.cursor = 'pointer';

            const acceptBtn = document.createElement('button');
            acceptBtn.className = 'btn-primary';
            acceptBtn.textContent = `Yes, Test ${suggestedStage}`;
            acceptBtn.style.cursor = 'pointer';

            // Attach event listeners before appending
            declineBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log(' Decline button clicked');
                declineStageSuggestion(elementName, stageAtTimeOfSuggestion, overlay);
            });

            acceptBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log(' Accept button clicked');
                acceptStageSuggestion(elementName, direction, suggestedStage, overlay);
            });

            buttonContainer.appendChild(declineBtn);
            buttonContainer.appendChild(acceptBtn);

            modalContent.appendChild(heading);
            modalContent.appendChild(para);
            modalContent.appendChild(buttonContainer);

            overlay.appendChild(modalContent);
            document.body.appendChild(overlay);
        }

        // Accept Stage Suggestion
        function acceptStageSuggestion(elementName, direction, suggestedStage, overlayElement) {
            const elementResult = multiElementProgress.results[elementName];

            // RULE 3: If accepted, launch suggested stage for current element
            // and drop other elements down one stage
            console.log(` Accepted ${direction} stage suggestion: ${suggestedStage} for ${elementName}`);

            // Update current element to new stage
            currentElement = elementName; // Set global back to this element
            currentStage = suggestedStage;
            elementResult.currentStage = suggestedStage;

            if (direction === 'higher') {
                console.log(` Going UP - setting highestStageReached to ${suggestedStage}`);
                elementResult.highestStageReached = suggestedStage;
            } else {
                // Lower stage - reset highest reached
                console.log(` Going DOWN - resetting highestStageReached to ${suggestedStage}`);
                elementResult.highestStageReached = suggestedStage;
                // Clear answers for stages above the new suggested stage
                const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
                const suggestedIndex = stages.indexOf(suggestedStage);
                const stagesToClear = stages.slice(suggestedIndex + 1);
                console.log(` Clearing answers for stages:`, stagesToClear);
                stagesToClear.forEach(stage => {
                    delete elementResult.answers[stage];
                });
            }

            // Drop other remaining elements down one stage
            multiElementProgress.elementsRemaining.forEach(otherElementName => {
                if (otherElementName !== elementName) {
                    const otherResult = multiElementProgress.results[otherElementName];
                    // Only drop if element has been initialized and has a currentStage
                    if (otherResult && otherResult.currentStage) {
                        const lowerStage = getPreviousStage(otherResult.currentStage);
                        if (lowerStage) {
                            console.log(` Dropping ${otherElementName} from ${otherResult.currentStage} to ${lowerStage}`);
                            otherResult.currentStage = lowerStage;
                        }
                    } else {
                        console.log(` Skipping ${otherElementName} - not yet initialized or no currentStage`);
                    }
                }
            });

            saveMultiElementProgress();

            // Remove overlay
            overlayElement.remove();

            // Load questions for new stage
            loadQuestionsForStage();
        }

        // Decline Stage Suggestion
        function declineStageSuggestion(elementName, stageName, overlayElement) {
            const elementResult = multiElementProgress.results[elementName];

            console.log(` Declined stage suggestion - completing ${elementName} at ${stageName}`);

            // Set globals back to this element/stage
            currentElement = elementName;
            currentStage = stageName;

            // Check the last stage's answers to determine if ALL YES or ALL NO
            const stageAnswers = elementResult.answers[stageName] || [];
            const allYes = stageAnswers.every(a => a === true);
            const allNo = stageAnswers.every(a => a === false);

            // Score based on whether they got ALL YES or ALL NO
            if (allYes) {
                // ALL YES but declined to test higher = 100%
                elementResult.score = 100;
                console.log(` Declined after ALL YES - score = 100%`);
            } else if (allNo) {
                // ALL NO but declined to test lower = 0%
                elementResult.score = 0;
                console.log(` Declined after ALL NO - score = 0%`);
            }

            elementResult.highestStageReached = currentStage; // Set to stage where they declined

            // Count total questions answered for tracking
            let totalQuestions = 0;
            let totalYes = 0;
            Object.keys(elementResult.answers).forEach(stage => {
                const stageAnswers = elementResult.answers[stage];
                totalQuestions += stageAnswers.length;
                totalYes += stageAnswers.filter(a => a === true).length;
            });
            elementResult.questionsAnswered = totalQuestions;
            elementResult.questionsYes = totalYes;

            saveMultiElementProgress();

            // Remove overlay
            overlayElement.remove();

            // Complete the element and move to next
            elementComplete();
        }

        // Show Stage Transition Message
        function showStageTransition(nextStage) {
            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;

            overlay.innerHTML = `
                <div style="background: #f5f5dc; padding: 40px; border-radius: 12px; max-width: 500px; text-align: center;">
                    <h2 style="color: #2d2828; margin-bottom: 16px;">Excellent Progress!</h2>
                    <p style="color: #2d2828; font-size: 18px; margin-bottom: 24px;">
                        You've completed ${currentStage} foundations.
                        Let's check your ${nextStage} level...
                    </p>
                    <button class="btn-primary" onclick="this.parentElement.parentElement.remove(); loadQuestionsForStage();">
                        Continue to ${nextStage}
                    </button>
                </div>
            `;

            document.body.appendChild(overlay);
        }

        // Element Complete - Mark element as done and move to next
        function elementComplete() {
            const elementResult = multiElementProgress.results[currentElement];

            // Score should already be set by checkStageCompletion or declineStageSuggestion
            console.log(` Element ${currentElement} complete with score: ${elementResult.score}%`);

            // Mark as completed
            markElementStatus(currentElement, 'completed');

            // Add to completed list if not already there
            if (!multiElementProgress.elementsCompleted.includes(currentElement)) {
                multiElementProgress.elementsCompleted.push(currentElement);
            }

            // Remove from remaining list
            multiElementProgress.elementsRemaining = multiElementProgress.elementsRemaining.filter(e => e !== currentElement);

            // Check if all 4 elements complete
            if (multiElementProgress.elementsCompleted.length === 4) {
                multiElementProgress.allComplete = true;
            }

            saveMultiElementProgress();

            // Show completion message
            showElementCompletionMessage();
        }

        // Show Element Completion Message
        function showElementCompletionMessage() {
            const elementResult = multiElementProgress.results[currentElement];
            const elementsRemaining = multiElementProgress.elementsRemaining.length;

            const overlay = document.createElement('div');
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
            `;

            let message = '';
            if (multiElementProgress.allComplete) {
                message = `
                    <h2 style="color: #2d2828; margin-bottom: 16px;">Assessment Complete!</h2>
                    <p style="color: #2d2828; font-size: 18px; margin-bottom: 24px;">
                        You've completed all 4 elements.
                        Your ${currentElement} score: <strong>${elementResult.score}%</strong>
                    </p>
                    <button class="btn-primary" onclick="this.parentElement.parentElement.remove(); showCombinedReport();">
                        View Your Complete Report
                    </button>
                `;
            } else {
                message = `
                    <h2 style="color: #2d2828; margin-bottom: 16px;">${currentElement} Complete!</h2>
                    <p style="color: #2d2828; font-size: 18px; margin-bottom: 16px;">
                        Your ${currentElement} score: <strong>${elementResult.score}%</strong>
                    </p>
                    <p style="color: #2d2828; margin-bottom: 24px;">
                        ${elementsRemaining} element${elementsRemaining !== 1 ? 's' : ''} remaining:
                        ${multiElementProgress.elementsRemaining.join(', ')}
                    </p>
                    <button class="btn-primary" onclick="this.parentElement.parentElement.remove(); returnToPictorial();">
                        Back to Assessment
                    </button>
                `;
            }

            overlay.innerHTML = `
                <div style="background: #f5f5dc; padding: 40px; border-radius: 12px; max-width: 500px; text-align: center;">
                    ${message}
                </div>
            `;

            document.body.appendChild(overlay);
        }

        // Start Element Assessment - handles both new and re-assessment
        function startElementAssessment(elementName) {
            console.log(` Starting assessment for ${elementName}`);

            // Hide the click hint when user starts an assessment
            const clickHint = document.getElementById('elementClickHint');
            if (clickHint) {
                clickHint.style.display = 'none';
            }

            // Check if element result exists (re-assessment) or new assessment
            const elementResult = multiElementProgress.results[elementName];
            const isReassessment = elementResult && elementResult.questionsAnswered > 0;

            if (isReassessment) {
                console.log(` Re-assessing ${elementName} - previous score: ${elementResult.score}%`);
                // Reassessment - load from saved stage
                currentElement = elementName;
                currentStage = elementResult.currentStage;

                // Show questionnaire
                document.getElementById('modelSection').classList.remove('active');
                document.getElementById('questionnaireSection').classList.add('active');

                // Load questions for current stage
                loadQuestionsForStage();
            } else {
                console.log(` New assessment for ${elementName}`);
                // New assessment - use standard startAssessment
                startAssessment(elementName);
            }
        }

        // Return to Pictorial and auto-continue to next element
        function returnToPictorial() {
            document.getElementById('questionnaireSection').classList.remove('active');
            document.getElementById('modelSection').classList.add('active');
            document.getElementById('reportSection').style.display = 'block';  // Show report again
            document.getElementById('webChartSidebar').style.display = 'block';  // Show web chart sidebar
            document.getElementById('reportSidebar').style.display = 'block';  // Show report sidebar
            document.getElementById('actionSidebar').style.display = 'block';  // Show actions sidebar
            updateWebChart(); // Update with new element data

            // Scroll behaviour depends on mode
            if (userData.assessmentMode === 'complete') {
                // Complete mode: scroll so diagram is visible with next element shown
                const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
                const nextElement = elementOrder.find(el => !multiElementProgress.elementsCompleted.includes(el));

                if (nextElement) {
                    const modelSection = document.getElementById('modelSection');
                    const modelWrapper = modelSection ? modelSection.querySelector('.model-wrapper') : null;

                    if (modelWrapper) {
                        // Get position of the diagram wrapper (not the welcome text above it)
                        const wrapperRect = modelWrapper.getBoundingClientRect();
                        const wrapperTop = wrapperRect.top + window.scrollY;

                        if (nextElement === 'Marketing') {
                            // Marketing is at bottom of diagram - scroll so it's visible
                            // Marketing dot is at cy=1129 out of 1500 viewBox
                            const scrollTarget = wrapperTop + wrapperRect.height - window.innerHeight + 100;
                            window.scrollTo({ top: Math.max(0, scrollTarget), behavior: 'smooth' });
                        } else {
                            // Governance, Purpose, Strategy are at top - scroll to top of diagram
                            // Offset slightly so Governance dot at top is visible with some padding
                            window.scrollTo({ top: Math.max(0, wrapperTop - 20), behavior: 'smooth' });
                        }
                    }

                    // After scrolling, auto-start next element
                    setTimeout(() => {
                        startDemoAnimation();
                    }, 800);
                }
            } else {
                // Zoom mode: scroll to top of diagram
                console.log(' Zoom In mode: User chooses next element manually');
                const modelSection = document.getElementById('modelSection');
                const modelWrapper = modelSection ? modelSection.querySelector('.model-wrapper') : null;
                if (modelWrapper) {
                    const wrapperRect = modelWrapper.getBoundingClientRect();
                    const wrapperTop = wrapperRect.top + window.scrollY;
                    window.scrollTo({ top: Math.max(0, wrapperTop - 20), behavior: 'smooth' });
                }
            }
        }

        // Save Multi-Element Progress
        function saveMultiElementProgress() {
            localStorage.setItem('sovaMultiElementProgress', JSON.stringify(multiElementProgress));
        }

        // Toggle Quote Expand/Collapse - SIMPLE VERSION
        function toggleQuote(quoteId, buttonElement) {
            const elem = document.getElementById(quoteId);
            if (!elem) return;

            const full = elem.getAttribute('data-full-text');
            const short = elem.getAttribute('data-short-text');

            // Check current state by looking at class or text content
            const isExpanded = buttonElement.classList.contains('collapse');

            if (!isExpanded) {
                // Expand: show full text
                elem.textContent = full;
                buttonElement.textContent = 'Read Less';
                buttonElement.classList.remove('expand');
                buttonElement.classList.add('collapse');
            } else {
                // Collapse: show short text
                elem.textContent = short + '...';
                buttonElement.textContent = 'Read More';
                buttonElement.classList.remove('collapse');
                buttonElement.classList.add('expand');
            }
        }

        // Update Report Live - Called after every answer
        function updateReportLive() {
            console.log(' updateReportLive() called');
            console.trace(' updateReportLive() called from:');

            // Calculate current overall progress across all elements
            const elementsStarted = Object.keys(multiElementProgress.results).length;
            const elementsCompleted = multiElementProgress.elementsCompleted.length;
            const isSolo = userData.teamSize === 'Solo';

            console.log(' Elements started:', elementsStarted, 'Elements completed:', elementsCompleted);

            // Count total answers and gaps across all elements
            let totalQuestions = 0;
            let totalAnswered = 0;
            let totalYes = 0;
            let totalNo = 0;
            let allGaps = [];
            let allStrengths = [];

            Object.keys(multiElementProgress.results).forEach(elementName => {
                const result = multiElementProgress.results[elementName];

                Object.keys(result.answers).forEach(stageName => {
                    const stageAnswers = result.answers[stageName];
                    totalQuestions += stageAnswers.length;

                    stageAnswers.forEach((answer, filteredIndex) => {
                        if (answer !== null && answer !== undefined) {
                            totalAnswered++;
                            // IMPORTANT: Get the original question using stored _originalIndex
                            const filteredQuestion = allQuestionsData[elementName][stageName].filter((q, idx) => {
                                const soloText = q.Solo || q.solo;
                                const teamText = q.Team || q.team;
                                const isApplicable = isSolo
                                    ? (soloText && soloText !== 'NA' && soloText.trim() !== '')
                                    : (teamText && teamText !== 'NA' && teamText.trim() !== '');
                                return isApplicable;
                            })[filteredIndex];
                            const question = filteredQuestion;

                            if (answer === true) {
                                totalYes++;
                                // Collect strengths (YES answers) - but only if question applies to user type
                                if (question) {
                                    // Check if question is applicable to solo/team
                                    const soloText = question.Solo || question.solo;
                                    const teamText = question.Team || question.team;
                                    const isApplicable = isSolo
                                        ? (soloText && soloText !== 'NA' && soloText.trim() !== '')
                                        : (teamText && teamText !== 'NA' && teamText.trim() !== '');

                                    if (isApplicable) {
                                        allStrengths.push({
                                            element: elementName,
                                            stage: stageName,
                                            question: question
                                        });
                                    }
                                }
                            } else {
                                totalNo++;
                                // Collect gaps (NO answers) - but only if question applies to user type
                                if (question) {
                                    // Check if question is applicable to solo/team
                                    const soloText = question.Solo || question.solo;
                                    const teamText = question.Team || question.team;
                                    const isApplicable = isSolo
                                        ? (soloText && soloText !== 'NA' && soloText.trim() !== '')
                                        : (teamText && teamText !== 'NA' && teamText.trim() !== '');

                                    if (isApplicable) {
                                        allGaps.push({
                                            element: elementName,
                                            stage: stageName,
                                            questionIndex: filteredIndex,
                                            question: question,
                                            elementScore: result.score || 0
                                        });
                                    }
                                }
                            }
                        }
                    });
                });
            });

            // Sort gaps by priority: element score (ascending), then stage order, then question index
            const stageOrder = { 'Discovery': 0, 'Validation': 1, 'Efficiency': 2, 'Scale': 3 };
            allGaps.sort((a, b) => {
                if (a.elementScore !== b.elementScore) return a.elementScore - b.elementScore;
                if (stageOrder[a.stage] !== stageOrder[b.stage]) return stageOrder[a.stage] - stageOrder[b.stage];
                return a.questionIndex - b.questionIndex;
            });

            // Store allGaps globally for feedback submission
            window.currentAllGaps = allGaps;

            // ======================
            // 1. OVERALL PROGRESS
            // ======================
            const overallProgress = document.getElementById('overallProgress');
            if (overallProgress && totalAnswered > 0) {
                const avgScore = Math.round((totalYes / totalAnswered) * 100);

                overallProgress.innerHTML = `
                    <div style="display: flex; justify-content: space-around; text-align: center;">
                        <div>
                            <div style="font-size: 32px; font-weight: 700; color: #2d2828;">${elementsStarted}/4</div>
                            <div style="font-size: 14px; color: #2d2828; opacity: 0.7;">Elements Started</div>
                        </div>
                        <div>
                            <div style="font-size: 32px; font-weight: 700; color: #2d2828;">${totalAnswered}</div>
                            <div style="font-size: 14px; color: #2d2828; opacity: 0.7;">Questions Answered</div>
                        </div>
                        <div>
                            <div style="font-size: 32px; font-weight: 700; color: #eaffc4;">${avgScore}%</div>
                            <div style="font-size: 14px; color: #2d2828; opacity: 0.7;">Current Score</div>
                        </div>
                        <div>
                            <div style="font-size: 32px; font-weight: 700; color: ${totalNo > 0 ? '#b8d78f' : '#2d2828'};">${totalNo}</div>
                            <div style="font-size: 14px; color: #2d2828; opacity: 0.7;">Areas to Improve</div>
                        </div>
                    </div>
                `;
            } else if (overallProgress) {
                overallProgress.innerHTML = '<p class="progress-text">Complete the assessment to see your results</p>';
            }

            // ======================
            // 2. TOP 3 PRIORITIES
            // ======================
            const priorityContent = document.getElementById('priorityContent');
            if (priorityContent && allGaps.length > 0) {
                let priorityHTML = '';
                const top3Gaps = allGaps.slice(0, 3);

                top3Gaps.forEach((gap, index) => {
                    const priorityNum = index + 1;
                    const questionText = isSolo ? (gap.question.Solo || gap.question.Team) : gap.question.Team;
                    const tool1 = gap.question['Tool/Framework 1'] || '';
                    const tool2 = gap.question['Tool/Framework 2'] || '';
                    const whyQuote = whyQuotes[gap.element] || 'Addressing this area is critical for sustainable growth.';

                    priorityHTML += `
                        <div style="background: #f5f5dc; border: 2px solid #eaffc4; border-radius: 8px; padding: 24px; margin-bottom: 20px;">
                            <div style="display: flex; align-items: center; margin-bottom: 12px;">
                                <div style="background: #eaffc4; color: #2d2828; font-weight: 700; font-size: 20px; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 16px;">${priorityNum}</div>
                                <h4 style="color: #2d2828; font-size: 18px; font-weight: 700; margin: 0;">${gap.element} - ${gap.stage}</h4>
                            </div>
                            <p style="color: #2d2828; font-size: 15px; line-height: 1.6; margin: 0 0 16px 0;"><strong>Focus:</strong> ${questionText}</p>
                            ${tool1 ? `<p style="margin: 8px 0; color: #2d2828;"><strong>Tool:</strong> ${tool1}</p>` : ''}
                            ${tool2 ? `<p style="margin: 8px 0; color: #2d2828;"><strong>Also consider:</strong> ${tool2}</p>` : ''}
                            <blockquote style="margin: 16px 0 0 0; padding: 12px 16px; background: #f5f5dc; border-left: 3px solid #b8d78f; font-style: italic; color: #2d2828; line-height: 1.6; font-size: 14px;">
                                <strong>Why this matters:</strong> ${whyQuote}
                            </blockquote>
                        </div>
                    `;
                });

                priorityContent.innerHTML = priorityHTML;
            } else if (priorityContent && totalAnswered > 0) {
                priorityContent.innerHTML = '<p style="color: #2d2828; font-size: 16px;">Excellent! No areas for improvement identified yet. Your top priorities will appear here if any are found.</p>';
            } else if (priorityContent) {
                priorityContent.innerHTML = '<p class="placeholder-text">Your top 3 priorities will appear here...</p>';
            }

            // ======================
            // 3. CURRENT STATUS (Hero section) - Action-oriented messaging
            // ======================
            const statusContent = document.getElementById('statusContent');
            if (elementsStarted > 0) {
                // Action-oriented messaging - encouraging, no timelines
                let statusHTML = '';
                if (totalNo === 0) {
                    statusHTML = '<p style="color: #f5f5dc; font-size: clamp(18px, 2vw, 24px); line-height: 1.6; margin: 0;">You\'re in great shape. Keep building on these foundations.</p>';
                } else if (totalNo === 1) {
                    statusHTML = '<p style="color: #f5f5dc; font-size: clamp(18px, 2vw, 24px); line-height: 1.6; margin: 0 0 12px 0;">We\'ve identified <strong style="color: #eaffc4;">1 area</strong> to strengthen.</p>';
                    statusHTML += '<p style="color: #f5f5dc; font-size: clamp(14px, 1.6vw, 16px); line-height: 1.6; margin: 0; opacity: 0.7;">You\'re almost thereone focus area to address.</p>';
                } else if (totalNo <= 3) {
                    statusHTML = '<p style="color: #f5f5dc; font-size: clamp(18px, 2vw, 24px); line-height: 1.6; margin: 0 0 12px 0;">We\'ve identified <strong style="color: #eaffc4;">' + totalNo + ' areas</strong> to strengthen.</p>';
                    statusHTML += '<p style="color: #f5f5dc; font-size: clamp(14px, 1.6vw, 16px); line-height: 1.6; margin: 0; opacity: 0.7;">Start with #1, then work your way through.</p>';
                } else {
                    statusHTML = '<p style="color: #f5f5dc; font-size: clamp(18px, 2vw, 24px); line-height: 1.6; margin: 0 0 12px 0;">We\'ve identified <strong style="color: #eaffc4;">' + totalNo + ' areas</strong> to strengthen.</p>';
                    statusHTML += '<p style="color: #f5f5dc; font-size: clamp(14px, 1.6vw, 16px); line-height: 1.6; margin: 0; opacity: 0.7;">Start with the top 3 priorities, then tackle the rest.</p>';
                }
                statusContent.innerHTML = statusHTML;
            } else {
                statusContent.innerHTML = '<p style="color: #f5f5dc; font-size: clamp(18px, 2vw, 24px);">Complete the assessment to see your results</p>';
            }

            // ======================
            // 4. OVERALL SCORE VISUAL - Removed, point to web chart instead
            // ======================
            const overallScoreVisual = document.getElementById('overallScoreVisual');
            if (overallScoreVisual) {
                overallScoreVisual.innerHTML = '';
            }

            // ======================
            // 5. ELEMENT GRID (4 columns - clickable to filter gaps)
            // ======================
            const elementGrid = document.getElementById('elementGrid');
            if (elementGrid && elementsStarted > 0) {
                let gridHTML = '';

                // Show all 4 elements in fixed order
                const allElements = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
                allElements.forEach(elementName => {
                    const result = multiElementProgress.results[elementName];

                    if (result) {
                        const score = result.score || 0;
                        const highestStage = result.highestStageReached || 'Discovery';
                        const isComplete = multiElementProgress.elementsCompleted.includes(elementName);

                        // Count gaps for this element
                        const elementGapsCount = allGaps.filter(g => g.element === elementName).length;

                        gridHTML += `
                            <div onclick="filterGapsByElement('${elementName}')" style="background: #f5f5dc; border-radius: 10px; padding: 14px; box-shadow: 0 2px 8px rgba(61, 37, 23, 0.06); cursor: pointer; transition: all 0.3s cubic-bezier(0.23, 1, 0.32, 1); border: 2px solid transparent;" onmouseover="this.style.transform='translateY(-6px)'; this.style.boxShadow='0 8px 16px rgba(61, 37, 23, 0.12)'; this.style.borderColor='#eaffc4';" onmouseout="this.style.transform=''; this.style.boxShadow='0 2px 8px rgba(61, 37, 23, 0.06)'; this.style.borderColor='transparent';">
                                <h3 style="color: #2d2828; font-size: clamp(16px, 2vw, 20px); font-weight: 700; margin: 0 0 10px 0;">${elementName}</h3>

                                <!-- Large score -->
                                <div style="font-size: clamp(32px, 5vw, 44px); font-weight: 900; color: #b8d78f; line-height: 1; margin-bottom: 8px;">${score}%</div>

                                <!-- Stage badge -->
                                <div style="background: #eaffc4; color: #2d2828; padding: 4px 10px; border-radius: 12px; font-size: 9px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.8px; display: inline-block; margin-bottom: 10px;">${highestStage}</div>

                                <!-- Gaps count -->
                                ${elementGapsCount > 0 ? `
                                    <div style="color: #2d2828; font-size: 11px; font-weight: 600; opacity: 0.7;">
                                        ${elementGapsCount} area${elementGapsCount !== 1 ? 's' : ''} to improve
                                    </div>
                                ` : `
                                    <div style="color: #2d2828; font-size: 11px; font-weight: 600; opacity: 0.7;">
                                        No areas to improve
                                    </div>
                                `}

                                <!-- Click hint -->
                                <div style="margin-top: 10px; padding-top: 10px; border-top: 2px solid #f5f5dc; color: #2d2828; opacity: 0.5; font-size: 9px; text-transform: uppercase; letter-spacing: 0.8px;">
                                    Click to view areas
                                </div>
                            </div>
                        `;
                    } else {
                        // Not yet assessed
                        gridHTML += `
                            <div style="background: #f5f5dc; border-radius: 16px; padding: 28px; opacity: 0.5;">
                                <h3 style="color: #2d2828; font-size: clamp(20px, 2vw, 28px); font-weight: 700; margin: 0 0 20px 0;">${elementName}</h3>
                                <p style="color: #2d2828; font-size: 14px; margin: 0;">Not yet assessed</p>
                            </div>
                        `;
                    }
                });

                elementGrid.innerHTML = gridHTML;
            } else if (elementGrid) {
                elementGrid.innerHTML = '<p style="color: #2d2828; text-align: center; opacity: 0.5;">Element cards will appear here after you start the assessment</p>';
            }

            // ======================
            // 6. GAPS BY ELEMENT (Per spec: Element heading + definition + quotes, then each gap with WHY/HOW/Resources)
            // ======================
            const gapsContent = document.getElementById('gapsContent');
            if (allGaps.length > 0) {
                let gapsHTML = '';

                // Add filter UI at top of gaps section
                if (Object.keys(multiElementProgress.results).length > 1) {
                    gapsHTML += `
                        <div style="max-width: 1200px; margin: 0 auto 40px auto;">
                            <div style="background: #f5f5dc; border-radius: 12px; padding: 24px;">
                                <div class="filter-row" style="display: flex; gap: 12px; align-items: center; flex-wrap: wrap;">
                                    <span style="color: #2d2828; font-weight: 600; font-size: 14px; white-space: nowrap;">Filter by Element:</span>
                                    <div class="filter-buttons" style="display: flex; gap: 8px; flex-wrap: wrap;">
                                        <button class="filter-btn" onclick="filterGapsByElement(null)" style="background: ${currentFilterElement === null ? '#2d2828' : '#f5f5dc'}; color: ${currentFilterElement === null ? '#eaffc4' : '#2d2828'}; border: 2px solid ${currentFilterElement === null ? '#2d2828' : '#f5f5dc'}; padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s; white-space: nowrap;">All</button>
                                        ${Object.keys(multiElementProgress.results).map(el => `
                                            <button class="filter-btn" onclick="filterGapsByElement('${el}')" style="background: ${currentFilterElement === el ? '#2d2828' : '#f5f5dc'}; color: ${currentFilterElement === el ? '#eaffc4' : '#2d2828'}; border: 2px solid ${currentFilterElement === el ? '#2d2828' : '#f5f5dc'}; padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; cursor: pointer; transition: all 0.2s; white-space: nowrap;">${el}</button>
                                        `).join('')}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }

                // Group gaps by element
                const gapsByElement = {};
                allGaps.forEach(gap => {
                    if (!gapsByElement[gap.element]) {
                        gapsByElement[gap.element] = [];
                    }
                    gapsByElement[gap.element].push(gap);
                });

                // Get element definitions WITH hyperlinks (from Report - Why tab in Excel)
                const elementDefinitions = {
                    'Governance': {
                        text: 'As the business bible, governance encompasses all the vital details of the company  how you want to run your business, how decisions will be made, what the processes are, how risks will be managed, and how staff will be protected from any possible legal action. It sets the standard for everyone in the company and explains what everyone\'s role is, how they should work and what the business wants to achieve.',
                        link: 'https://startupsmagazine.co.uk/article-why-good-governance-matters-startups'
                    },
                    'Purpose': {
                        text: 'From the moment it\'s formed, every business has a purpose  a "reason for being". By default, it\'s defined by the founders\' motivations for setting up shop in the first place.',
                        link: 'https://www.hsbcinnovationbanking.com/gb/en/resources/purpose-top-priority'
                    },
                    'Strategy': {
                        text: 'Strategy refers to a comprehensive plan that outlines how a business will achieve its objectives. It involves identifying key opportunities, understanding market dynamics, and creating a sustainable competitive advantage.',
                        link: 'https://www.linkedin.com/pulse/importance-strategy-entrepreneurship-chinmay-saraf-hmjff/'
                    },
                    'Marketing': {
                        text: 'Marketing connects your solution to people who need it. Great products with poor marketing fail. Average products with great marketing thrive.',
                        link: 'https://www.entrepreneur.com/starting-a-business/why-marketing-is-important-for-your-business/299334'
                    }
                };

                // FIXED: Display elements in FIXED order: Governance  Purpose  Strategy  Marketing
                const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];

                // Wrap in container for max-width
                gapsHTML += '<div style="max-width: 1200px; margin: 0 auto;">';

                elementOrder.forEach(elementName => {
                    // Skip if no gaps for this element
                    if (!gapsByElement[elementName]) return;

                    // Apply filter if set
                    if (currentFilterElement !== null && currentFilterElement !== elementName) return;

                    const elementGaps = gapsByElement[elementName];
                    const definition = elementDefinitions[elementName];
                    const elementQuote = whyQuotes[elementName];

                    gapsHTML += `
                        <div style="margin-bottom: 80px; position: relative; z-index: 100;">
                            <!-- Element header - Extreme scale with brand colors -->
                            <div class="element-section-header" style="background: #2d2828; padding: 32px 40px; border-radius: 12px; margin-bottom: 0; position: relative; z-index: 100;">
                                <div class="element-header-row" style="display: flex; justify-content: space-between; align-items: center;">
                                    <h3 style="color: #eaffc4; font-size: clamp(28px, 3vw, 42px); font-weight: 700; margin: 0; letter-spacing: -1.5px;">${elementName}</h3>
                                    <div class="element-tooltip-buttons" style="display: flex; gap: 12px; position: relative; z-index: 1000000; flex-wrap: nowrap;">
                                        ${definition ? `
                                            <div class="tooltip-trigger lime">
                                                Definition
                                                <div class="tooltip-popover">
                                                    <div class="tooltip-corner lime"></div>
                                                    <div class="tooltip-popover-label">${elementName} Definition</div>
                                                    <div class="tooltip-popover-content">${definition.text}</div>
                                                    ${definition.link ? `<a href="${definition.link}" target="_blank" class="tooltip-popover-link source-link">View Source</a>` : ''}
                                                </div>
                                            </div>
                                        ` : ''}
                                        ${elementQuote ? `
                                            <div class="tooltip-trigger lime">
                                                Why it matters
                                                <div class="tooltip-popover" style="max-width: 500px; width: 500px;">
                                                    <div class="tooltip-corner lime"></div>
                                                    <div class="tooltip-popover-label">Why ${elementName} Matters</div>
                                                    <div class="tooltip-popover-content">
                                                        <!-- Compact list of all quotes -->
                                                        <div style="display: flex; flex-direction: column; gap: 10px;">
                                                            ${elementQuote.quotes.map((quote, quoteIdx) => `
                                                                <div style="display: flex; align-items: flex-start; gap: 8px;">
                                                                    <span style="flex-shrink: 0; width: 20px; height: 20px; border-radius: 50%; background: #eaffc4; font-size: 10px; font-weight: 700; color: #2d2828; display: flex; align-items: center; justify-content: center;">${quoteIdx + 1}</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="why_quote_${elementName}_${quoteIdx}" data-full-text="${quote.text.replace(/"/g, '&quot;')}" data-short-text="${quote.text.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #2d2828; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quote.text.substring(0, 120)}${quote.text.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quote.text.length > 120 ? `<button onclick="toggleQuote('why_quote_${elementName}_${quoteIdx}', this)" class="read-more-link expand">Read More</button>` : ''}
                                                                            ${quote.link ? `<a href="${quote.link}" target="_blank" class="source-link">View Source</a>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            `).join('')}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        ` : ''}
                                        <div class="tooltip-trigger lime">
                                            Experts
                                            <div class="tooltip-popover">
                                                <div class="tooltip-corner lime"></div>
                                                <div class="tooltip-popover-label">Experts in Your Area</div>
                                                <div class="tooltip-popover-content">Expert directory launching soon. Connect with verified ${elementName.toLowerCase()} specialists in your area.</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Gaps container with visual connection to header -->
                            <div style="border-left: 3px solid rgba(45, 40, 40, 0.25); margin-left: 12px; padding-left: 20px; padding-top: 12px; padding-bottom: 8px;">
                            <!-- Gaps for this element -->
                            ${elementGaps.map((gap, idx) => {
                                // Get question text, falling back to Team if Solo is NA
                                let questionText = isSolo ? (gap.question.Solo || gap.question.solo) : (gap.question.Team || gap.question.team);
                                if (questionText === 'NA' || !questionText) {
                                    questionText = gap.question.Team || gap.question.team || '';
                                }

                                // FIXED: Convert I/my/me/mine to we/our/us/ours for team users
                                if (!isSolo && questionText) {
                                    questionText = questionText
                                        .replace(/\bI\/We\b/g, 'We')
                                        .replace(/\bI\s/g, 'We ')
                                        .replace(/\bI'm\b/g, 'We\'re')
                                        .replace(/\bI've\b/g, 'We\'ve')
                                        .replace(/\bI'd\b/g, 'We\'d')
                                        .replace(/\bI'll\b/g, 'We\'ll')
                                        .replace(/\bI,\b/g, 'We,')
                                        .replace(/\bmy\b/gi, 'our')
                                        .replace(/\bmine\b/gi, 'ours')
                                        .replace(/\bme\b/gi, 'us')
                                        .replace(/\bmyself\b/gi, 'ourselves')
                                        .replace(/\bMy\b/g, 'Our');
                                }

                                // FIXED: Use correct field names from questions-data.js WITH hyperlinks (check Excel column names with spaces)
                                const advice = gap.question.Advice || gap.question.advice || 'Start by documenting your current approach, then identify 2-3 quick wins you can implement this week.';

                                // Collect ALL quotes (up to 2 failure + 2 best practice)
                                const quoteFailure = gap.question['Quote (startup failure)'] || gap.question.quoteFailure || '';
                                const quoteFailureLink = gap.question['Quote (startup failure)Link'] || gap.question.quoteFailureLink || '';
                                const quoteFailure2 = gap.question['Quote (startup failure) 2'] || '';
                                const quoteFailure2Link = gap.question['Quote (startup failure) 2Link'] || '';
                                const quoteBestPractice = gap.question['Quote (best practice)'] || gap.question.quoteBestPractice || '';
                                const quoteBestPracticeLink = gap.question['Quote (best practice)Link'] || gap.question.quoteBestPracticeLink || '';
                                const quoteBestPractice2 = gap.question['Quote (best practice) 2'] || '';
                                const quoteBestPractice2Link = gap.question['Quote (best practice) 2Link'] || '';

                                // VC Requirements for Evidence Base
                                const vcRequirements = gap.question['VC requirements mapping'] || '';
                                const vcRequirementsLink = gap.question['VC requirements mappingLink'] || '';

                                // Collect ALL 6 tools WITH their hyperlinks
                                const tools = [];
                                const tool1 = gap.question['Tool/Framework 1'];
                                const tool1Link = gap.question['Tool/Framework 1Link'];
                                if (tool1 && tool1 !== 'None' && tool1.trim() !== '') {
                                    tools.push({ name: tool1, link: tool1Link || '' });
                                }
                                const tool2 = gap.question['Tool/Framework 2'];
                                const tool2Link = gap.question['Tool/Framework 2Link'];
                                if (tool2 && tool2 !== 'None' && tool2.trim() !== '') {
                                    tools.push({ name: tool2, link: tool2Link || '' });
                                }
                                const tool3 = gap.question['Tool/Framework 3'];
                                const tool3Link = gap.question['Tool/Framework 3Link'];
                                if (tool3 && tool3 !== 'None' && tool3.trim() !== '') {
                                    tools.push({ name: tool3, link: tool3Link || '' });
                                }
                                const tool4 = gap.question['Tool/Framework 4'];
                                const tool4Link = gap.question['Tool/Framework 4Link'];
                                if (tool4 && tool4 !== 'None' && tool4.trim() !== '') {
                                    tools.push({ name: tool4, link: tool4Link || '' });
                                }
                                const tool5 = gap.question['Tool/Framework 5'];
                                const tool5Link = gap.question['Tool/Framework 5Link'];
                                if (tool5 && tool5 !== 'None' && tool5.trim() !== '') {
                                    tools.push({ name: tool5, link: tool5Link || '' });
                                }
                                const tool6 = gap.question['Tool/Framework 6'];
                                const tool6Link = gap.question['Tool/Framework 6Link'];
                                if (tool6 && tool6 !== 'None' && tool6.trim() !== '') {
                                    tools.push({ name: tool6, link: tool6Link || '' });
                                }

                                const bookRec = gap.question.Book || '';

                                // Generate unique task ID for this gap using global index for consistency with Actions sidebar
                                const globalIdx = allGaps.findIndex(g => g.element === elementName && g.stage === gap.stage && g.question === gap.question);
                                const taskId = `${elementName.toLowerCase()}-${gap.stage.toLowerCase()}-${globalIdx}`;

                                return `
                                    <div id="gap-card-${taskId}" class="gap-card-wrapper" style="position: relative; margin-bottom: 32px; z-index: 1;">
                                        <!-- Stacked shadow effect -->
                                        <div style="position: absolute; top: 6px; left: 6px; right: -6px; bottom: -6px; background: linear-gradient(135deg, rgba(196, 255, 0, 0.12) 0%, rgba(196, 255, 0, 0.06) 100%); border-radius: 20px; z-index: 1;"></div>

                                        <div style="position: relative; background: #f5f5dc; border-radius: 20px; overflow: hidden; z-index: 2; box-shadow: 0 2px 20px rgba(61, 37, 23, 0.08);">

                                            <!-- Header: Stage badge + Question (clickable to expand/collapse) -->
                                            <div onclick="toggleGapCard('${taskId}')" style="background: linear-gradient(135deg, #2d2828 0%, #5a4228 100%); padding: 28px 36px; cursor: pointer; transition: all 0.2s;">
                                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                                    <div style="display: inline-block; background: #eaffc4; color: #2d2828; font-size: 11px; font-weight: 800; padding: 6px 16px; border-radius: 20px; text-transform: uppercase; letter-spacing: 1.2px;">Stage - ${gap.stage}</div>
                                                    <div style="display: flex; align-items: center; gap: 12px;">
                                                        <!-- Completed checkmark (hidden by default) - just checkmark, no text -->
                                                        <div id="gap-completed-badge-${taskId}" style="display: ${(userData.completedTasks[taskId] && userData.completedTasks[taskId].completed) ? 'flex' : 'none'}; align-items: center; justify-content: center; background: rgba(234, 255, 196, 0.25); padding: 6px; border-radius: 50%; width: 28px; height: 28px;">
                                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#eaffc4" stroke-width="3"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                                        </div>
                                                        <!-- Expand/collapse chevron -->
                                                        <svg id="gap-chevron-${taskId}" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#eaffc4" stroke-width="2" style="transition: transform 0.3s ease;"><polyline points="6 9 12 15 18 9"></polyline></svg>
                                                    </div>
                                                </div>
                                                <h4 style="color: #eaffc4; font-size: clamp(18px, 2.2vw, 24px); font-weight: 700; margin: 0; line-height: 1.3; letter-spacing: -0.5px;">${questionText}</h4>
                                            </div>

                                            <!-- Full Width Layout: Advice, Research References, then Tools (collapsible) -->
                                            <div id="gap-content-${taskId}" style="padding: 36px; display: none;">
                                                <!-- Advice section with subtle label -->
                                                <div style="margin-bottom: 28px;">
                                                    <div style="color: #2d2828; opacity: 0.5; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 12px;">How to Address This</div>
                                                    <p style="color: #2d2828; font-size: 14px; line-height: 1.7; margin: 0; font-weight: 400; white-space: pre-line;">${advice}</p>
                                                </div>

                                                <!-- Recommended Tools (between Advice and Research References) -->
                                                ${(tools.length > 0 || bookRec) ? `
                                                    <div style="margin-bottom: 28px;">
                                                        ${tools.length > 0 ? `
                                                            <div style="color: #2d2828; opacity: 0.5; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; margin-bottom: 16px;">Recommended Tools</div>
                                                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; margin-bottom: 24px;">
                                                                ${tools.map(tool => {
                                                                if (tool.link) {
                                                                    return `
                                                                        <a href="${tool.link}" target="_blank" style="background: rgba(61, 37, 23, 0.03); color: #2d2828; padding: 16px 20px; border-radius: 12px; font-size: 14px; font-weight: 600; text-decoration: none; display: block; transition: all 0.3s ease; border: 2px solid rgba(61, 37, 23, 0.1);" onmouseover="this.style.background='#2d2828'; this.style.color='#eaffc4'; this.style.borderColor='#2d2828';" onmouseout="this.style.background='rgba(61, 37, 23, 0.03)'; this.style.color='#2d2828'; this.style.borderColor='rgba(61, 37, 23, 0.1)';">
                                                                            ${tool.name}
                                                                        </a>
                                                                    `;
                                                                } else {
                                                                    return `
                                                                        <div style="background: rgba(61, 37, 23, 0.02); color: #2d2828; padding: 16px 20px; border-radius: 12px; font-size: 14px; font-weight: 600; opacity: 0.5; border: 2px dashed rgba(61, 37, 23, 0.2);">
                                                                            ${tool.name}
                                                                        </div>
                                                                    `;
                                                                }
                                                                }).join('')}
                                                            </div>
                                                        ` : ''}

                                                        <!-- Recommended Reading -->
                                                        ${bookRec ? `
                                                            <div style="color: #2d2828; opacity: 0.5; font-size: 11px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.5px; margin: 0 0 16px 0;">Recommended Reading</div>
                                                            <div style="background: rgba(61, 37, 23, 0.03); border-radius: 8px; padding: 16px; border-left: 3px solid #2d2828;">
                                                                <p style="color: #2d2828; font-size: 14px; line-height: 1.6; margin: 0; font-weight: 600;">${bookRec}</p>
                                                            </div>
                                                        ` : ''}
                                                    </div>
                                                ` : ''}

                                                    <!-- Evidence Base: Compact reference-style citations -->
                                                    ${(quoteFailure || quoteFailure2 || quoteBestPractice || quoteBestPractice2 || vcRequirements) ? `
                                                        <div style="background: rgba(61, 37, 23, 0.03); border-radius: 8px; padding: 16px; border-left: 3px solid #eaffc4;">
                                                            <div style="color: #2d2828; opacity: 0.5; font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1.2px; margin-bottom: 12px;">Research References</div>

                                                            <!-- Compact list of all references -->
                                                            <div style="display: flex; flex-direction: column; gap: 8px;">
                                                                ${quoteFailure ? `<div style="display: flex; align-items: flex-start; gap: 6px;">
                                                                    <span style="flex-shrink: 0; width: 28px; padding: 3px 0; border-radius: 4px; background: #c9b896; font-size: 8px; font-weight: 700; color: #2d2828; text-transform: uppercase; letter-spacing: 0.3px; text-align: center;">Risk</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_failure_${elementName}_${gap.stage}_${idx}" data-full-text="${quoteFailure.replace(/"/g, '&quot;')}" data-short-text="${quoteFailure.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #2d2828; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quoteFailure.substring(0, 120)}${quoteFailure.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quoteFailure.length > 120 ? `<button onclick="toggleQuote('quote_failure_${elementName}_${gap.stage}_${idx}', this)" class="read-more-link expand">Read More</button>` : ''}
                                                                            ${quoteFailureLink ? `<button onclick="window.open('${quoteFailureLink}', '_blank')" class="source-link">View Source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                                ${quoteFailure2 ? `<div style="display: flex; align-items: flex-start; gap: 6px;">
                                                                    <span style="flex-shrink: 0; width: 28px; padding: 3px 0; border-radius: 4px; background: #c9b896; font-size: 8px; font-weight: 700; color: #2d2828; text-transform: uppercase; letter-spacing: 0.3px; text-align: center;">Risk</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_failure2_${elementName}_${gap.stage}_${idx}" data-full-text="${quoteFailure2.replace(/"/g, '&quot;')}" data-short-text="${quoteFailure2.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #2d2828; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quoteFailure2.substring(0, 120)}${quoteFailure2.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quoteFailure2.length > 120 ? `<button onclick="toggleQuote('quote_failure2_${elementName}_${gap.stage}_${idx}', this)" class="read-more-link expand">Read More</button>` : ''}
                                                                            ${quoteFailure2Link ? `<button onclick="window.open('${quoteFailure2Link}', '_blank')" class="source-link">View Source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                                ${quoteBestPractice ? `<div style="display: flex; align-items: flex-start; gap: 6px;">
                                                                    <span style="flex-shrink: 0; width: 28px; padding: 3px 0; border-radius: 4px; background: #eaffc4; font-size: 8px; font-weight: 700; color: #2d2828; text-transform: uppercase; letter-spacing: 0.3px; text-align: center;">Best</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_best_${elementName}_${gap.stage}_${idx}" data-full-text="${quoteBestPractice.replace(/"/g, '&quot;')}" data-short-text="${quoteBestPractice.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #2d2828; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quoteBestPractice.substring(0, 120)}${quoteBestPractice.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quoteBestPractice.length > 120 ? `<button onclick="toggleQuote('quote_best_${elementName}_${gap.stage}_${idx}', this)" class="read-more-link expand">Read More</button>` : ''}
                                                                            ${quoteBestPracticeLink ? `<button onclick="window.open('${quoteBestPracticeLink}', '_blank')" class="source-link">View Source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                                ${quoteBestPractice2 ? `<div style="display: flex; align-items: flex-start; gap: 6px;">
                                                                    <span style="flex-shrink: 0; width: 28px; padding: 3px 0; border-radius: 4px; background: #eaffc4; font-size: 8px; font-weight: 700; color: #2d2828; text-transform: uppercase; letter-spacing: 0.3px; text-align: center;">Best</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_best2_${elementName}_${gap.stage}_${idx}" data-full-text="${quoteBestPractice2.replace(/"/g, '&quot;')}" data-short-text="${quoteBestPractice2.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #2d2828; font-size: 11px; line-height: 1.4; margin: 0; font-style: italic;">${quoteBestPractice2.substring(0, 120)}${quoteBestPractice2.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${quoteBestPractice2.length > 120 ? `<button onclick="toggleQuote('quote_best2_${elementName}_${gap.stage}_${idx}', this)" class="read-more-link expand">Read More</button>` : ''}
                                                                            ${quoteBestPractice2Link ? `<button onclick="window.open('${quoteBestPractice2Link}', '_blank')" class="source-link">View Source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                                ${vcRequirements ? `<div style="display: flex; align-items: flex-start; gap: 6px;">
                                                                    <span style="flex-shrink: 0; width: 28px; padding: 3px 0; border-radius: 4px; background: #b8d78f; font-size: 8px; font-weight: 700; color: #2d2828; text-transform: uppercase; letter-spacing: 0.3px; text-align: center;">VC</span>
                                                                    <div style="flex: 1;">
                                                                        <p id="quote_vc_${elementName}_${gap.stage}_${idx}" data-full-text="${vcRequirements.replace(/"/g, '&quot;')}" data-short-text="${vcRequirements.substring(0, 120).replace(/"/g, '&quot;')}" style="color: #2d2828; font-size: 11px; line-height: 1.4; margin: 0;">${vcRequirements.substring(0, 120)}${vcRequirements.length > 120 ? '...' : ''}</p>
                                                                        <div style="margin-top: 4px; display: flex; gap: 12px;">
                                                                            ${vcRequirements.length > 120 ? `<button onclick="toggleQuote('quote_vc_${elementName}_${gap.stage}_${idx}', this)" class="read-more-link expand">Read More</button>` : ''}
                                                                            ${vcRequirementsLink ? `<button onclick="window.open('${vcRequirementsLink}', '_blank')" class="source-link">View Source</button>` : ''}
                                                                        </div>
                                                                    </div>
                                                                </div>` : ''}
                                                            </div>
                                                        </div>
                                                    ` : ''}

                                                <!-- COMPLETION UI - Minimalist design following Jeton/Phamily/Osmo principles -->
                                                ${(() => {
                                                    // Use same taskId format as gap card wrapper for consistency (using globalIdx)
                                                    const completionTaskId = `${elementName.toLowerCase()}-${gap.stage.toLowerCase()}-${globalIdx}`;
                                                    const completion = userData.completedTasks[completionTaskId];
                                                    const isCompleted = completion && completion.completed;

                                                    if (isCompleted) {
                                                        // COMPLETED STATE - Right-justified, minimal
                                                        const completedDate = completion.completedAt ? new Date(completion.completedAt).toLocaleDateString('en-AU', { day: 'numeric', month: 'short' }) : '';
                                                        return `
                                                            <div style="margin-top: 28px; display: flex; flex-direction: column; align-items: flex-end;">
                                                                <div style="display: flex; align-items: center; gap: 8px;">
                                                                    <span style="color: #2d2828; font-size: 12px; opacity: 0.4;">Done${completedDate ? '  ' + completedDate : ''}${completion.satisfaction === 'up' ? '  Helpful' : completion.satisfaction === 'down' ? '  Needs work' : ''}</span>
                                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#2d2828" stroke-width="2" style="opacity: 0.4;"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                                                </div>
                                                                ${completion.notes ? `<p style="color: #2d2828; font-size: 11px; opacity: 0.35; margin: 6px 0 0 0; font-style: italic; text-align: right;">"${completion.notes}"</p>` : ''}
                                                                <button onclick="uncompleteGap('${completionTaskId}')" style="background: none; border: none; color: #2d2828; font-size: 11px; opacity: 0.3; cursor: pointer; padding: 0; margin-top: 4px;" onmouseover="this.style.opacity='0.6'" onmouseout="this.style.opacity='0.3'">Undo</button>
                                                            </div>
                                                        `;
                                                    } else {
                                                        // NOT COMPLETED - Right-justified with checkmark button
                                                        return `
                                                            <div id="completion-${completionTaskId}" style="margin-top: 28px; display: flex; flex-direction: column; align-items: flex-end;">
                                                                <!-- Default: Mark complete with checkmark -->
                                                                <div id="completion-default-${completionTaskId}" onclick="expandCompletion('${completionTaskId}')" style="display: flex; align-items: center; gap: 6px; cursor: pointer; opacity: 0.35; transition: opacity 0.2s;" onmouseover="this.style.opacity='0.6'" onmouseout="this.style.opacity='0.35'">
                                                                    <span style="color: #2d2828; font-size: 12px;">Mark complete</span>
                                                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#2d2828" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
                                                                </div>
                                                                <!-- Expanded: Rating + optional notes on one line -->
                                                                <div id="completion-expanded-${completionTaskId}" style="display: none; text-align: right; width: 100%;">
                                                                    <p style="color: #2d2828; font-size: 12px; margin: 0 0 12px 0; opacity: 0.6;">How would you rate this action?</p>
                                                                    <div style="display: flex; justify-content: flex-end; align-items: center; gap: 12px; margin-bottom: 12px;">
                                                                        <svg id="thumb-up-${completionTaskId}" onclick="selectRating('${completionTaskId}', 'up')" width="22" height="22" viewBox="0 0 24 24" fill="#2d2828" style="opacity: 0.25; cursor: pointer; transition: all 0.2s; flex-shrink: 0;" onmouseover="this.style.opacity='0.6'" onmouseout="if(!this.classList.contains('selected'))this.style.opacity='0.25'"><path d="M2 20h2c.55 0 1-.45 1-1v-9c0-.55-.45-1-1-1H2v11zm19.83-7.12c.11-.25.17-.52.17-.8V11c0-1.1-.9-2-2-2h-5.5l.92-4.65c.05-.22.02-.46-.08-.66-.23-.45-.52-.86-.88-1.22L14 2 7.59 8.41C7.21 8.79 7 9.3 7 9.83v7.84C7 18.95 8.05 20 9.34 20h8.11c.7 0 1.36-.37 1.72-.97l2.66-6.15z"/></svg>
                                                                        <svg id="thumb-down-${completionTaskId}" onclick="selectRating('${completionTaskId}', 'down')" width="22" height="22" viewBox="0 0 24 24" fill="#2d2828" style="opacity: 0.25; cursor: pointer; transition: all 0.2s; flex-shrink: 0;" onmouseover="this.style.opacity='0.6'" onmouseout="if(!this.classList.contains('selected'))this.style.opacity='0.25'"><path d="M22 4h-2c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h2V4zM2.17 11.12c-.11.25-.17.52-.17.8V13c0 1.1.9 2 2 2h5.5l-.92 4.65c-.05.22-.02.46.08.66.23.45.52.86.88 1.22L10 22l6.41-6.41c.38-.38.59-.89.59-1.42V6.34C17 5.05 15.95 4 14.66 4h-8.1c-.71 0-1.36.37-1.72.97l-2.67 6.15z"/></svg>
                                                                        <input id="notes-${completionTaskId}" type="text" placeholder="Please tell us more (optional)" style="flex: 1; max-width: 240px; padding: 8px 12px; border: none; border-radius: 6px; font-size: 11px; font-family: inherit; background: rgba(45, 40, 40, 0.04); color: #2d2828; outline: none;" onfocus="this.style.background='rgba(45, 40, 40, 0.06)'" onblur="this.style.background='rgba(45, 40, 40, 0.04)'">
                                                                    </div>
                                                                    <div style="display: flex; justify-content: flex-end; gap: 12px; align-items: center;">
                                                                        <span onclick="collapseCompletion('${completionTaskId}')" style="color: #2d2828; font-size: 11px; opacity: 0.3; cursor: pointer;">Cancel</span>
                                                                        <button id="submit-${completionTaskId}" onclick="submitCompletion('${completionTaskId}')" style="background: #2d2828; border: none; padding: 8px 16px; border-radius: 6px; font-size: 11px; color: #eaffc4; cursor: pointer; opacity: 0.4; transition: all 0.2s;" disabled>Submit</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        `;
                                                    }
                                                })()}
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                            </div><!-- Close gaps container -->
                        </div>
                    `;
                });

                gapsHTML += '</div>'; // Close max-width container

                gapsContent.innerHTML = gapsHTML;

                // Initialize gap card expand/collapse states and tooltips
                setTimeout(() => {
                    initializeGapCards();
                    initializeTooltips(); // Re-initialize for dynamically added tooltips
                }, 100);
            } else if (totalAnswered > 0) {
                gapsContent.innerHTML = '<p style="color: #2d2828; font-size: 16px;">No areas for improvement identified. You\'re doing great!</p>';
            } else {
                gapsContent.innerHTML = '<p class="placeholder-text">Your areas for improvement will appear here...</p>';
            }

            // ======================
            // 5. STRENGTHS
            // ======================
            const strengthsContent = document.getElementById('strengthsContent');
            if (strengthsContent && allStrengths.length > 0) {
                let strengthsHTML = '';

                // Group strengths by element
                const strengthsByElement = {};
                allStrengths.forEach(strength => {
                    if (!strengthsByElement[strength.element]) {
                        strengthsByElement[strength.element] = [];
                    }
                    strengthsByElement[strength.element].push(strength);
                });

                // Show up to 3 strengths per element
                Object.keys(strengthsByElement).forEach(elementName => {
                    const elementStrengths = strengthsByElement[elementName].slice(0, 3);

                    strengthsHTML += `<h4 style="color: #2d2828; font-size: 16px; font-weight: 700; margin: 20px 0 12px 0;">${elementName}</h4>`;

                    elementStrengths.forEach(strength => {
                        const matureQuote = strength.question.references?.mature || 'You\'re demonstrating best practices in this area.';
                        const questionText = isSolo ? (strength.question.Solo || strength.question.solo) : (strength.question.Team || strength.question.team);

                        strengthsHTML += `
                            <div style="background: #f5f5dc; border-left: 4px solid #eaffc4; padding: 16px; margin-bottom: 12px; border-radius: 4px;">
                                <p style="color: #2d2828; font-size: 14px; font-weight: 600; margin: 0 0 8px 0;">${strength.stage}: ${questionText}</p>
                                <blockquote style="margin: 0; padding: 0; font-style: italic; color: #2d2828; opacity: 0.8; font-size: 13px; line-height: 1.6;">
                                    ${matureQuote}
                                </blockquote>
                            </div>
                        `;
                    });
                });

                strengthsContent.innerHTML = strengthsHTML;
            } else if (strengthsContent && totalAnswered > 0) {
                strengthsContent.innerHTML = '<p style="color: #2d2828; font-size: 16px;">Your strengths will appear here as you answer YES to questions.</p>';
            } else if (strengthsContent) {
                strengthsContent.innerHTML = '<p class="placeholder-text">Your strengths will appear here...</p>';
            }

            // ======================
            // 6. WHY THIS MATTERS
            // ======================
            const whyContent = document.getElementById('whyContent');
            if (whyContent && allGaps.length > 0) {
                let whyHTML = '<p style="font-size: 16px; line-height: 1.7; margin-bottom: 20px;">Based on your answers, here\'s why these areas are critical for your business:</p>';

                // Group gaps by element to avoid repetition
                const elementsSeen = new Set();
                allGaps.forEach(gap => {
                    if (!elementsSeen.has(gap.element)) {
                        elementsSeen.add(gap.element);
                        const quote = whyQuotes[gap.element] || 'Understanding this area is crucial for sustainable growth.';

                        whyHTML += `
                            <div style="background: #f5f5dc; padding: 16px; border-left: 4px solid #b8d78f; margin-bottom: 16px; border-radius: 4px;">
                                <h4 style="color: #2d2828; font-size: 16px; font-weight: 700; margin: 0 0 8px 0;">${gap.element}</h4>
                                <blockquote style="margin: 0; padding: 12px 16px; background: rgba(255, 255, 255, 0.5); border-left: 3px solid #eaffc4; font-style: italic; color: #2d2828; line-height: 1.6;">
                                    ${quote}
                                </blockquote>
                            </div>
                        `;
                    }
                });

                whyContent.innerHTML = whyHTML;
            } else if (whyContent && totalAnswered > 0) {
                whyContent.innerHTML = '<p style="color: #2d2828; font-size: 16px;">Excellent! No areas for improvement identified. Context about critical business elements will appear here if any are found.</p>';
            } else if (whyContent) {
                whyContent.innerHTML = '<p class="placeholder-text">Context about why these areas are critical will appear here...</p>';
            }

            // ======================
            // 7. ACTIONS (Sova-refined: restrained, functional, clear hierarchy)
            // ======================
            const todoContent = document.getElementById('todoContent');
            if (todoContent && allGaps.length > 0) {
                // SORT gaps by element order
                const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
                allGaps.sort((a, b) => {
                    const aIndex = elementOrder.indexOf(a.element);
                    const bIndex = elementOrder.indexOf(b.element);
                    return aIndex - bIndex;
                });

                // Generous spacing at top (Jeton principle)
                let todoHTML = `
                    <p style="color: #2d2828; font-size: 14px; line-height: 1.6; margin: 0 0 24px 0; opacity: 0.7;">
                        Quick completion tracking. See full details in Report section.
                    </p>
                `;

                allGaps.forEach((gap, index) => {
                    // Use consistent taskId format matching gap cards
                    const taskId = `${gap.element.toLowerCase()}-${gap.stage.toLowerCase()}-${index}`;
                    const questionText = isSolo ? (gap.question.Solo || gap.question.solo) : (gap.question.Team || gap.question.team);
                    const isCompleted = userData.completedTasks[taskId];

                    // Transform to conversational action
                    let actionText = questionText
                        .replace(/^I\/We have /i, 'Create ')
                        .replace(/^I have /i, 'Create ')
                        .replace(/^We have /i, 'Create ')
                        .replace(/written /i, 'write ')
                        .replace(/documented /i, 'document ')
                        .replace(/considered \/ completed /i, 'complete ')
                        .replace(/defined /i, 'define ')
                        .replace(/established /i, 'establish ')
                        .replace(/identified /i, 'identify ');
                    actionText = actionText.charAt(0).toUpperCase() + actionText.slice(1);

                    // Restrained design (Osmo: functional, minimal color)
                    todoHTML += `
                        <label for="action-check-${taskId}" style="display: flex; align-items: start; gap: 12px; padding: 16px; margin-bottom: 8px; background: ${isCompleted ? 'rgba(234, 255, 196, 0.06)' : '#ffffff'}; border: 1px solid ${isCompleted ? 'rgba(234, 255, 196, 0.3)' : 'rgba(45, 40, 40, 0.08)'}; border-radius: 6px; cursor: pointer; transition: all 0.2s ease;" onmouseover="this.style.borderColor='${isCompleted ? 'rgba(234, 255, 196, 0.4)' : 'rgba(45, 40, 40, 0.15)'}'" onmouseout="this.style.borderColor='${isCompleted ? 'rgba(234, 255, 196, 0.3)' : 'rgba(45, 40, 40, 0.08)'}'">
                            <!-- Clean checkbox (no excessive styling) -->
                            <input type="checkbox"
                                   id="action-check-${taskId}"
                                   ${isCompleted ? 'checked' : ''}
                                   onchange="completeTaskFromActions('${taskId}', this.checked)"
                                   style="margin-top: 2px; width: 18px; height: 18px; cursor: pointer; accent-color: #eaffc4; flex-shrink: 0;">
                            <div style="flex: 1; min-width: 0;">
                                <!-- Clear hierarchy: metadata then content -->
                                <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 6px;">
                                    <span style="color: #2d2828; font-size: 12px; font-weight: 600; opacity: 0.4;">${index + 1}</span>
                                    <span style="color: #2d2828; font-size: 11px; font-weight: 500; opacity: 0.5; text-transform: uppercase; letter-spacing: 0.3px;">${gap.element}  ${gap.stage}</span>
                                </div>
                                <!-- Action text (primary focus) -->
                                <div style="color: #2d2828; font-size: 14px; line-height: 1.5; font-weight: 400; ${isCompleted ? 'opacity: 0.4; text-decoration: line-through;' : ''}">${actionText}</div>
                            </div>
                        </label>
                    `;
                });

                todoContent.innerHTML = todoHTML;
            } else if (todoContent && totalAnswered > 0) {
                // No emojis, restrained messaging (Sova brand)
                todoContent.innerHTML = `
                    <div style="background: rgba(234, 255, 196, 0.06); border: 1px solid rgba(234, 255, 196, 0.2); border-radius: 6px; padding: 24px; text-align: center;">
                        <p style="color: #2d2828; font-size: 15px; font-weight: 500; margin: 0 0 6px 0;">
                            No areas for improvement identified
                        </p>
                        <p style="color: #2d2828; font-size: 13px; margin: 0; opacity: 0.6;">
                            You're ready to progress
                        </p>
                    </div>
                `;
            } else if (todoContent) {
                todoContent.innerHTML = '<p class="placeholder-text" style="opacity: 0.5;">Your actions will appear here</p>';
            }
        }

        // Show Combined Report (placeholder - will build full version next)
        function showCombinedReport() {
            console.log(' showCombinedReport() called');

            // Hide questionnaire, show model and report
            document.getElementById('questionnaireSection').classList.remove('active');
            document.getElementById('modelSection').classList.add('active');
            document.getElementById('reportSection').style.display = 'block';  // Ensure report is visible
            document.getElementById('webChartSidebar').style.display = 'block';  // Show web chart sidebar
            document.getElementById('reportSidebar').style.display = 'block';  // Show report sidebar
            document.getElementById('actionSidebar').style.display = 'block';  // Show actions sidebar

            // Update web chart and report one final time
            updateWebChart();
            updateReportLive();

            // Scroll to report section smoothly
            setTimeout(() => {
                const reportSection = document.getElementById('reportSection');
                console.log(' Scrolling to report, display:', reportSection.style.display);
                reportSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 500);
        }

        // ========== END MULTI-ELEMENT FLOW FUNCTIONS ==========

        // Show Results Page
        function showResults(results) {
            // Hide questionnaire, show results
            document.getElementById('questionnaireSection').classList.remove('active');
            document.getElementById('resultsSection').classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Update title and subtitle
            document.getElementById('resultsTitle').textContent = `${results.element} Assessment Complete`;
            document.getElementById('resultsSubtitle').textContent = `${results.stage} Stage  Completed ${new Date(results.completedAt).toLocaleDateString('en-AU')}`;

            // Animate score circle
            animateScore(results.score);

            // Update score details
            const description = getScoreDescription(results.score);
            document.getElementById('scoreHeading').textContent = description.title;
            document.getElementById('scoreDescription').textContent = description.text;

            // Show score breakdown
            const breakdownHTML = `
                <div class="score-item">
                    <span class="score-item-label">${results.element} Readiness</span>
                    <span class="score-item-value">${results.score}%</span>
                </div>
                <div class="score-item">
                    <span class="score-item-label">Questions Answered "Yes"</span>
                    <span class="score-item-value">${results.yesCount} of ${results.totalQuestions}</span>
                </div>
            `;
            document.getElementById('scoreBreakdown').innerHTML = breakdownHTML;

            // Generate stage progression tracker
            generateStageProgressionTracker(results);

            // Generate Golden Circle content (Why, How, What)
            generateGoldenCircleContent(results);
        }

        // Animate Score Circle
        function animateScore(percent) {
            const circle = document.getElementById('scoreCircle');
            const scoreText = document.getElementById('scorePercent');
            const circumference = 2 * Math.PI * 90; // radius is 90
            const offset = circumference - (percent / 100) * circumference;

            // Animate circle
            setTimeout(() => {
                circle.style.strokeDashoffset = offset;
                circle.style.transition = 'stroke-dashoffset 2s ease-out';
            }, 100);

            // Animate number
            let current = 0;
            const increment = percent / 50; // 50 frames
            const timer = setInterval(() => {
                current += increment;
                if (current >= percent) {
                    current = percent;
                    clearInterval(timer);
                }
                scoreText.textContent = Math.round(current) + '%';
            }, 40);
        }


        // Get Score Description - Australian English, concise
        function getScoreDescription(score) {
            if (score >= 80) {
                return {
                    title: 'Excellent',
                    text: 'Strong foundations. Ready for investors.'
                };
            } else if (score >= 60) {
                return {
                    title: 'Good Progress',
                    text: 'Solid foundations with some gaps to address.'
                };
            } else if (score >= 40) {
                return {
                    title: 'Building Foundations',
                    text: 'Key gaps need attention.'
                };
            } else {
                return {
                    title: 'Priority Area',
                    text: 'Requires immediate focus.'
                };
            }
        }

        // Generate Stage Progression Tracker
        function generateStageProgressionTracker(results) {
            const currentStage = results.stage;
            const element = results.element;
            const stages = ['Discovery', 'Validation', 'Efficiency', 'Scale'];
            const currentIndex = stages.indexOf(currentStage);

            let html = '<div class="stage-tracker">';
            html += '<h3>Your Stage Progression</h3>';
            html += '<div class="stage-progress-bar">';

            stages.forEach((stage, index) => {
                const isComplete = index < currentIndex;
                const isCurrent = index === currentIndex;
                const isPending = index > currentIndex;

                let statusClass = '';
                if (isComplete) statusClass = 'complete';
                else if (isCurrent) statusClass = 'current';
                else statusClass = 'pending';

                html += `
                    <div class="stage-item ${statusClass}">
                        <div class="stage-number">${index + 1}</div>
                        <div class="stage-name">${stage}</div>
                    </div>
                `;

                if (index < stages.length - 1) {
                    html += `<div class="stage-connector ${isComplete ? 'complete' : ''}"></div>`;
                }
            });

            html += '</div>';

            // Show what's available
            html += `<p style="margin-top: 16px; color: #b8d78f;">You\'ve completed ${element} at the ${currentStage} stage. `;
            if (currentIndex < stages.length - 1) {
                html += `${stages.length - currentIndex - 1} more stage${stages.length - currentIndex - 1 > 1 ? 's' : ''} available: `;
                html += stages.slice(currentIndex + 1).join(', ') + '.';
            } else {
                html += 'This is the highest stage.';
            }
            html += '</p>';

            html += '</div>';

            document.getElementById('stageProgressionTracker').innerHTML = html;
        }

        // Generate Golden Circle Content (WHY  HOW  WHAT)
        function generateGoldenCircleContent(results) {
            const element = results.element;
            const stage = results.stage;
            const noAnswers = [];

            // Get questions answered "No"
            currentQuestions.forEach((q, index) => {
                if (answers[index] === false) {
                    noAnswers.push({ question: q, index: index });
                }
            });

            let html = '';

            if (noAnswers.length === 0) {
                // All Yes answers
                html += '<div class="golden-circle-section">';
                html += `<h2>All Foundations Complete</h2>`;
                html += `<p>You answered "Yes" to all questions at the ${stage} stage.</p>`;

                if (stage !== 'Scale') {
                    const nextStage = stage === 'Discovery' ? 'Validation' : stage === 'Validation' ? 'Efficiency' : 'Scale';
                    html += `<p style="margin-top: 16px;"><strong>Next step:</strong> Test the ${nextStage} stage for ${element}, or assess the next element.</p>`;
                    html += `<button class="btn-secondary" style="margin-top: 16px;" onclick="suggestHigherStage('${element}', '${nextStage}')">Start ${nextStage} Assessment</button>`;
                } else {
                    html += `<p style="margin-top: 16px;">You've mastered ${element}. Focus on other elements or maintain these practices.</p>`;
                }
                html += '</div>';
            } else {
                // WHY Section - Use quotes from Excel
                html += '<div class="golden-circle-section why-section">';
                html += `<h2>Why ${element} Matters</h2>`;

                // Collect all quotes from "No" answers
                const failureQuotes = [];
                const bestPracticeQuotes = [];
                noAnswers.forEach(item => {
                    if (item.question.quoteFailure) failureQuotes.push(item.question.quoteFailure);
                    if (item.question.quoteFailure2) failureQuotes.push(item.question.quoteFailure2);
                    if (item.question.quoteBestPractice) bestPracticeQuotes.push(item.question.quoteBestPractice);
                    if (item.question.quoteBestPractice2) bestPracticeQuotes.push(item.question.quoteBestPractice2);
                });

                // Show failure quote if available
                if (failureQuotes.length > 0) {
                    html += `<p><strong>Why startups fail:</strong> "${failureQuotes[0]}"</p>`;
                }

                // Show best practice quote if available
                if (bestPracticeQuotes.length > 0) {
                    html += `<p style="margin-top: 12px;"><strong>What success looks like:</strong> "${bestPracticeQuotes[0]}"</p>`;
                }

                // Always show element context
                html += `<p style="margin-top: 12px;">${getElementContext(element)}</p>`;
                html += '</div>';

                // HOW Section
                html += '<div class="golden-circle-section how-section">';
                html += `<h2>How to Address Your Areas for Improvement</h2>`;
                html += `<p>You have ${noAnswers.length} area${noAnswers.length > 1 ? 's' : ''} to address. Start with #1.</p>`;

                noAnswers.forEach((item, idx) => {
                    const q = item.question;
                    const isSolo = userData.teamSize === 'Solo';
                    const questionText = isSolo ? (q.Solo || q.solo) : (q.Team || q.team);
                    const advice = q.advice || 'Implement this practice to strengthen your foundations.';

                    // Collect tools
                    const tools = [];
                    if (q.tool1) tools.push(q.tool1);
                    if (q.tool2) tools.push(q.tool2);
                    if (q.tool3) tools.push(q.tool3);
                    if (q.tool4) tools.push(q.tool4);

                    const priority = idx === 0 ? 'Start Here' : idx === 1 ? 'Then This' : 'Next';

                    html += `
                        <div class="gap-card">
                            <div class="gap-header">
                                <h3>${idx + 1}. ${questionText}</h3>
                                <span class="gap-priority">${priority}</span>
                            </div>
                            <p><strong>Why:</strong> ${advice}</p>
                            ${tools.length > 0 ? `
                                <p style="margin-top: 12px;"><strong>How:</strong></p>
                                <ul style="margin-left: 20px;">
                                    ${tools.map(tool => `<li>${tool}</li>`).join('')}
                                </ul>
                            ` : ''}
                            ${q.book ? `<p style="margin-top: 12px;"><strong>Learn:</strong> ${q.book}</p>` : ''}
                        </div>
                    `;
                });

                html += '</div>';

                // WHAT Section (Stage progression guidance)
                html += '<div class="golden-circle-section what-section">';
                html += `<h2>What's Next</h2>`;
                html += generateStageGuidance(results, noAnswers.length);
                html += '</div>';

                // MATURITY Section - Show what best practice looks like
                if (typeof matureQuotes !== 'undefined' && matureQuotes[element]) {
                    html += '<div class="golden-circle-section" style="border-left: 4px solid #B89968;">';
                    html += `<h2>What Best Practice Looks Like</h2>`;
                    html += `<p style="font-style: italic; color: #b8d78f;">When you've mastered ${element}, here's what you'll see:</p>`;

                    // Show mature quotes for this element
                    matureQuotes[element].forEach((quote, idx) => {
                        if (idx < 3) { // Limit to 3 quotes
                            html += `<p style="margin-top: 12px;">"${quote}"</p>`;
                        }
                    });

                    html += '</div>';
                }
            }

            document.getElementById('goldenCircleContent').innerHTML = html;
        }

        // Get Element Quote
        function getElementQuote(element) {
            const quotes = {
                'Governance': '73% of startup conflicts stem from unclear ownership and roles.',
                'Purpose': 'Companies with clear purpose have 46% higher employee retention.',
                'Strategy': '90% of startups fail due to market mistiming, not bad products.',
                'Marketing': 'Customer acquisition costs 5x more than retention.',
                'Finance': '82% of businesses fail due to cash flow problems, not lack of profit.',
                'Performance': 'What gets measured gets managed.',
                'People': 'A-players hire A-players, B-players hire C-players.',
                'Process': 'Systems run the business, people run the systems.',
                'Technology': 'Technology is the enabler, not the solution.'
            };
            return quotes[element] || 'Strong foundations prevent expensive mistakes later.';
        }

        // Get Element Context - Australian English
        function getElementContext(element) {
            const context = {
                'Governance': 'Solid governance prevents costly disputes, protects IP, and shows investors you\'re serious. Even solo founders need proper legal structure, decision frameworks, and compliance.',
                'Purpose': 'Clear purpose attracts the right customers, employees, and investors. It\'s your filter for every decisionwhat to build, who to hire, which opportunities to pursue.',
                'Strategy': 'Strategy is your roadmap from where you are to where you want to be. Without it, you\'re guessing. With it, you can test assumptions, measure progress, and pivot with confidence.',
                'Marketing': 'Marketing connects your solution to people who need it. Great products with poor marketing fail. Average products with great marketing thrive.',
                'Finance': 'Cash flow management is survival. Profit is nice, but running out of cash kills 82% of startups. Know your numbers, forecast ruthlessly.',
                'Performance': 'You can\'t improve what you don\'t measure. Performance metrics show what\'s working, what\'s broken, and where to focus your limited time and money.',
                'People': 'Your team is your competitive advantage. Hire too early and you burn cash. Hire too late and you burn out. Get culture and structure right from day one.',
                'Process': 'Processes free you from chaos. They enable delegation, prevent mistakes, and scale your impact. Document once, repeat forever.',
                'Technology': 'Technology should solve problems, not create them. Use existing tools unless custom code is genuinely necessary.'
            };
            return context[element] || 'This element is crucial for your business success.';
        }

        // Generate Stage Guidance (Rules logic) - Australian English
        function generateStageGuidance(results, noCount) {
            const stage = results.stage;
            const element = results.element;
            let html = '';

            if (noCount === 0) {
                // All Yes
                if (stage === 'Scale') {
                    html += `<p>You've mastered ${element} at Scale stage. Maintain these practices.</p>`;
                } else {
                    const nextStage = stage === 'Discovery' ? 'Validation' : stage === 'Validation' ? 'Efficiency' : 'Scale';
                    html += `<p>Ready to test the ${nextStage} stage.</p>`;
                }
            } else if (noCount < 2) {
                // 1 gap
                html += `<p>One gap to fix. Complete it, then reassess or move to the next element.</p>`;
            } else {
                // 2+ gaps
                html += `<p>${noCount} gaps identified. Focus here first. Don't progress to the next stage until you've addressed these fundamentals. Reassess in 2-4 weeks.</p>`;
            }

            return html;
        }

        // Back to Model
        function backToModel() {
            document.getElementById('resultsSection').classList.remove('active');
            document.getElementById('modelSection').classList.add('active');
            updateWebChart(); // Update the web chart visualization
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Update Web Chart with Scores
        function updateWebChart() {
            console.log(' updateWebChart() called');
            // Use multi-element progress data
            const results = multiElementProgress.results;
            console.log(' Results:', results);

            if (Object.keys(results).length === 0) {
                console.log(' No results to plot');
                document.getElementById('webChart').style.display = 'none';
                return;
            }

            // Element positions on the circle (NEW: dots at r=510) - ONLY 4 ACTIVE ELEMENTS FOR MVP
            // Center is at (650, 650), evenly spaced at 40 intervals starting from 0 (top)
            const elementPositions = {
                'Governance': { cx: 650, cy: 140 },       // 0 (12 o'clock) at r=510
                'Purpose': { cx: 978, cy: 259 },         // 40 at r=510
                'Strategy': { cx: 1152, cy: 561 },       // 80 at r=510
                'Marketing': { cx: 824, cy: 1129 }       // 160 at r=510
            };

            // Calculate points for web chart
            const centerX = 650;
            const centerY = 650;
            const points = [];
            const wedgesContainer = document.getElementById('webChartWedges');
            wedgesContainer.innerHTML = ''; // Clear previous wedges

            // For MVP, only plot the 4 active elements in clockwise order
            const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];

            // Stage radii (NEW: ring boundaries for scoring visualization)
            // Each stage has its own 100px band, 0-100% scores plot within that band
            const stageRadii = {
                'Discovery': { inner: 50, outer: 150 },      // First ring (100px band)
                'Validation': { inner: 150, outer: 250 },    // Second ring (100px band)
                'Efficiency': { inner: 250, outer: 350 },    // Third ring (100px band)
                'Scale': { inner: 350, outer: 450 }          // Fourth ring (100px band)
            };

            elementOrder.forEach(element => {
                const elementResult = results[element];
                const pos = elementPositions[element];

                console.log(` Checking ${element}:`, elementResult ? `score=${elementResult.score}, stage=${elementResult.highestStageReached}, answered=${elementResult.questionsAnswered}` : 'not assessed');

                // FIXED: Only plot elements that are in elementsCompleted array (user finished assessment for that element)
                const isCompleted = multiElementProgress.elementsCompleted.includes(element);

                if (pos && elementResult && isCompleted && elementResult.score !== undefined) {
                    console.log(` Plotting ${element} - completed, score=${elementResult.score}%, stage=${elementResult.highestStageReached}`);
                    // Element completed - plot based on ACTUAL stage reached, not hardcoded Discovery
                    const stage = elementResult.highestStageReached || 'Discovery';
                    const radii = stageRadii[stage] || { inner: 0, outer: 85 };

                    // Calculate position WITHIN the stage ring
                    // Score 0% = inner edge of stage ring
                    // Score 100% = outer edge of stage ring
                    const stageRadius = radii.inner + (radii.outer - radii.inner) * (elementResult.score / 100);

                    // Calculate full distance from center to dot
                    const fullDistance = Math.sqrt(Math.pow(pos.cx - centerX, 2) + Math.pow(pos.cy - centerY, 2));

                    // Calculate ratio to position within stage
                    const stageRatio = stageRadius / fullDistance;

                    const x = centerX + (pos.cx - centerX) * stageRatio;
                    const y = centerY + (pos.cy - centerY) * stageRatio;
                    points.push(`${x},${y}`);

                    // Add glowing circle dot at endpoint for visibility
                    const dot = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                    dot.setAttribute('cx', x);
                    dot.setAttribute('cy', y);
                    dot.setAttribute('r', '10');
                    dot.setAttribute('fill', '#eaffc4');
                    dot.setAttribute('stroke', '#eaffc4');
                    dot.setAttribute('stroke-width', '3');
                    dot.style.filter = 'drop-shadow(0 0 12px rgba(234, 255, 196, 0.9)) drop-shadow(0 0 6px rgba(234, 255, 196, 0.7))';
                    wedgesContainer.appendChild(dot);
                    console.log(` Circle dot added at (${x},${y})`);
                } else {
                    console.log(` Skipping ${element} - not completed yet. isCompleted=${isCompleted}`);
                }
            });

            // Update polygon points - create filled wedge from center through each result
            const webChart = document.getElementById('webChart');
            console.log(' Plotting points:', points);

            if (points.length >= 2) {
                // Create filled wedge polygon from center -> results -> back to center
                // Start from center, go to each point, back to center
                const wedgePoints = [`${centerX},${centerY}`, ...points, `${centerX},${centerY}`];
                webChart.setAttribute('points', wedgePoints.join(' '));
                webChart.style.display = 'block';
                console.log(' Web chart wedge shown with', points.length, 'result points');
                console.log(' Wedge points:', wedgePoints.join(' '));
            } else {
                webChart.style.display = 'none';
                console.log(' Not enough points to draw web chart yet (need at least 2)');
            }
        }

        // Download Report (Placeholder)
        function downloadReport() {
            alert('PDF download functionality coming soon! For now, you can print this page (Ctrl+P) or take screenshots.');
        }

        // Email Report (Placeholder)
        function emailReport() {
            const email = prompt('Enter your email address to receive this report:');
            if (!email) {
                return; // User cancelled
            }
            if (!email.includes('@')) {
                alert('Please enter a valid email address');
                return;
            }
            alert(`Report will be emailed to ${email}\n\n(Email functionality coming soon!)`);
        }

        // Pulse Next Element
        function pulseNextElement() {
            // Order of active elements: Governance -> Purpose -> Strategy -> Marketing
            const elementOrder = ['Governance', 'Purpose', 'Strategy', 'Marketing'];
            const currentIndex = elementOrder.indexOf(currentElement);

            // Stop any existing animations first
            elementOrder.forEach(element => {
                const dotId = element.toLowerCase() + '-dot';
                const dot = document.getElementById(dotId);
                if (dot) {
                    dot.style.animation = 'none';
                }
            });

            if (currentIndex >= 0 && currentIndex < elementOrder.length - 1) {
                const nextElement = elementOrder[currentIndex + 1];
                const nextDotId = nextElement.toLowerCase() + '-dot';
                const nextDot = document.getElementById(nextDotId);

                if (nextDot) {
                    // Wait a moment then pulse
                    setTimeout(() => {
                        // Force reflow to restart animation
                        nextDot.style.animation = 'none';
                        void nextDot.offsetWidth; // Trigger reflow
                        // Slower pulse (2s), more iterations (5x) for better visibility
                        nextDot.style.animation = 'glow 2s ease-in-out 5';
                    }, 500);
                }
            }
        }

        // Suggest Higher Stage - Launch assessment at next stage level
        function suggestHigherStage(element, stage) {
            // Update user data with new stage
            userData.assessmentStartStage = stage;

            // Go back to model and start assessment for this element at higher stage
            backToModel();

            // Short delay then start assessment
            setTimeout(() => {
                startElementAssessment(element);
            }, 500);
        }

        // Initialize on page load - restore report visibility if progress exists
        function initializeAssessment() {
            // Check for mode parameter from choose-path.html
            const urlParams = new URLSearchParams(window.location.search);
            const mode = urlParams.get('mode');

            if (mode) {
                console.log(' Assessment mode detected:', mode);

                // Store mode in localStorage and userData
                userData.assessmentMode = mode;
                localStorage.setItem('sovaUserData', JSON.stringify(userData));

                // Hide preliminary flow
                document.getElementById('prelimFlow').style.display = 'none';

                // Show the pictorial based on mode
                if (mode === 'complete') {
                    // Complete assessment: show model with auto-pulse animation
                    console.log(' Starting complete assessment with auto-pulse');
                    showModel();
                } else if (mode === 'zoomin') {
                    // Zoom in: show model WITHOUT auto-pulse animation
                    console.log(' Starting zoom-in mode - no auto-pulse');
                    showModelManual();
                }

                // Clean up URL to remove mode parameter
                window.history.replaceState({}, document.title, window.location.pathname);
                return;
            }

            // Check if user has started assessment (has multi-element progress)
            if (multiElementProgress && Object.keys(multiElementProgress.results).length > 0) {
                console.log(' Existing progress found, restoring report...');

                // Show report section with existing data
                const reportSection = document.getElementById('reportSection');
                if (reportSection) {
                    reportSection.style.display = 'block';

                    // Update report with existing data
                    updateReportLive();

                    // Update web chart with existing scores
                    updateWebChart();
                }
            }
        }

        // Run initialization when page loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeAssessment);
        } else {
            // DOM already loaded
            initializeAssessment();
        }

        // Mobile-specific fixes - hide sidebar buttons and fix layout
        function applyMobileFixes() {
            const isMobile = window.innerWidth <= 768;

            console.log(' Mobile Fix Running - Window Width:', window.innerWidth, 'isMobile:', isMobile);

            // Handle sidebar buttons visibility - always show them
            const sidebarButtons = ['webChartSidebar', 'reportSidebar', 'actionSidebar'];
            sidebarButtons.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.style.display = 'block';
                    el.style.visibility = 'visible';
                    console.log(' Sidebar button visible:', id);
                }
            });

            if (isMobile) {
                console.log(' Applying mobile fixes...');

                // Fix report section width
                const reportSection = document.getElementById('reportSection');
                if (reportSection) {
                    reportSection.style.paddingLeft = '8px';
                    reportSection.style.paddingRight = '8px';
                    reportSection.style.maxWidth = '100%';
                    reportSection.style.overflowX = 'hidden';
                }

                // Fix all report-section elements
                const reportSections = document.querySelectorAll('.report-section');
                reportSections.forEach(section => {
                    section.style.padding = '20px 12px';
                    section.style.marginLeft = '0';
                    section.style.marginRight = '0';
                    section.style.maxWidth = '100%';
                });

                // Fix container
                const container = document.querySelector('.container');
                if (container) {
                    container.style.maxWidth = '100%';
                    container.style.margin = '0';
                    container.style.padding = '8px 0';
                    container.style.overflowX = 'hidden';
                    console.log(' Container fixed');
                }

                // Fix preliminary section
                const prelimSection = document.querySelector('.prelim-section');
                if (prelimSection) {
                    prelimSection.style.maxWidth = '100%';
                    console.log(' Prelim section fixed');
                }

                // Fix question container
                const questionContainer = document.querySelector('.question-container');
                if (questionContainer) {
                    questionContainer.style.maxWidth = '100%';
                    questionContainer.style.margin = '0';
                    questionContainer.style.borderRadius = '0';
                    questionContainer.style.padding = '24px 16px';
                    console.log(' Question container fixed');
                }

                // Fix score cards (Element Breakdown)
                const scoreCards = document.querySelectorAll('.score-card');
                scoreCards.forEach(card => {
                    card.style.flexDirection = 'column';
                    card.style.width = '100%';
                    card.style.padding = '16px';
                });
                if (scoreCards.length > 0) console.log(' Score cards fixed:', scoreCards.length);

                // Fix gap cards
                const gapCards = document.querySelectorAll('.gap-card');
                gapCards.forEach(card => {
                    card.style.padding = '16px 12px';
                    card.style.margin = '0 0 16px 0';
                    card.style.maxWidth = '100%';
                });
                if (gapCards.length > 0) console.log(' Gap cards fixed:', gapCards.length);

                // Fix two-column layouts to stack
                const twoColumns = document.querySelectorAll('.two-column, .gap-details');
                twoColumns.forEach(col => {
                    col.style.flexDirection = 'column';
                    col.style.gap = '16px';
                });

                // Fix individual columns
                const columns = document.querySelectorAll('.column, .gap-column');
                columns.forEach(col => {
                    col.style.width = '100%';
                    col.style.maxWidth = '100%';
                    col.style.padding = '0';
                });
                if (columns.length > 0) console.log(' Columns stacked:', columns.length);

                // Fix brown header boxes
                const brownHeaders = document.querySelectorAll('[style*="background: #2d2828"], [style*="background:#2d2828"]');
                brownHeaders.forEach(header => {
                    header.style.margin = '0';
                    header.style.borderRadius = '12px';
                    header.style.padding = '16px 12px';
                });

                // Fix assessment tooltip buttons
                const infoButtonsRow = document.querySelector('.info-buttons-row');
                if (infoButtonsRow) {
                    infoButtonsRow.style.justifyContent = 'flex-start';
                    infoButtonsRow.style.flexWrap = 'wrap';
                    infoButtonsRow.style.gap = '8px';
                    infoButtonsRow.style.margin = '0 0 16px 0';
                    console.log(' Assessment tooltip buttons fixed');
                }

                const infoButtons = document.querySelectorAll('.info-btn');
                infoButtons.forEach(btn => {
                    btn.style.fontSize = '11px';
                    btn.style.padding = '6px 10px';
                });

                // Fix Element Breakdown grid - 2 columns on mobile
                const elementGrid = document.getElementById('elementGrid');
                if (elementGrid) {
                    elementGrid.style.gridTemplateColumns = 'repeat(2, 1fr)';
                    elementGrid.style.gap = '12px';
                    elementGrid.style.padding = '0';
                    console.log(' Element grid fixed - 2 columns');
                }

                // Fix element cards
                const elementCards = document.querySelectorAll('.element-card, .score-item');
                elementCards.forEach(card => {
                    card.style.width = '100%';
                    card.style.maxWidth = '100%';
                    card.style.margin = '0';
                    card.style.padding = '16px 12px';
                });
                if (elementCards.length > 0) console.log(' Element cards fixed:', elementCards.length);

                // Fix filter sections
                const filterSections = document.querySelectorAll('.filter-section, .element-filter');
                filterSections.forEach(section => {
                    section.style.width = '100%';
                    section.style.padding = '12px';
                    section.style.margin = '0';
                });

                // Hide "Click an element" text
                const clickText = document.querySelector('[style*="opacity: 0.5"]');
                if (clickText && clickText.textContent.includes('Click an element')) {
                    clickText.style.display = 'none';
                    console.log(' "Click an element" text hidden');
                }

                const filterButtons = document.querySelectorAll('.filter-buttons, #elementFilterButtons');
                filterButtons.forEach(btns => {
                    btns.style.flexWrap = 'nowrap';
                    btns.style.justifyContent = 'flex-start';
                    btns.style.gap = '3px';
                    btns.style.overflowX = 'auto';
                });

                // Compress filter buttons - single line, 9px font
                const filterBtns = document.querySelectorAll('.filter-btn, .element-filter-btn');
                filterBtns.forEach(btn => {
                    btn.style.fontSize = '9px';
                    btn.style.padding = '6px 6px';
                    btn.style.whiteSpace = 'nowrap';
                    btn.style.flexShrink = '0';
                });
                if (filterBtns.length > 0) console.log(' Filter buttons compressed:', filterBtns.length);

                // Fix element headers with tooltips
                const elementHeaders = document.querySelectorAll('.element-header');
                elementHeaders.forEach(header => {
                    header.style.flexDirection = 'column';
                    header.style.alignItems = 'flex-start';
                    header.style.gap = '8px';
                });

                const elementTooltips = document.querySelectorAll('.element-tooltips');
                elementTooltips.forEach(tooltips => {
                    tooltips.style.width = '100%';
                    tooltips.style.justifyContent = 'flex-start';
                    tooltips.style.flexWrap = 'nowrap';
                    tooltips.style.gap = '4px';
                });

                // Compress tooltip buttons - same height (28px), one line
                const tooltipBtns = document.querySelectorAll('.element-tooltips button, .element-tooltips [style*="border"]');
                tooltipBtns.forEach(btn => {
                    btn.style.fontSize = '9px';
                    btn.style.padding = '6px 8px';
                    btn.style.height = '28px';
                    btn.style.lineHeight = '1';
                    btn.style.whiteSpace = 'nowrap';
                });

                // Fix gap items - same margins as Element heading containers
                const gapItems = document.querySelectorAll('.gap-item');
                gapItems.forEach(item => {
                    item.style.padding = '16px';
                    item.style.margin = '0 0 16px 0';
                    item.style.maxWidth = '100%';
                });
                if (gapItems.length > 0) console.log(' Gap items fixed with margins:', gapItems.length);

                // Fix research sections with LEFT/RIGHT MARGINS
                const researchSections = document.querySelectorAll('[style*="RESEARCH REFERENCES"]');
                researchSections.forEach(section => {
                    const parent = section.closest('div');
                    if (parent) {
                        parent.style.padding = '16px';
                        parent.style.margin = '0 16px 16px 16px';
                        parent.style.maxWidth = 'calc(100% - 32px)';
                    }
                });

                const researchItems = document.querySelectorAll('.research-item');
                researchItems.forEach(item => {
                    item.style.padding = '12px';
                    item.style.margin = '0 0 12px 0';
                });
                if (researchItems.length > 0) console.log(' Research items fixed:', researchItems.length);

                // Fix border-left boxes in research
                const researchBoxes = document.querySelectorAll('[style*="border-left: 4px solid"]');
                researchBoxes.forEach(box => {
                    box.style.padding = '12px';
                    box.style.margin = '0';
                });

                console.log(' All mobile fixes applied!');
            } else {
                console.log(' Desktop mode - no mobile fixes needed');
            }
        }

        // Apply on load
        applyMobileFixes();

        // Reapply on resize
        window.addEventListener('resize', applyMobileFixes);

        // Make entire radio option containers clickable
        document.addEventListener('click', function(e) {
            const radioOption = e.target.closest('.radio-option');
            if (radioOption) {
                const radioInput = radioOption.querySelector('input[type="radio"]');
                if (radioInput && e.target !== radioInput) {
                    radioInput.checked = true;
                    // Trigger change event for any listeners
                    radioInput.dispatchEvent(new Event('change', { bubbles: true }));
                }
            }
        });

        // SOVA center circle tooltip
        const sovaCenterCircle = document.getElementById('sova-center-circle');
        if (sovaCenterCircle) {
            sovaCenterCircle.addEventListener('mouseenter', (e) => {
                const tooltipTitle = tooltip.querySelector('.tooltip-title');
                const tooltipDesc = tooltip.querySelector('.tooltip-desc');

                tooltipTitle.textContent = 'Why 9 Elements?';
                tooltipDesc.innerHTML = `<strong>90% of startups fail due to operational inefficiencies, not bad ideas.</strong> Most founders treat these 9 business functions as separate problems, but they're deeply interconnected.<br><br>Sova's framework is built on proven business excellence models (<strong>Australian Business Excellence Framework</strong>, <strong>Baldrige Excellence Framework</strong>, <strong>EFQM Excellence Model</strong>, <strong>ISO 9001:2015</strong>) adapted specifically for startups. These frameworks represent decades of research into what makes organisations successful and sustainable.<br><br>By understanding how your 9 elements connect, you can diagnose root causes (not just symptoms) and build a sustainable business from day one.<br><br><a href="https://www.bpir.com/business-excellence-models/" target="_blank" style="color: #2d2828; font-weight: 700; text-decoration: underline;">Learn more about business excellence frameworks </a>`;

                // Get the bounding box of the SOVA center circle
                const circleRect = sovaCenterCircle.getBoundingClientRect();
                const circleCenterX = circleRect.left + circleRect.width / 2;
                const circleBottom = circleRect.bottom;

                // Center tooltip horizontally and position just below the circle
                // Make tooltip pointer-events: auto so links are clickable
                tooltip.style.pointerEvents = 'auto';
                tooltip.style.left = (circleCenterX - 200) + 'px'; // 200 is half of max-width 400px
                tooltip.style.top = (circleBottom + 10) + 'px';
                tooltip.style.maxWidth = '400px'; // Make it wider for this tooltip
                tooltip.classList.add('show');
            });

            sovaCenterCircle.addEventListener('mouseleave', () => {
                // Don't hide immediately - give time to move mouse to link
                setTimeout(() => {
                    if (!tooltip.matches(':hover')) {
                        tooltip.style.maxWidth = '300px'; // Reset to default
                        tooltip.style.pointerEvents = 'none'; // Reset to default
                        tooltip.classList.remove('show');
                    }
                }, 100);
            });

            // Hide tooltip when mouse leaves the tooltip itself
            tooltip.addEventListener('mouseleave', () => {
                tooltip.style.maxWidth = '300px'; // Reset to default
                tooltip.style.pointerEvents = 'none'; // Reset to default
                tooltip.classList.remove('show');
            });
        }

        // Scroll to next question on preliminary page after radio selection
        document.addEventListener('change', function(e) {
            if (e.target.type === 'radio') {
                const currentGroup = e.target.closest('.question-group');
                if (currentGroup && currentGroup.parentElement.id === 'step1Section') {
                    // Get all visible question groups in the preliminary section
                    const allGroups = Array.from(document.querySelectorAll('#step1Section .question-group'))
                        .filter(group => group.style.display !== 'none');
                    const currentIndex = allGroups.indexOf(currentGroup);

                    // If this is Q2 (stage selection) or last visible question, scroll to Continue button
                    if (e.target.name === 'stage' || currentIndex === allGroups.length - 1) {
                        setTimeout(() => {
                            const continueButton = document.querySelector('#step1Section .btn-primary');
                            if (continueButton) {
                                continueButton.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }, 300);
                    }
                    // Otherwise scroll to next question group if it exists
                    else if (currentIndex >= 0 && currentIndex < allGroups.length - 1) {
                        setTimeout(() => {
                            const nextGroup = allGroups[currentIndex + 1];
                            if (nextGroup) {
                                nextGroup.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }, 300);
                    }
                }
            }
        });

        // Initialize tooltip popovers - can be called multiple times for dynamically added tooltips
        function initializeTooltips() {
            const tooltipTriggers = document.querySelectorAll('.tooltip-trigger');

            tooltipTriggers.forEach(trigger => {
                // Skip if already initialized
                if (trigger.dataset.tooltipInitialized) return;
                trigger.dataset.tooltipInitialized = 'true';

                const popover = trigger.querySelector('.tooltip-popover');
                if (!popover) return;

                function positionTooltip() {
                    // Get trigger button position
                    const triggerRect = trigger.getBoundingClientRect();
                    const triggerCenterX = triggerRect.left + triggerRect.width / 2;
                    const triggerTop = triggerRect.top;
                    const triggerBottom = triggerRect.bottom;

                    // Get viewport dimensions
                    const viewportWidth = window.innerWidth;
                    const viewportHeight = window.innerHeight;

                    // Temporarily show popover to measure it (off-screen)
                    popover.style.visibility = 'hidden';
                    popover.style.opacity = '0';
                    popover.style.display = 'block';

                    const popoverHeight = popover.offsetHeight || 200;
                    const popoverWidth = popover.offsetWidth || 400;

                    // Reset display (will be controlled by CSS hover/active)
                    popover.style.display = '';
                    popover.style.visibility = '';
                    popover.style.opacity = '';

                    // Check if there's enough space above the button (need popoverHeight + 12px gap + 8px margin)
                    const spaceAbove = triggerTop;
                    const spaceBelow = viewportHeight - triggerBottom;
                    const neededSpace = popoverHeight + 20; // 12px gap + 8px margin

                    let finalTop;
                    let showBelow = false;

                    if (spaceAbove >= neededSpace) {
                        // Position ABOVE the button - plenty of room
                        finalTop = triggerTop - popoverHeight - 12;
                        showBelow = false;
                    } else if (spaceBelow >= neededSpace) {
                        // Position BELOW the button - plenty of room
                        finalTop = triggerBottom + 12;
                        showBelow = true;
                    } else {
                        // Not enough space either way - check which causes less overlap
                        // If we clamp above to 8px, would the popover bottom overlap the button?
                        const clampedAboveTop = Math.max(8, triggerTop - popoverHeight - 12);
                        const clampedAboveBottom = clampedAboveTop + popoverHeight;
                        const wouldOverlapAbove = clampedAboveBottom > triggerTop - 8;

                        // If we show below, would the popover bottom go off screen?
                        const belowTop = triggerBottom + 12;
                        const belowBottom = belowTop + popoverHeight;
                        const wouldOverflowBelow = belowBottom > viewportHeight - 8;

                        // Prefer below if above would overlap, or if below fits better
                        if (wouldOverlapAbove && !wouldOverflowBelow) {
                            finalTop = belowTop;
                            showBelow = true;
                        } else if (!wouldOverlapAbove) {
                            finalTop = clampedAboveTop;
                            showBelow = false;
                        } else {
                            // Both would have issues - prefer below as it's more natural reading direction
                            finalTop = belowTop;
                            showBelow = true;
                        }
                    }

                    popover.style.top = finalTop + 'px';

                    // Add or remove 'below' class for arrow direction
                    if (showBelow) {
                        popover.classList.add('below');
                    } else {
                        popover.classList.remove('below');
                    }

                    // Calculate ideal centered position
                    let popoverLeft = (viewportWidth - popoverWidth) / 2;

                    // Calculate arrow offset: distance from popover left edge to button center
                    let arrowOffset = triggerCenterX - popoverLeft;

                    // Arrow bounds (with padding from edges)
                    const minArrowOffset = 24;
                    const maxArrowOffset = popoverWidth - 24;

                    // If arrow would be clamped, shift the tooltip instead
                    if (arrowOffset > maxArrowOffset) {
                        // Button is to the right - shift tooltip right
                        const shiftAmount = arrowOffset - maxArrowOffset;
                        popoverLeft = Math.min(popoverLeft + shiftAmount, viewportWidth - popoverWidth - 8);
                        arrowOffset = triggerCenterX - popoverLeft;
                    } else if (arrowOffset < minArrowOffset) {
                        // Button is to the left - shift tooltip left
                        const shiftAmount = minArrowOffset - arrowOffset;
                        popoverLeft = Math.max(popoverLeft - shiftAmount, 8);
                        arrowOffset = triggerCenterX - popoverLeft;
                    }

                    // Final clamp of arrow (safety)
                    const clampedArrowOffset = Math.max(minArrowOffset, Math.min(maxArrowOffset, arrowOffset));

                    // Apply horizontal position
                    popover.style.left = popoverLeft + 'px';
                    popover.style.transform = 'none';
                    popover.style.setProperty('--arrow-offset', clampedArrowOffset + 'px');
                }

                // Position immediately and on hover (desktop)
                positionTooltip();
                trigger.addEventListener('mouseenter', positionTooltip);

                // Reposition on scroll (since position is fixed and button moves)
                window.addEventListener('scroll', () => {
                    if (trigger.matches(':hover') || trigger.classList.contains('active')) {
                        positionTooltip();
                    }
                }, { passive: true });

                // Position on click/touch (mobile) - toggle active class
                trigger.addEventListener('click', (e) => {
                    e.stopPropagation();

                    // Close any other open tooltips
                    document.querySelectorAll('.tooltip-trigger').forEach(t => {
                        if (t !== trigger) t.classList.remove('active');
                    });

                    // Toggle this tooltip
                    const isActive = trigger.classList.contains('active');
                    if (!isActive) {
                        positionTooltip();
                        trigger.classList.add('active');
                    } else {
                        trigger.classList.remove('active');
                    }
                });
            });
        }

        // Initialize on page load and set up global click handler
        document.addEventListener('DOMContentLoaded', () => {
            initializeTooltips();

            // Close tooltips when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.tooltip-trigger')) {
                    document.querySelectorAll('.tooltip-trigger').forEach(t => t.classList.remove('active'));
                }
            });
        });
    </script>

    <!-- Bird icon bottom right -->
    <img src="favicon.png" alt="Sova" class="bird-icon">

    <footer style="text-align: center; padding: 1rem; font-size: 0.75rem; color: rgba(45, 40, 40, 0.4); border-top: 1px solid rgba(45, 40, 40, 0.1); margin-top: 2rem; background: #f5f5dc;">
        &copy; 2025 Sova. All rights reserved. Assessment tool and content protected by copyright. <a href="terms.html" style="color: #b8d78f;">Terms of Service</a>
    </footer>
</body>
</html>
<!-- Cache bust: v6.54 - Added security headers and copyright notices - 2025-12-02 -->
